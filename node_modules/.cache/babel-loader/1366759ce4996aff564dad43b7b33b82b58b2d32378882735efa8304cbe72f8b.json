{"ast":null,"code":"'use strict';\n\nObject.defineProperty(exports, '__esModule', {\n  value: true\n});\nexports.p2pk = void 0;\nconst networks_1 = require('../networks');\nconst bscript = require('../script');\nconst types_1 = require('../types');\nconst lazy = require('./lazy');\nconst OPS = bscript.OPS;\n// input: {signature}\n// output: {pubKey} OP_CHECKSIG\nfunction p2pk(a, opts) {\n  if (!a.input && !a.output && !a.pubkey && !a.input && !a.signature) throw new TypeError('Not enough data');\n  opts = Object.assign({\n    validate: true\n  }, opts || {});\n  (0, types_1.typeforce)({\n    network: types_1.typeforce.maybe(types_1.typeforce.Object),\n    output: types_1.typeforce.maybe(types_1.typeforce.Buffer),\n    pubkey: types_1.typeforce.maybe(types_1.isPoint),\n    signature: types_1.typeforce.maybe(bscript.isCanonicalScriptSignature),\n    input: types_1.typeforce.maybe(types_1.typeforce.Buffer)\n  }, a);\n  const _chunks = lazy.value(() => {\n    return bscript.decompile(a.input);\n  });\n  const network = a.network || networks_1.bitcoin;\n  const o = {\n    name: 'p2pk',\n    network\n  };\n  lazy.prop(o, 'output', () => {\n    if (!a.pubkey) return;\n    return bscript.compile([a.pubkey, OPS.OP_CHECKSIG]);\n  });\n  lazy.prop(o, 'pubkey', () => {\n    if (!a.output) return;\n    return a.output.slice(1, -1);\n  });\n  lazy.prop(o, 'signature', () => {\n    if (!a.input) return;\n    return _chunks()[0];\n  });\n  lazy.prop(o, 'input', () => {\n    if (!a.signature) return;\n    return bscript.compile([a.signature]);\n  });\n  lazy.prop(o, 'witness', () => {\n    if (!o.input) return;\n    return [];\n  });\n  // extended validation\n  if (opts.validate) {\n    if (a.output) {\n      if (a.output[a.output.length - 1] !== OPS.OP_CHECKSIG) throw new TypeError('Output is invalid');\n      if (!(0, types_1.isPoint)(o.pubkey)) throw new TypeError('Output pubkey is invalid');\n      if (a.pubkey && !a.pubkey.equals(o.pubkey)) throw new TypeError('Pubkey mismatch');\n    }\n    if (a.signature) {\n      if (a.input && !a.input.equals(o.input)) throw new TypeError('Signature mismatch');\n    }\n    if (a.input) {\n      if (_chunks().length !== 1) throw new TypeError('Input is invalid');\n      if (!bscript.isCanonicalScriptSignature(o.signature)) throw new TypeError('Input has invalid signature');\n    }\n  }\n  return Object.assign(o, a);\n}\nexports.p2pk = p2pk;","map":{"version":3,"names":["Object","defineProperty","exports","value","p2pk","networks_1","require","bscript","types_1","lazy","OPS","a","opts","input","output","pubkey","signature","TypeError","assign","validate","typeforce","network","maybe","Buffer","isPoint","isCanonicalScriptSignature","_chunks","decompile","bitcoin","o","name","prop","compile","OP_CHECKSIG","slice","length","equals"],"sources":["/workspace/Planq-Dapps/vesting-portal/node_modules/bitcoinjs-lib/src/payments/p2pk.js"],"sourcesContent":["'use strict';\nObject.defineProperty(exports, '__esModule', { value: true });\nexports.p2pk = void 0;\nconst networks_1 = require('../networks');\nconst bscript = require('../script');\nconst types_1 = require('../types');\nconst lazy = require('./lazy');\nconst OPS = bscript.OPS;\n// input: {signature}\n// output: {pubKey} OP_CHECKSIG\nfunction p2pk(a, opts) {\n  if (!a.input && !a.output && !a.pubkey && !a.input && !a.signature)\n    throw new TypeError('Not enough data');\n  opts = Object.assign({ validate: true }, opts || {});\n  (0, types_1.typeforce)(\n    {\n      network: types_1.typeforce.maybe(types_1.typeforce.Object),\n      output: types_1.typeforce.maybe(types_1.typeforce.Buffer),\n      pubkey: types_1.typeforce.maybe(types_1.isPoint),\n      signature: types_1.typeforce.maybe(bscript.isCanonicalScriptSignature),\n      input: types_1.typeforce.maybe(types_1.typeforce.Buffer),\n    },\n    a,\n  );\n  const _chunks = lazy.value(() => {\n    return bscript.decompile(a.input);\n  });\n  const network = a.network || networks_1.bitcoin;\n  const o = { name: 'p2pk', network };\n  lazy.prop(o, 'output', () => {\n    if (!a.pubkey) return;\n    return bscript.compile([a.pubkey, OPS.OP_CHECKSIG]);\n  });\n  lazy.prop(o, 'pubkey', () => {\n    if (!a.output) return;\n    return a.output.slice(1, -1);\n  });\n  lazy.prop(o, 'signature', () => {\n    if (!a.input) return;\n    return _chunks()[0];\n  });\n  lazy.prop(o, 'input', () => {\n    if (!a.signature) return;\n    return bscript.compile([a.signature]);\n  });\n  lazy.prop(o, 'witness', () => {\n    if (!o.input) return;\n    return [];\n  });\n  // extended validation\n  if (opts.validate) {\n    if (a.output) {\n      if (a.output[a.output.length - 1] !== OPS.OP_CHECKSIG)\n        throw new TypeError('Output is invalid');\n      if (!(0, types_1.isPoint)(o.pubkey))\n        throw new TypeError('Output pubkey is invalid');\n      if (a.pubkey && !a.pubkey.equals(o.pubkey))\n        throw new TypeError('Pubkey mismatch');\n    }\n    if (a.signature) {\n      if (a.input && !a.input.equals(o.input))\n        throw new TypeError('Signature mismatch');\n    }\n    if (a.input) {\n      if (_chunks().length !== 1) throw new TypeError('Input is invalid');\n      if (!bscript.isCanonicalScriptSignature(o.signature))\n        throw new TypeError('Input has invalid signature');\n    }\n  }\n  return Object.assign(o, a);\n}\nexports.p2pk = p2pk;\n"],"mappings":"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"},"metadata":{},"sourceType":"script","externalDependencies":[]}