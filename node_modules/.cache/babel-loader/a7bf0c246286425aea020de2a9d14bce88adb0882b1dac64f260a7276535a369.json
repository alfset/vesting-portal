{"ast":null,"code":"var _jsxFileName = \"/workspace/Planq-Dapps/vesting-portal/src/components/Lazyload/LazyList.tsx\";\nimport React, { useState, useEffect, useMemo } from 'react';\nimport LazyloadService from './LazyloadService';\nexport const LazyList = _ref => {\n  let {\n    pageSize,\n    records,\n    list: List,\n    boxRef,\n    watchRef,\n    children\n  } = _ref;\n  const size = pageSize || 20;\n  const [page, setPage] = useState(1);\n  const [loadService, setLoadService] = useState();\n  useEffect(() => {\n    let service;\n    if (!boxRef || boxRef && (boxRef === null || boxRef === void 0 ? void 0 : boxRef.current)) {\n      service = LazyloadService.createElementObserve((boxRef === null || boxRef === void 0 ? void 0 : boxRef.current) || null);\n      setLoadService(service);\n    }\n    return () => {\n      if (service) {\n        service.disconnect();\n        setLoadService(undefined);\n      }\n    };\n  }, []);\n  const [pageCount, isLimit] = useMemo(() => {\n    const count = Math.ceil(records.length / size) || 1;\n    const limit = page >= count;\n    return [count, limit];\n  }, [records, size, page]);\n  useEffect(() => {\n    // eslint-disable-next-line @typescript-eslint/ban-types\n    let unsubscribe;\n    if (!isLimit && loadService && (watchRef === null || watchRef === void 0 ? void 0 : watchRef.current)) {\n      unsubscribe = loadService.subscribe(watchRef === null || watchRef === void 0 ? void 0 : watchRef.current, e => {\n        if (e && e.intersectionRatio && page < pageCount) {\n          setPage(page + 1);\n        }\n      });\n    }\n    return () => {\n      if (unsubscribe) {\n        unsubscribe();\n      }\n    };\n  }, [loadService, page, pageCount, isLimit]);\n  const currentRecords = useMemo(() => {\n    return records ? records.slice(0, page * size) : records;\n  }, [records, page, size]);\n  return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(List, {\n    records: currentRecords,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 59,\n      columnNumber: 5\n    }\n  }), !isLimit ? children : null);\n};","map":{"version":3,"names":["React","useState","useEffect","useMemo","LazyloadService","LazyList","_ref","pageSize","records","list","List","boxRef","watchRef","children","size","page","setPage","loadService","setLoadService","service","current","createElementObserve","disconnect","undefined","pageCount","isLimit","count","Math","ceil","length","limit","unsubscribe","subscribe","e","intersectionRatio","currentRecords","slice","createElement","Fragment","__self","__source","fileName","_jsxFileName","lineNumber","columnNumber"],"sources":["/workspace/Planq-Dapps/vesting-portal/src/components/Lazyload/LazyList.tsx"],"sourcesContent":["import React, { useState, useEffect, useMemo, RefObject, PropsWithChildren } from 'react';\nimport LazyloadService from './LazyloadService';\n\ntype Props = {\n  pageSize?: number;\n  records: any[];\n  list: any;\n  boxRef?: RefObject<any>;\n  watchRef?: RefObject<any>;\n}\n\nexport const LazyList = ({ pageSize, records, list: List, boxRef, watchRef, children}: PropsWithChildren<Props>) => {\n  const size = pageSize || 20;\n  const [page, setPage] = useState<number>(1);\n  const [loadService, setLoadService] = useState<LazyloadService>();\n\n  useEffect(() => {\n    let service: LazyloadService;\n    if (!boxRef || (boxRef && boxRef?.current)) {\n      service = LazyloadService.createElementObserve(boxRef?.current || null);\n      setLoadService(service);\n    }\n    return () => {\n      if (service) {\n        service.disconnect();\n        setLoadService(undefined);\n      }\n    }\n  }, []);\n\n  const [pageCount, isLimit] = useMemo(() => {\n    const count: any = Math.ceil(records.length / size) || 1;\n    const limit: any = page >= count;\n    return [count, limit];\n  }, [records, size, page]);\n\n  useEffect(() => {\n    // eslint-disable-next-line @typescript-eslint/ban-types\n    let unsubscribe: Function;\n    if (!isLimit && loadService && watchRef?.current) {\n      unsubscribe = loadService.subscribe(watchRef?.current, (e: any) => {\n        if (e && e.intersectionRatio && page < pageCount) {\n          setPage(page + 1);\n        }\n      })\n    }\n    return () => {\n      if (unsubscribe) {\n        unsubscribe();\n      }\n    }\n  }, [loadService, page, pageCount, isLimit]);\n\n  const currentRecords = useMemo(() => {\n    return records ? records.slice(0, page * size) : records;\n  }, [records, page, size]);\n\n  return (<>\n    <List records={ currentRecords }/>\n    { !isLimit ? children : null }\n  </>)\n}"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}