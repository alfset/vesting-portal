{"ast":null,"code":"import { AccAddress } from '@terra-money/terra.js';\nexport const storage = typeof window === 'undefined' ? undefined : localStorage;\nexport const SESSION = '__terra_chrome_extension_session__';\nexport function getStoredSession() {\n  const data = storage === null || storage === void 0 ? void 0 : storage.getItem(SESSION);\n  if (!data) {\n    return undefined;\n  }\n  try {\n    const object = JSON.parse(data);\n    if ('identifier' in object && 'walletAddress' in object && AccAddress.validate(object['walletAddress'])) {\n      return {\n        identifier: object['identifier'],\n        walletAddress: object['walletAddress']\n      };\n    } else {\n      storage === null || storage === void 0 ? void 0 : storage.removeItem(SESSION);\n      return undefined;\n    }\n  } catch (_a) {\n    storage === null || storage === void 0 ? void 0 : storage.removeItem(SESSION);\n    return undefined;\n  }\n}\nexport function storeSession(session) {\n  if (!AccAddress.validate(session.walletAddress)) {\n    throw new Error(\"\".concat(session.walletAddress, \" is invalid terra address!\"));\n  }\n  storage === null || storage === void 0 ? void 0 : storage.setItem(SESSION, JSON.stringify(session));\n}\nexport function clearSession() {\n  storage === null || storage === void 0 ? void 0 : storage.removeItem(SESSION);\n}\n//export function getStoredAddress(): string | null {\n//  const address = storage?.getItem(WALLET_ADDRESS);\n//  return address && AccAddress.validate(address) ? address : null;\n//}\n//\n//export function storeAddress(address: string) {\n//  if (!AccAddress.validate(address)) {\n//    throw new Error(`${address} is invalidate terra address!`);\n//  }\n//\n//  storage && storage.setItem(WALLET_ADDRESS, address);\n//}\n//\n//export function clearStore() {\n//  storage && storage.removeItem(WALLET_ADDRESS);\n//}","map":{"version":3,"names":["AccAddress","storage","window","undefined","localStorage","SESSION","getStoredSession","data","getItem","object","JSON","parse","validate","identifier","walletAddress","removeItem","_a","storeSession","session","Error","concat","setItem","stringify","clearSession"],"sources":["../../../src/@terra-dev/chrome-extension/storage.ts"],"sourcesContent":["import { AccAddress } from '@terra-money/terra.js';\n\nexport const storage = typeof window === 'undefined' ? undefined : localStorage;\n\n//export const WALLET_ADDRESS: string =\n//  '__terra_chrome_extension_wallet_address__';\n\ninterface Session {\n  identifier: string;\n  walletAddress: string;\n}\n\nexport const SESSION: string = '__terra_chrome_extension_session__';\n\nexport function getStoredSession(): Session | undefined {\n  const data = storage?.getItem(SESSION);\n\n  if (!data) {\n    return undefined;\n  }\n\n  try {\n    const object = JSON.parse(data);\n\n    if (\n      'identifier' in object &&\n      'walletAddress' in object &&\n      AccAddress.validate(object['walletAddress'])\n    ) {\n      return {\n        identifier: object['identifier'],\n        walletAddress: object['walletAddress'],\n      };\n    } else {\n      storage?.removeItem(SESSION);\n      return undefined;\n    }\n  } catch {\n    storage?.removeItem(SESSION);\n    return undefined;\n  }\n}\n\nexport function storeSession(session: Session) {\n  if (!AccAddress.validate(session.walletAddress)) {\n    throw new Error(`${session.walletAddress} is invalid terra address!`);\n  }\n\n  storage?.setItem(SESSION, JSON.stringify(session));\n}\n\nexport function clearSession() {\n  storage?.removeItem(SESSION);\n}\n\n//export function getStoredAddress(): string | null {\n//  const address = storage?.getItem(WALLET_ADDRESS);\n//  return address && AccAddress.validate(address) ? address : null;\n//}\n//\n//export function storeAddress(address: string) {\n//  if (!AccAddress.validate(address)) {\n//    throw new Error(`${address} is invalidate terra address!`);\n//  }\n//\n//  storage && storage.setItem(WALLET_ADDRESS, address);\n//}\n//\n//export function clearStore() {\n//  storage && storage.removeItem(WALLET_ADDRESS);\n//}\n"],"mappings":"AAAA,SAASA,UAAU,QAAQ,uBAAuB;AAElD,OAAO,MAAMC,OAAO,GAAG,OAAOC,MAAM,KAAK,WAAW,GAAGC,SAAS,GAAGC,YAAY;AAU/E,OAAO,MAAMC,OAAO,GAAW,oCAAoC;AAEnE,OAAM,SAAUC,gBAAgBA,CAAA;EAC9B,MAAMC,IAAI,GAAGN,OAAO,aAAPA,OAAO,uBAAPA,OAAO,CAAEO,OAAO,CAACH,OAAO,CAAC;EAEtC,IAAI,CAACE,IAAI,EAAE;IACT,OAAOJ,SAAS;;EAGlB,IAAI;IACF,MAAMM,MAAM,GAAGC,IAAI,CAACC,KAAK,CAACJ,IAAI,CAAC;IAE/B,IACE,YAAY,IAAIE,MAAM,IACtB,eAAe,IAAIA,MAAM,IACzBT,UAAU,CAACY,QAAQ,CAACH,MAAM,CAAC,eAAe,CAAC,CAAC,EAC5C;MACA,OAAO;QACLI,UAAU,EAAEJ,MAAM,CAAC,YAAY,CAAC;QAChCK,aAAa,EAAEL,MAAM,CAAC,eAAe;OACtC;KACF,MAAM;MACLR,OAAO,aAAPA,OAAO,uBAAPA,OAAO,CAAEc,UAAU,CAACV,OAAO,CAAC;MAC5B,OAAOF,SAAS;;GAEnB,CAAC,OAAAa,EAAA,EAAM;IACNf,OAAO,aAAPA,OAAO,uBAAPA,OAAO,CAAEc,UAAU,CAACV,OAAO,CAAC;IAC5B,OAAOF,SAAS;;AAEpB;AAEA,OAAM,SAAUc,YAAYA,CAACC,OAAgB;EAC3C,IAAI,CAAClB,UAAU,CAACY,QAAQ,CAACM,OAAO,CAACJ,aAAa,CAAC,EAAE;IAC/C,MAAM,IAAIK,KAAK,IAAAC,MAAA,CAAIF,OAAO,CAACJ,aAAa,+BAA4B,CAAC;;EAGvEb,OAAO,aAAPA,OAAO,uBAAPA,OAAO,CAAEoB,OAAO,CAAChB,OAAO,EAAEK,IAAI,CAACY,SAAS,CAACJ,OAAO,CAAC,CAAC;AACpD;AAEA,OAAM,SAAUK,YAAYA,CAAA;EAC1BtB,OAAO,aAAPA,OAAO,uBAAPA,OAAO,CAAEc,UAAU,CAACV,OAAO,CAAC;AAC9B;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA"},"metadata":{},"sourceType":"module","externalDependencies":[]}