{"ast":null,"code":"\"use strict\";\n\nvar config = require(\"./config\");\nvar Utils = require(\"./Utils\");\nfunction openApp(appParams, options) {\n  var url = config.nanoScheme(options.debug);\n  url = url + \"://virtual?params=\" + JSON.stringify(appParams);\n  window.location.href = url;\n  // var ifr = document.createElement('iframe');\n  // ifr.src = url;\n  // ifr.style.display='none';\n\n  //if (!Utils.isNano() && options.mobile.showInstallTip) {\n  checkOpen(function (opened) {\n    if (!opened) {\n      //showNanoInstallTip(options);\n      alertNanoInstall();\n    }\n  });\n  //}\n\n  // document.body.appendChild(ifr);      \n  // setTimeout(function() {\n  //     document.body.removeChild(ifr);\n  // }, 2000); \n}\n\nfunction alertNanoInstall() {\n  if (window.confirm('NasNano is not installed. Click \"ok\" to install it.')) {\n    //window.open(\"https://nano.nebulas.io/\");  //usually pop-up window is blocked\n    window.location.href = 'https://nano.nebulas.io/';\n  }\n}\n\n//check app open\nfunction checkOpen(cb) {\n  var _clickTime = +new Date();\n  function check(elsTime) {\n    if (elsTime > 3000 || document.hidden || document.webkitHidden) {\n      cb(1);\n    } else {\n      cb(0);\n    }\n  }\n\n  //Start the timer running at an interval of 20ms \n  // and check whether the cumulative consumption time exceeds 3000ms\n  var _count = 0,\n    intHandle;\n  intHandle = setInterval(function () {\n    _count++;\n    var elsTime = +new Date() - _clickTime;\n    if (_count >= 100 || elsTime > 3000) {\n      clearInterval(intHandle);\n      check(elsTime);\n    }\n  }, 20);\n}\nfunction showNanoInstallTip(options) {\n  var installBtn = document.createElement(\"BUTTON\");\n  installBtn.className = \"install\";\n  installBtn.innerHTML = options.mobile.installTip || \"INSTALL NASNano/下载星云钱包\";\n  /*jshint multistr: true */\n  var style = \"text-align: center;\\\n    background-color: #000;\\\n    color: #fff;\\\n    border-radius: 20px;\\\n    width: 80%;\\\n    height: 40px;\\\n    position: absolute;\\\n    left: 50%;\\\n    top: 50%;\\\n    transform: translate(-50%,-50%);\";\n  Utils.addCssRule(\".install\", style);\n  var background = document.createElement(\"div\");\n  background.className = \"install-background\";\n  style = \"position: fixed;\\\n\tbottom:0;\\\n\tz-index:1000;\\\n\theight:40px;\\\n    width:100%;\\\n\tbackground-color: rgba(0, 0, 0, 0);\";\n  Utils.addCssRule(\".install-background\", style);\n  background.appendChild(installBtn);\n  var bodys = document.getElementsByTagName(\"body\");\n  var body = bodys[0];\n  body.appendChild(background);\n  installBtn.onclick = function () {\n    body.removeChild(background);\n    background = null;\n    //window.location.href = \"https://nano.nebulas.io/\";\n    window.open(\"https://nano.nebulas.io/\");\n  };\n}\nmodule.exports = openApp;","map":{"version":3,"names":["config","require","Utils","openApp","appParams","options","url","nanoScheme","debug","JSON","stringify","window","location","href","checkOpen","opened","alertNanoInstall","confirm","cb","_clickTime","Date","check","elsTime","document","hidden","webkitHidden","_count","intHandle","setInterval","clearInterval","showNanoInstallTip","installBtn","createElement","className","innerHTML","mobile","installTip","style","addCssRule","background","appendChild","bodys","getElementsByTagName","body","onclick","removeChild","open","module","exports"],"sources":["/workspace/Planq-Dapps/vesting-portal/node_modules/nebpay.js/libs/appHandler.js"],"sourcesContent":["\"use strict\";\n\nvar config = require(\"./config\");\nvar Utils = require(\"./Utils\");\n\nfunction openApp(appParams, options) {\n    var url = config.nanoScheme(options.debug);\n    url = url + \"://virtual?params=\" + JSON.stringify(appParams);\n    window.location.href = url;\n    // var ifr = document.createElement('iframe');\n    // ifr.src = url;\n    // ifr.style.display='none';\n\n    //if (!Utils.isNano() && options.mobile.showInstallTip) {\n        checkOpen(function(opened) {\n            if (!opened) {\n                //showNanoInstallTip(options);\n\t\t\t\talertNanoInstall();\n            }\n        });\n    //}\n\n    // document.body.appendChild(ifr);      \n    // setTimeout(function() {\n    //     document.body.removeChild(ifr);\n    // }, 2000); \n}\n\nfunction alertNanoInstall(){\n    if (window.confirm('NasNano is not installed. Click \"ok\" to install it.'))\n    {\n        //window.open(\"https://nano.nebulas.io/\");  //usually pop-up window is blocked\n        window.location.href='https://nano.nebulas.io/';\n    }\n}\n\n//check app open\nfunction checkOpen(cb){\n\tvar _clickTime = +(new Date());\n\tfunction check(elsTime) {\n\t\tif ( elsTime > 3000 || document.hidden || document.webkitHidden) {\n\t\t\tcb(1);\n\t\t} else {\n\t\t\tcb(0);\n\t\t}\n\t}\n\n\t//Start the timer running at an interval of 20ms \n\t// and check whether the cumulative consumption time exceeds 3000ms\n\tvar _count = 0, intHandle;\n\tintHandle = setInterval(function(){\n\t\t_count++;        \n\t\tvar elsTime = +(new Date()) - _clickTime;\n\t\tif (_count>=100 || elsTime > 3000 ) {\n\t\t\tclearInterval(intHandle);\n\t\t\tcheck(elsTime);\n\t\t}\n\t}, 20);\n}\n\nfunction showNanoInstallTip(options) {\n    var installBtn = document.createElement(\"BUTTON\");\n\tinstallBtn.className = \"install\";\n    installBtn.innerHTML = options.mobile.installTip || \"INSTALL NASNano/下载星云钱包\";\n    /*jshint multistr: true */\n\tvar style = (\"text-align: center;\\\n    background-color: #000;\\\n    color: #fff;\\\n    border-radius: 20px;\\\n    width: 80%;\\\n    height: 40px;\\\n    position: absolute;\\\n    left: 50%;\\\n    top: 50%;\\\n    transform: translate(-50%,-50%);\");\n\tUtils.addCssRule(\".install\", style);\n\n    var background = document.createElement(\"div\");\n\tbackground.className = \"install-background\";\n\tstyle = \"position: fixed;\\\n\tbottom:0;\\\n\tz-index:1000;\\\n\theight:40px;\\\n    width:100%;\\\n\tbackground-color: rgba(0, 0, 0, 0);\";\n\tUtils.addCssRule(\".install-background\", style);\n\tbackground.appendChild(installBtn);\n\n\tvar bodys = document.getElementsByTagName(\"body\");\n\tvar body = bodys[0];\n    body.appendChild(background);\n    \n    installBtn.onclick = function () {\n\t\tbody.removeChild(background);\n        background = null;\n        //window.location.href = \"https://nano.nebulas.io/\";\n        window.open(\"https://nano.nebulas.io/\");\n\t};\n}\n\nmodule.exports = openApp;"],"mappings":"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"},"metadata":{},"sourceType":"script","externalDependencies":[]}