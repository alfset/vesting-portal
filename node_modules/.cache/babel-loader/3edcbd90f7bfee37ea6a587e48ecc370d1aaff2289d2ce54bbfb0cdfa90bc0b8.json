{"ast":null,"code":"import{parseBytes32String}from'@ethersproject/strings';import{useMemo}from'react';// import { useSelectedTokenList } from '../state/lists/hooks'\nimport{NEVER_RELOAD,useSingleCallResult}from'../state/multicall/hooks';import{useUserAddedTokens}from'../state/user/hooks';import{isAddress}from'../utils';import{useActiveWeb3React}from'./index';import{useBytes32TokenContract,useTokenContract}from'./useContract';// import config from '../config'\nexport function useAllTokens(){const{chainId}=useActiveWeb3React();const userAddedTokens=useUserAddedTokens();// const allTokens = useSelectedTokenList()\nreturn useMemo(()=>{if(!chainId)return{};return userAddedTokens// reduce into all ALL_TOKENS filtered by the current chain\n.reduce((tokenMap,token)=>{tokenMap[token.address]=token;return tokenMap;},// must make a copy because reduce modifies the map, and we do not\n// want to make a copy in every iteration\n// { ...allTokens[chainId] }\n{});},[chainId,userAddedTokens]);}// parse a name or symbol from a token response\nconst BYTES32_REGEX=/^0x[a-fA-F0-9]{64}$/;function parseStringOrBytes32(str,bytes32,defaultValue){return str&&str.length>0?str:bytes32&&BYTES32_REGEX.test(bytes32)?parseBytes32String(bytes32):defaultValue;}// undefined if invalid or does not exist\n// null if loading\n// otherwise returns the token\nexport function useToken(tokenAddress){const{chainId}=useActiveWeb3React();const tokens=useAllTokens();const address=isAddress(tokenAddress);const tokenContract=useTokenContract(address?address:undefined,false);const tokenContractBytes32=useBytes32TokenContract(address?address:undefined,false);const token=address?tokens[address]:undefined;// console.log(token)\nconst tokenName=useSingleCallResult(token?undefined:tokenContract,'name',undefined,NEVER_RELOAD);const tokenNameBytes32=useSingleCallResult(token?undefined:tokenContractBytes32,'name',undefined,NEVER_RELOAD);const symbol=useSingleCallResult(token?undefined:tokenContract,'symbol',undefined,NEVER_RELOAD);const symbolBytes32=useSingleCallResult(token?undefined:tokenContractBytes32,'symbol',undefined,NEVER_RELOAD);const decimals=useSingleCallResult(token?undefined:tokenContract,'decimals',undefined,NEVER_RELOAD);return useMemo(()=>{if(token)return token;if(!chainId||!address)return undefined;if(decimals.loading||symbol.loading||tokenName.loading)return null;if(decimals.result){var _symbol$result,_symbolBytes32$result,_tokenName$result,_tokenNameBytes32$res;return{chainId,address,decimals:decimals.result[0],symbol:parseStringOrBytes32((_symbol$result=symbol.result)===null||_symbol$result===void 0?void 0:_symbol$result[0],(_symbolBytes32$result=symbolBytes32.result)===null||_symbolBytes32$result===void 0?void 0:_symbolBytes32$result[0],'UNKNOWN'),name:parseStringOrBytes32((_tokenName$result=tokenName.result)===null||_tokenName$result===void 0?void 0:_tokenName$result[0],(_tokenNameBytes32$res=tokenNameBytes32.result)===null||_tokenNameBytes32$res===void 0?void 0:_tokenNameBytes32$res[0],'Unknown Token')};}return undefined;},[address,chainId,decimals.loading,decimals.result,symbol.loading,symbol.result,symbolBytes32.result,token,tokenName.loading,tokenName.result,tokenNameBytes32.result]);}export function useLocalToken(currency){const{chainId}=useActiveWeb3React();// const address = isAddress(currency?.address)\nconst address=isAddress(currency===null||currency===void 0?void 0:currency.address);const symbol=currency===null||currency===void 0?void 0:currency.symbol;const name=currency===null||currency===void 0?void 0:currency.name;const decimals=currency===null||currency===void 0?void 0:currency.decimals;const underlying=currency===null||currency===void 0?void 0:currency.underlying;const ContractVersion=currency===null||currency===void 0?void 0:currency.ContractVersion;const destChains=currency===null||currency===void 0?void 0:currency.destChains;const logoUrl=currency===null||currency===void 0?void 0:currency.logoUrl;const price=currency===null||currency===void 0?void 0:currency.price;// const token = address && name ? undefined : useToken(address ? address : undefined)\n// console.log(token)\n// console.log(address)\n// console.log(currency)\nreturn useMemo(()=>{if(!currency)return undefined;// if (!chainId || !address) return undefined\nif(!chainId||!address)return undefined;// if (token) return token\nreturn{chainId,address,decimals,symbol,name,underlying,ContractVersion,destChains,logoUrl,price};},[address,chainId,symbol,decimals,name,underlying,ContractVersion,destChains,logoUrl,price]);}export function useFormatToken(chainId,address,decimals,name,symbol,underlying){return useMemo(()=>{if(!chainId||!address||!decimals||!name||!symbol)return undefined;return{chainId:Number(chainId),address,decimals,symbol,name,underlying};},[address,chainId,symbol,decimals,name,underlying]);}export function useFormatCurrency(chainId,address,decimals,name,symbol,underlying){const token=useFormatToken(chainId,address,decimals,name,symbol,underlying);return token;}","map":{"version":3,"names":["parseBytes32String","useMemo","NEVER_RELOAD","useSingleCallResult","useUserAddedTokens","isAddress","useActiveWeb3React","useBytes32TokenContract","useTokenContract","useAllTokens","chainId","userAddedTokens","reduce","tokenMap","token","address","BYTES32_REGEX","parseStringOrBytes32","str","bytes32","defaultValue","length","test","useToken","tokenAddress","tokens","tokenContract","undefined","tokenContractBytes32","tokenName","tokenNameBytes32","symbol","symbolBytes32","decimals","loading","result","_symbol$result","_symbolBytes32$result","_tokenName$result","_tokenNameBytes32$res","name","useLocalToken","currency","underlying","ContractVersion","destChains","logoUrl","price","useFormatToken","Number","useFormatCurrency"],"sources":["/workspace/Planq-Dapps/vesting-portal/src/hooks/Tokens.ts"],"sourcesContent":["import { parseBytes32String } from '@ethersproject/strings'\nimport { useMemo } from 'react'\n// import { useSelectedTokenList } from '../state/lists/hooks'\nimport { NEVER_RELOAD, useSingleCallResult } from '../state/multicall/hooks'\nimport { useUserAddedTokens } from '../state/user/hooks'\nimport { isAddress } from '../utils'\n\nimport { useActiveWeb3React } from './index'\nimport { useBytes32TokenContract, useTokenContract } from './useContract'\n// import config from '../config'\nexport function useAllTokens(): { [address: string]: any } {\n  const { chainId } = useActiveWeb3React()\n  const userAddedTokens = useUserAddedTokens()\n  // const allTokens = useSelectedTokenList()\n  return useMemo(() => {\n    if (!chainId) return {}\n    return (\n      userAddedTokens\n        // reduce into all ALL_TOKENS filtered by the current chain\n        .reduce<{ [address: string]: any }>(\n          (tokenMap, token) => {\n            tokenMap[token.address] = token\n            return tokenMap\n          },\n          // must make a copy because reduce modifies the map, and we do not\n          // want to make a copy in every iteration\n          // { ...allTokens[chainId] }\n          {}\n        )\n    )\n  }, [chainId, userAddedTokens])\n}\n\n// parse a name or symbol from a token response\nconst BYTES32_REGEX = /^0x[a-fA-F0-9]{64}$/\nfunction parseStringOrBytes32(str: string | undefined, bytes32: string | undefined, defaultValue: string): string {\n  return str && str.length > 0\n    ? str\n    : bytes32 && BYTES32_REGEX.test(bytes32)\n    ? parseBytes32String(bytes32)\n    : defaultValue\n}\n\n// undefined if invalid or does not exist\n// null if loading\n// otherwise returns the token\nexport function useToken(tokenAddress?: string): any | undefined | null {\n  const { chainId } = useActiveWeb3React()\n  const tokens = useAllTokens()\n\n  const address = isAddress(tokenAddress)\n\n  const tokenContract = useTokenContract(address ? address : undefined, false)\n  const tokenContractBytes32 = useBytes32TokenContract(address ? address : undefined, false)\n  const token: any | undefined = address ? tokens[address] : undefined\n\n  // console.log(token)\n  const tokenName = useSingleCallResult(token ? undefined : tokenContract, 'name', undefined, NEVER_RELOAD)\n  const tokenNameBytes32 = useSingleCallResult(\n    token ? undefined : tokenContractBytes32,\n    'name',\n    undefined,\n    NEVER_RELOAD\n  )\n  const symbol = useSingleCallResult(token ? undefined : tokenContract, 'symbol', undefined, NEVER_RELOAD)\n  const symbolBytes32 = useSingleCallResult(token ? undefined : tokenContractBytes32, 'symbol', undefined, NEVER_RELOAD)\n  const decimals = useSingleCallResult(token ? undefined : tokenContract, 'decimals', undefined, NEVER_RELOAD)\n\n  return useMemo(() => {\n    if (token) return token\n    if (!chainId || !address) return undefined\n    if (decimals.loading || symbol.loading || tokenName.loading) return null\n    if (decimals.result) {\n      return {\n        chainId,\n        address,\n        decimals: decimals.result[0],\n        symbol: parseStringOrBytes32(symbol.result?.[0], symbolBytes32.result?.[0], 'UNKNOWN'),\n        name: parseStringOrBytes32(tokenName.result?.[0], tokenNameBytes32.result?.[0], 'Unknown Token')\n      }\n    }\n    return undefined\n  }, [\n    address,\n    chainId,\n    decimals.loading,\n    decimals.result,\n    symbol.loading,\n    symbol.result,\n    symbolBytes32.result,\n    token,\n    tokenName.loading,\n    tokenName.result,\n    tokenNameBytes32.result\n  ])\n}\n\nexport function useLocalToken(currency?: any): any | undefined | null {\n  const { chainId } = useActiveWeb3React()\n\n  // const address = isAddress(currency?.address)\n  const address = isAddress(currency?.address)\n\n  const symbol = currency?.symbol\n  const name = currency?.name\n  const decimals = currency?.decimals\n  const underlying = currency?.underlying\n\n  const ContractVersion = currency?.ContractVersion\n  const destChains = currency?.destChains\n  const logoUrl = currency?.logoUrl\n  const price = currency?.price\n\n  // const token = address && name ? undefined : useToken(address ? address : undefined)\n  // console.log(token)\n  // console.log(address)\n  // console.log(currency)\n  return useMemo(() => {\n    if (!currency) return undefined\n    // if (!chainId || !address) return undefined\n    if (!chainId || !address) return undefined\n    // if (token) return token\n    return {\n      chainId,\n      address,\n      decimals,\n      symbol,\n      name,\n      underlying,\n      ContractVersion,\n      destChains,\n      logoUrl,\n      price,\n    }\n  }, [\n    address,\n    chainId,\n    symbol,\n    decimals,\n    name,\n    underlying,\n    ContractVersion,\n    destChains,\n    logoUrl,\n    price,\n  ])\n}\n\nexport function useFormatToken(\n  chainId?: any,\n  address?: any,\n  decimals?: any,\n  name?: any,\n  symbol?: any,\n  underlying?: any,\n): any | undefined | null {\n\n  return useMemo(() => {\n    if (\n      !chainId\n      || !address\n      || !decimals\n      || !name\n      || !symbol\n    ) return undefined\n    return {\n      chainId: Number(chainId),\n      address,\n      decimals,\n      symbol,\n      name,\n      underlying\n    }\n  }, [\n    address,\n    chainId,\n    symbol,\n    decimals,\n    name,\n    underlying\n  ])\n}\n\nexport function useFormatCurrency(\n  chainId?: any,\n  address?: any,\n  decimals?: any,\n  name?: any,\n  symbol?: any,\n  underlying?: any\n): any {\n\n  const token = useFormatToken(\n    chainId,\n    address,\n    decimals,\n    name,\n    symbol,\n    underlying,\n  )\n  return token\n}"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}