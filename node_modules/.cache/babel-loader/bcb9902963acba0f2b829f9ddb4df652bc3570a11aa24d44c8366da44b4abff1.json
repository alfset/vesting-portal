{"ast":null,"code":"import * as sdk from '@onflow/sdk';\nimport { invariant as invariant$1, encodeMessageFromSignable, config as config$1, resolve, pipe, interaction, createSignableVoucher, send, getTransactionStatus, decode, block, getEventsAtBlockHeightRange, getAccount, atBlockHeight, arg } from '@onflow/sdk';\nexport { TestUtils, account, arg, args, atBlockHeight, atBlockId, authorization, authorizations, block, build, createSignableVoucher, decode, getAccount, getBlock, getBlockHeader, getCollection, getEvents, getEventsAtBlockHeightRange, getEventsAtBlockIds, getNetworkParameters, getTransaction, getTransactionStatus, invariant, isBad, isOk, limit, param, params, payer, ping, pipe, proposer, ref, script, send, transaction, validator, voucherIntercept, voucherToTxId, why } from '@onflow/sdk';\nimport * as t$1 from '@onflow/types';\nimport { invariant } from '@onflow/util-invariant';\nimport fetchTransport from 'cross-fetch';\nimport { config } from '@onflow/config';\nexport { config } from '@onflow/config';\nimport { withPrefix, sansPrefix } from '@onflow/util-address';\nexport { display, sansPrefix, withPrefix } from '@onflow/util-address';\nimport { log, LEVELS } from '@onflow/util-logger';\nimport * as rlp from '@onflow/rlp';\nimport { Buffer, encode } from '@onflow/rlp';\nimport { snapshoter, subscriber, spawn, INIT, SUBSCRIBE, UPDATED as UPDATED$2, UNSUBSCRIBE, SNAPSHOT as SNAPSHOT$1, send as send$1 } from '@onflow/util-actor';\nimport require$$0 from 'buffer';\nexport { template as cadence, template as cdc } from '@onflow/util-template';\nimport * as semver from '@onflow/util-semver';\nimport { uid } from '@onflow/util-uid';\nconst VERSION = \"1.8.1\";\nconst is = type => d => typeof d === type;\nconst isRequired = d => d != null;\nconst isObject = is(\"object\");\nconst isString = is(\"string\");\nconst isFunc = is(\"function\");\nconst isNumber = is(\"number\");\nfunction normalizeArgs(ax) {\n  if (isFunc(ax)) return ax(sdk.arg, t$1);\n  return [];\n}\nasync function httpDocumentResolver(_ref) {\n  let {\n    url\n  } = _ref;\n  invariant(typeof url !== \"undefined\", \"retrieve({ url }) -- url must be defined\");\n  let res;\n  try {\n    res = await fetchTransport(url);\n  } catch (e) {\n    throw new Error(\"httpDocumentResolver Error: Failed to retrieve document.\");\n  }\n  let document = res.ok ? await res.json() : null;\n  return document;\n}\nconst DOCUMENT_RESOLVERS = new Map([[\"http\", httpDocumentResolver], [\"https\", httpDocumentResolver]]);\nasync function retrieve(_ref2) {\n  let {\n    url\n  } = _ref2;\n  invariant(typeof url !== \"undefined\", \"retrieve({ url }) -- url must be defined\");\n  invariant(typeof url === \"string\", \"retrieve({ url }) -- url must be a string\");\n  const documentResolversFromConfig = await config().where(/^document\\.resolver\\./);\n  Object.keys(documentResolversFromConfig).map(key => {\n    const resolverFromConfig = documentResolversFromConfig[key];\n    const resolverProtocol = key.replace(/^document\\.resolver\\./, \"\");\n    DOCUMENT_RESOLVERS.set(resolverProtocol, resolverFromConfig);\n  });\n  const urlParts = /^(.*):\\/\\/([A-Za-z0-9\\-\\.]+)(:[0-9]+)?(.*)$/.exec(url);\n  invariant(urlParts, \"Failed to parse URL\");\n  const protocol = urlParts[1];\n  invariant(urlParts, \"Failed to parse URL protocol\");\n  const resolver = DOCUMENT_RESOLVERS.get(protocol);\n  invariant(resolver, \"No resolver found for protcol=\".concat(protocol));\n  let document = await resolver({\n    url\n  });\n  return document;\n}\nfunction normalizeInteractionTemplate(template) {\n  if (template == null) return null;\n  switch (template[\"f_version\"]) {\n    case \"1.0.0\":\n      return template;\n    default:\n      throw new Error(\"normalizeInteractionTemplate Error: Invalid InteractionTemplate\");\n  }\n}\n\n/**\n * @description Fills import addresses in Cadence for network\n * \n * @param {object} params\n * @param {string} params.network - Network to derive Cadence for\n * @param {object} params.template - Interaction Template to derive Cadence from\n * @returns {string} - Cadence\n */\nfunction deriveCadenceByNetwork(_ref) {\n  var _template;\n  let {\n    network,\n    template\n  } = _ref;\n  invariant$1(network != undefined, \"deriveCadenceByNetwork({ network }) -- network must be defined\");\n  invariant$1(typeof network === \"string\", \"deriveCadenceByNetwork({ network }) -- network must be a string\");\n  invariant$1(template != undefined, \"generateDependencyPin({ template }) -- template must be defined\");\n  invariant$1(typeof template === \"object\", \"generateDependencyPin({ template }) -- template must be an object\");\n  invariant$1(template.f_type === \"InteractionTemplate\", \"generateDependencyPin({ template }) -- template must be an InteractionTemplate\");\n  template = normalizeInteractionTemplate(template);\n  switch (template.f_version) {\n    case \"1.0.0\":\n      let networkDependencies = Object.keys((_template = template) === null || _template === void 0 || (_template = _template.data) === null || _template === void 0 ? void 0 : _template.dependencies).map(dependencyPlaceholder => {\n        var _template2;\n        let dependencyNetworkContracts = Object.values((_template2 = template) === null || _template2 === void 0 || (_template2 = _template2.data) === null || _template2 === void 0 || (_template2 = _template2.dependencies) === null || _template2 === void 0 ? void 0 : _template2[dependencyPlaceholder]);\n        invariant$1(dependencyNetworkContracts, \"deriveCadenceByNetwork -- Could not find contracts for dependency placeholder: \".concat(dependencyPlaceholder));\n        invariant$1(dependencyNetworkContracts.length === 0, \"deriveCadenceByNetwork -- Could not find contracts for dependency placeholder: \".concat(dependencyPlaceholder));\n        let dependencyContract = dependencyNetworkContracts[0];\n        let dependencyContractForNetwork = dependencyContract === null || dependencyContract === void 0 ? void 0 : dependencyContract[network];\n        invariant$1(dependencyContractForNetwork, \"deriveCadenceByNetwork -- Could not find \".concat(network, \" network information for dependency: \").concat(dependencyPlaceholder));\n        return [dependencyPlaceholder, dependencyContractForNetwork.address];\n      });\n      return networkDependencies.reduce((cadence, _ref2) => {\n        let [placeholder, address] = _ref2;\n        const regex = new RegExp(\"(\\\\b\" + placeholder + \"\\\\b)\", \"g\");\n        return cadence.replace(regex, address);\n      }, template.data.cadence);\n    default:\n      throw new Error(\"deriveCadenceByNetwork Error: Unsupported template version\");\n  }\n}\nasync function fetchChainId() {\n  let opts = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n  const response = await sdk.send([sdk.getNetworkParameters()], opts).then(sdk.decode);\n  return response.chainId;\n}\n\n// Cache of chainId promises for each access node value\n// key: access node, value: chainId promise\nlet chainIdCache = {};\nlet hasWarnedEnv = false;\n\n/**\n * @description\n * Gets the chain ID if its set, otherwise gets the chain ID from the access node\n *\n * @param {object} opts - Optional parameters\n * @returns {Promise<string>} The chain ID of the access node\n * @throws {Error} If the chain ID is not found\n *\n * @example\n * // returns \"testnet\"\n * getChainId()\n */\nasync function getChainId() {\n  let opts = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n  let flowNetworkCfg = await config.get(\"flow.network\");\n  let envCfg = await config.get(\"env\");\n  if (envCfg && !hasWarnedEnv) {\n    log.deprecate({\n      pkg: \"FCL\",\n      subject: 'Using the \"env\" configuration key for specifying the flow network',\n      message: \"Configuring to specify flow network is no longer required\",\n      transition: \"https://github.com/onflow/flow-js-sdk/blob/master/packages/fcl/TRANSITIONS.md#0001-deprecate-env-config-key\"\n    });\n    hasWarnedEnv = true;\n  }\n  const accessNode = opts.node || (await config.get(\"accessNode.api\"));\n  if (!accessNode) {\n    // Fall back to deprecated flow.network and env config keys\n    // This probably should have been done before trying to fetch the chainId from the access node\n    // However, this was the behaviour with the initial implementation of getChainId()\n    if (flowNetworkCfg) {\n      return flowNetworkCfg;\n    } else if (envCfg) {\n      return envCfg;\n    }\n    throw new Error(\"Either the \\\"accessNode.api\\\" config key or opts.node must be set\");\n  }\n\n  // Try using cached chainId first if it exists and access node is the same\n  if (chainIdCache[accessNode]) {\n    try {\n      return await chainIdCache[accessNode];\n    } catch {}\n  }\n\n  // If no cached chainId, value is stale, or last attempt failed, try getting chainId from access node\n  // Check if another getChainId() call has already started a new promise, if not, start a new one\n  // There may have been concurrent calls to getChainId() while the first call was waiting for the response\n  if (!chainIdCache[accessNode]) {\n    chainIdCache[accessNode] = fetchChainId(opts).catch(error => {\n      // If there was an error, reset the promise so that the next call will try again\n      chainIdCache[accessNode] = null;\n      throw error;\n    });\n  }\n\n  // Use newly created promise\n  try {\n    return await chainIdCache[accessNode];\n  } catch (e) {\n    // Fall back to deprecated flow.network and env config keys\n    // This probably should have been done before trying to fetch the chainId from the access node\n    // However, this was the behaviour with the initial implementation of getChainId()\n    if (flowNetworkCfg) {\n      return flowNetworkCfg;\n    } else if (envCfg) {\n      return envCfg;\n    }\n    throw new Error(\"Error getting chainId from access node - are you using the correct access node endpoint.  If running locally, is your emulator up-to-date? \".concat(e.message));\n  }\n}\n\n/**\n * @description\n * Watches the config for changes to access node and updates the chain id accordingly\n *\n * @returns {Function} A function that unsubscribes the listener\n *\n */\nfunction watchForChainIdChanges() {\n  return config.subscribe(() => {\n    // Call getChainId to update the chainId cache if access node has changed\n    getChainId({\n      enableRequestLogging: false\n    }).catch(() => {});\n  });\n}\nfunction isAndroid() {\n  return typeof navigator !== \"undefined\" && /android/i.test(navigator.userAgent);\n}\nfunction isSmallIOS() {\n  return typeof navigator !== \"undefined\" && /iPhone|iPod/.test(navigator.userAgent);\n}\nfunction isLargeIOS() {\n  return typeof navigator !== \"undefined\" && /iPad/.test(navigator.userAgent);\n}\nfunction isIOS() {\n  return isSmallIOS() || isLargeIOS();\n}\nfunction isMobile() {\n  return isAndroid() || isIOS();\n}\nasync function deriveDependencies() {\n  var _template$data;\n  let opts = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n  const template = opts.template;\n  const network = await getChainId(opts);\n  const derivedDependencies = {};\n  switch (template[\"f_version\"]) {\n    case \"1.0.0\":\n      const dependencyPlaceholderKeys = Object.keys(template === null || template === void 0 || (_template$data = template.data) === null || _template$data === void 0 ? void 0 : _template$data.dependencies);\n      for (let dependencyPlaceholderKey of dependencyPlaceholderKeys) {\n        var _template$data2;\n        let dependencyPlaceholder = template === null || template === void 0 || (_template$data2 = template.data) === null || _template$data2 === void 0 ? void 0 : _template$data2.dependencies[dependencyPlaceholderKey];\n        const dependencyPlaceholderContractsKeys = Object.keys(dependencyPlaceholder);\n        invariant(dependencyPlaceholderContractsKeys.length > 0, \"FCL configureDependencies Error: No contracts found in template for placeholder=\".concat(dependencyPlaceholderKey));\n        const dependencyPlaceholderContract = dependencyPlaceholder[dependencyPlaceholderContractsKeys[0]];\n        const dependency = dependencyPlaceholderContract[network];\n        invariant(dependency, \"FCL configureDependencies Error: No dependency information for placeholder=\".concat(dependencyPlaceholderKey, \" contract=\").concat(dependencyPlaceholderContractsKeys[0], \" network=\").concat(network));\n        invariant(dependency === null || dependency === void 0 ? void 0 : dependency.address, \"FCL configureDependencies Error: No address information for placeholder=\".concat(dependencyPlaceholderKey, \" contract=\").concat(dependencyPlaceholderContractsKeys[0], \" network=\").concat(network));\n        derivedDependencies[dependencyPlaceholderKey] = withPrefix(dependency === null || dependency === void 0 ? void 0 : dependency.address);\n      }\n      return derivedDependencies;\n    default:\n      throw new Error(\"FCL configureDependencies Error: Unsupported template version\");\n  }\n}\nasync function prepTemplateOpts(opts) {\n  if (isString(opts === null || opts === void 0 ? void 0 : opts.template)) {\n    opts.template = await retrieve({\n      url: opts === null || opts === void 0 ? void 0 : opts.template\n    });\n  }\n  let dependencies = {};\n  if (opts !== null && opts !== void 0 && opts.template) {\n    opts.template = normalizeInteractionTemplate(opts === null || opts === void 0 ? void 0 : opts.template);\n    dependencies = await deriveDependencies({\n      template: opts.template\n    });\n  }\n  const cadence = opts.cadence || deriveCadenceByNetwork({\n    template: opts.template,\n    network: await getChainId(opts)\n  });\n  opts.cadence = cadence;\n  opts.dependencies = dependencies;\n  return opts;\n}\nasync function pre(type, opts) {\n  // prettier-ignore\n  invariant(isRequired(opts), \"\".concat(type, \"(opts) -- opts is required\"));\n  // prettier-ignore\n  invariant(isObject(opts), \"\".concat(type, \"(opts) -- opts must be an object\"));\n  // prettier-ignore\n  invariant(!(opts.cadence && opts.template), \"\".concat(type, \"({ template, cadence }) -- cannot pass both cadence and template\"));\n  // prettier-ignore\n  invariant(isRequired(opts.cadence || (opts === null || opts === void 0 ? void 0 : opts.template)), \"\".concat(type, \"({ cadence }) -- cadence is required\"));\n  // // prettier-ignore\n  invariant(isString(opts.cadence) || (opts === null || opts === void 0 ? void 0 : opts.template), \"\".concat(type, \"({ cadence }) -- cadence must be a string\"));\n  // prettier-ignore\n  invariant(await sdk.config().get(\"accessNode.api\"), \"\".concat(type, \"(opts) -- Required value for \\\"accessNode.api\\\" not defined in config. See: \", \"https://github.com/onflow/flow-js-sdk/blob/master/packages/fcl/src/exec/query.md#configuration\"));\n}\nasync function preMutate(opts) {\n  return pre(\"mutate\", opts);\n}\nasync function preQuery(opts) {\n  return pre(\"query\", opts);\n}\n\n/**\n * @description\n * Allows you to submit scripts to query the blockchain.\n *\n *  @param {object} opts - Query Options and configuration\n *  @param {string} opts.cadence - Cadence Script used to query Flow\n *  @param {import(\"../fcl\").ArgsFn} [opts.args] - Arguments passed to cadence script\n *  @param {object} [opts.template] - Interaction Template for a script\n *  @param {number} [opts.limit]   - Compute Limit for Query\n *  @returns {Promise}\n *\n *  @example\n *    const cadence = `\n *      cadence: `\n *        pub fun main(a: Int, b: Int, c: Address): Int {\n *          log(c)\n *          return a + b\n *        }\n *    `.trim()\n *\n *    const args = (arg, t) => [\n *      arg(5, t.Int),\n *      arg(7, t.Int),\n *      arg(\"0xb2db43ad6bc345fec9\", t.Address),\n *    ]\n *\n *    await query({ cadence, args })\n */\nasync function query() {\n  let opts = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n  await preQuery(opts);\n  opts = await prepTemplateOpts(opts);\n  return sdk.config().overload(opts.dependencies || {}, async () =>\n  // prettier-ignore\n  sdk.send([sdk.script(opts.cadence), sdk.args(normalizeArgs(opts.args || [])), opts.limit && typeof opts.limit === \"number\" && sdk.limit(opts.limit)]).then(sdk.decode));\n}\nconst FCL_REDIRECT_URL_PARAM_NAME = 'fcl_redirect_url';\nconst FCL_RESPONSE_PARAM_NAME = 'fclResponseJson';\nconst CORE_STRATEGIES = {\n  \"HTTP/RPC\": \"HTTP/RPC\",\n  \"HTTP/POST\": \"HTTP/POST\",\n  \"IFRAME/RPC\": \"IFRAME/RPC\",\n  \"POP/RPC\": \"POP/RPC\",\n  \"TAB/RPC\": \"TAB/RPC\",\n  \"EXT/RPC\": \"EXT/RPC\",\n  \"DEEPLINK/RPC\": \"DEEPLINK/RPC\"\n};\n\n/**\n * @description\n * Listens for messages from FCL\n * \n * @param {string} messageType - Message type\n * @param {Function} cb - Callback function\n * @returns {Function} - Function to remove event listener\n */\nconst onMessageFromFCL = function (messageType) {\n  let cb = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : () => {};\n  const buildData = data => {\n    var _data$body;\n    if (data.deprecated) console.warn(\"DEPRECATION NOTICE\", data.deprecated.message);\n    data === null || data === void 0 || (_data$body = data.body) === null || _data$body === void 0 || delete _data$body.interaction;\n    return data;\n  };\n  const internal = e => {\n    const {\n      data\n    } = e;\n    if (typeof data !== \"object\") return;\n    if (typeof data == null) return;\n    if (data.type !== messageType) return;\n    cb(buildData(data));\n  };\n  window.addEventListener(\"message\", internal);\n  return () => window.removeEventListener(\"message\", internal);\n};\n\n// This is a workaround for an ongoing issue with URL in React Native\nconst _URL = globalThis.URL;\nclass URL extends _URL {\n  constructor(url, base) {\n    for (var _len = arguments.length, args = new Array(_len > 2 ? _len - 2 : 0), _key = 2; _key < _len; _key++) {\n      args[_key - 2] = arguments[_key];\n    }\n    super(url, base, ...args);\n\n    // Extra check if in React Native\n    {\n      return;\n    }\n  }\n}\n\n/**\n * @description\n * Sends message to FCL window\n *\n * @param {string} type - Message type\n * @param {object} msg - Message object\n * @returns {void}\n *\n * @example\n * sendMsgToFCL(\"FCL:VIEW:RESPONSE\", {\n *    f_type: \"PollingResponse\",\n *    f_vsn: \"1.0.0\",\n *    status: \"APPROVED\",\n *    reason: null,\n *    data: data,\n *  })\n */\nconst sendMsgToFCL = function (type) {\n  let msg = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n  const data = {\n    ...msg,\n    type\n  };\n  const urlParams = new URLSearchParams(window.location.search);\n  const redirectUrl = urlParams.get(FCL_REDIRECT_URL_PARAM_NAME);\n  if (redirectUrl) {\n    const url = new URL(redirectUrl);\n    url.searchParams.append(FCL_RESPONSE_PARAM_NAME, JSON.stringify(data));\n    window.location.href = url.href;\n  } else if (window.location !== window.parent.location) {\n    window.parent.postMessage({\n      ...msg,\n      type\n    }, \"*\");\n  } else if (window.opener) {\n    window.opener.postMessage({\n      ...msg,\n      type\n    }, \"*\");\n  } else {\n    throw new Error(\"Unable to communicate with parent FCL instance\");\n  }\n};\n\n/**\n * @description\n * Listens for \"FCL:VIEW:READY:RESPONSE\" and sends \"FCL:VIEW:READY\"\n *\n * @param {Function} cb - Callback function\n * @param {object} msg - Message object\n * @returns {void}\n */\nconst ready = function (cb) {\n  onMessageFromFCL(\"FCL:VIEW:READY:RESPONSE\", cb);\n  sendMsgToFCL(\"FCL:VIEW:READY\");\n};\n\n/**\n * @description\n * Sends \"FCL:VIEW:CLOSE\"\n *\n * @returns {void}\n */\nconst close = () => {\n  sendMsgToFCL(\"FCL:VIEW:CLOSE\");\n};\n\n/**\n * @description\n * Sends \"FCL:VIEW:RESPONSE\" with status \"APPROVED\"\n *\n * @param {object} data - Data object\n * @returns {void}\n */\nconst approve = data => {\n  sendMsgToFCL(\"FCL:VIEW:RESPONSE\", {\n    f_type: \"PollingResponse\",\n    f_vsn: \"1.0.0\",\n    status: \"APPROVED\",\n    reason: null,\n    data: data\n  });\n};\n\n/**\n * @description\n * Sends \"FCL:VIEW:RESPONSE\" with status \"DECLINED\"\n *\n * @param {string} reason - Reason for declining\n * @returns {void}\n */\nconst decline = reason => {\n  sendMsgToFCL(\"FCL:VIEW:RESPONSE\", {\n    f_type: \"PollingResponse\",\n    f_vsn: \"1.0.0\",\n    status: \"DECLINED\",\n    reason: reason,\n    data: null\n  });\n};\n\n/**\n * @description\n * Sends \"FCL:VIEW:RESPONSE\" with status \"REDIRECT\"\n *\n * @param {object} data - Data object\n * @returns {void}\n */\nconst redirect = data => {\n  sendMsgToFCL(\"FCL:VIEW:RESPONSE\", {\n    f_type: \"PollingResponse\",\n    f_vsn: \"1.0.0\",\n    status: \"REDIRECT\",\n    reason: null,\n    data: data\n  });\n};\nconst SERVICE_PRAGMA = {\n  f_type: \"Service\",\n  f_vsn: \"1.0.0\"\n};\nconst IDENTITY_PRAGMA = {\n  f_type: \"Identity\",\n  f_vsn: \"1.0.0\"\n};\nconst USER_PRAGMA = {\n  f_type: \"USER\",\n  f_vsn: \"1.0.0\"\n};\nconst POLLING_RESPONSE_PRAGMA = {\n  f_type: \"PollingResponse\",\n  f_vsn: \"1.0.0\"\n};\nconst COMPOSITE_SIGNATURE_PRAGMA = {\n  f_type: \"CompositeSignature\",\n  f_vsn: \"1.0.0\"\n};\n\n/**\n * @description\n * Constructs a new CompositeSignature instance.\n *\n * @param {string} addr - Flow Address\n * @param {number} keyId - Key ID\n * @param {string} signature - Signature as a hex string\n */\nfunction CompositeSignature(addr, keyId, signature) {\n  this.f_type = COMPOSITE_SIGNATURE_PRAGMA.f_type;\n  this.f_vsn = COMPOSITE_SIGNATURE_PRAGMA.f_vsn;\n  this.addr = withPrefix(addr);\n  this.keyId = Number(keyId);\n  this.signature = signature;\n}\nconst rightPaddedHexBuffer = (value, pad) => Buffer.from(value.padEnd(pad * 2, \"0\"), \"hex\");\nconst leftPaddedHexBuffer = (value, pad) => Buffer.from(value.padStart(pad * 2, \"0\"), \"hex\");\nconst addressBuffer = addr => leftPaddedHexBuffer(addr, 8);\nconst nonceBuffer = nonce => Buffer.from(nonce, \"hex\");\nconst encodeAccountProof = function (_ref) {\n  let {\n    address,\n    nonce,\n    appIdentifier\n  } = _ref;\n  let includeDomainTag = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : true;\n  invariant(address, \"Encode Message For Provable Authn Error: address must be defined\");\n  invariant(nonce, \"Encode Message For Provable Authn Error: nonce must be defined\");\n  invariant(appIdentifier, \"Encode Message For Provable Authn Error: appIdentifier must be defined\");\n  invariant(nonce.length >= 64, \"Encode Message For Provable Authn Error: nonce must be minimum of 32 bytes\");\n  const ACCOUNT_PROOF_DOMAIN_TAG = rightPaddedHexBuffer(Buffer.from(\"FCL-ACCOUNT-PROOF-V0.0\").toString(\"hex\"), 32);\n  if (includeDomainTag) {\n    return Buffer.concat([ACCOUNT_PROOF_DOMAIN_TAG, encode([appIdentifier, addressBuffer(sansPrefix(address)), nonceBuffer(nonce)])]).toString(\"hex\");\n  }\n  return encode([appIdentifier, addressBuffer(sansPrefix(address)), nonceBuffer(nonce)]).toString(\"hex\");\n};\nfunction injectExtService(service) {\n  if (service.type === \"authn\" && service.endpoint != null) {\n    if (!Array.isArray(window.fcl_extensions)) {\n      window.fcl_extensions = [];\n    }\n    window.fcl_extensions.push(service);\n  } else {\n    console.warn(\"Authn service is required\");\n  }\n}\nvar index$2 = /*#__PURE__*/Object.freeze({\n  __proto__: null,\n  sendMsgToFCL: sendMsgToFCL,\n  ready: ready,\n  close: close,\n  approve: approve,\n  decline: decline,\n  redirect: redirect,\n  onMessageFromFCL: onMessageFromFCL,\n  encodeMessageFromSignable: encodeMessageFromSignable,\n  CompositeSignature: CompositeSignature,\n  encodeAccountProof: encodeAccountProof,\n  injectExtService: injectExtService\n});\nconst ACCOUNT_PROOF = \"ACCOUNT_PROOF\";\nconst USER_SIGNATURE = \"USER_SIGNATURE\";\nconst validateArgs = args => {\n  if (args.appIdentifier) {\n    const {\n      appIdentifier,\n      address,\n      nonce,\n      signatures\n    } = args;\n    invariant(isString(appIdentifier), \"verifyAccountProof({ appIdentifier }) -- appIdentifier must be a string\");\n    invariant(isString(address) && sansPrefix(address).length === 16, \"verifyAccountProof({ address }) -- address must be a valid address\");\n    invariant(/^[0-9a-f]+$/i.test(nonce), \"nonce must be a hex string\");\n    invariant(Array.isArray(signatures) && signatures.every((sig, i, arr) => sig.f_type === \"CompositeSignature\"), \"Must include an Array of CompositeSignatures to verify\");\n    invariant(signatures.map(cs => cs.addr).every((addr, i, arr) => addr === arr[0]), \"User signatures to be verified must be from a single account address\");\n    return true;\n  } else {\n    const {\n      message,\n      address,\n      compSigs\n    } = args;\n    invariant(/^[0-9a-f]+$/i.test(message), \"Signed message must be a hex string\");\n    invariant(isString(address) && sansPrefix(address).length === 16, \"verifyUserSignatures({ address }) -- address must be a valid address\");\n    invariant(Array.isArray(compSigs) && compSigs.every((sig, i, arr) => sig.f_type === \"CompositeSignature\"), \"Must include an Array of CompositeSignatures to verify\");\n    invariant(compSigs.map(cs => cs.addr).every((addr, i, arr) => addr === arr[0]), \"User signatures to be verified must be from a single account address\");\n    return true;\n  }\n};\n\n// TODO: pass in option for contract but we're connected to testnet\n// log address + network -> in sync?\nconst getVerifySignaturesScript = async (sig, opts) => {\n  const verifyFunction = sig === \"ACCOUNT_PROOF\" ? \"verifyAccountProofSignatures\" : \"verifyUserSignatures\";\n  let network = await getChainId(opts);\n  let fclCryptoContract;\n  invariant(opts.fclCryptoContract || network === \"testnet\" || network === \"mainnet\", \"${verifyFunction}({ fclCryptoContract }) -- fclCrypto contract address must be set for non-mainnet/testnet networks\");\n  if (opts.fclCryptoContract) {\n    fclCryptoContract = opts.fclCryptoContract;\n  } else {\n    fclCryptoContract = network === \"testnet\" ? \"0x74daa6f9c7ef24b1\" : \"0xb4b82a1c9d21d284\";\n  }\n  return \"\\n      import FCLCrypto from \".concat(fclCryptoContract, \"\\n\\n      pub fun main(\\n          address: Address, \\n          message: String, \\n          keyIndices: [Int], \\n          signatures: [String]\\n      ): Bool {\\n        return FCLCrypto.\").concat(verifyFunction, \"(address: address, message: message, keyIndices: keyIndices, signatures: signatures)\\n      }\\n    \");\n};\n\n/**\n * @description\n * Verify a valid account proof signature or signatures for an account on Flow.\n *\n * @param {string} appIdentifier - A message string in hexadecimal format\n * @param {object} accountProofData - An object consisting of address, nonce, and signatures\n * @param {string} accountProofData.address - A Flow account address\n * @param {string} accountProofData.nonce - A random string in hexadecimal format (minimum 32 bytes in total, i.e 64 hex characters)\n * @param {object[]} accountProofData.signatures - An array of composite signatures to verify\n * @param {object} [opts={}] - Options object\n * @param {string} opts.fclCryptoContract - An optional override Flow account address where the FCLCrypto contract is deployed\n * @returns {Promise<boolean>} - Returns true if the signature is valid, false otherwise\n *\n * @example\n *\n *  const accountProofData = {\n *   address: \"0x123\",\n *   nonce: \"F0123\"\n *   signatures: [{f_type: \"CompositeSignature\", f_vsn: \"1.0.0\", addr: \"0x123\", keyId: 0, signature: \"abc123\"}],\n *  }\n *\n *  const isValid = await fcl.AppUtils.verifyAccountProof(\n *    \"AwesomeAppId\",\n *    accountProofData,\n *    {fclCryptoContract}\n *  )\n */\nasync function verifyAccountProof(appIdentifier, _ref) {\n  let {\n    address,\n    nonce,\n    signatures\n  } = _ref;\n  let opts = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n  validateArgs({\n    appIdentifier,\n    address,\n    nonce,\n    signatures\n  });\n  const message = encodeAccountProof({\n    address,\n    nonce,\n    appIdentifier\n  }, false);\n  let signaturesArr = [];\n  let keyIndices = [];\n  for (const el of signatures) {\n    signaturesArr.push(el.signature);\n    keyIndices.push(el.keyId.toString());\n  }\n  return query({\n    cadence: await getVerifySignaturesScript(ACCOUNT_PROOF, opts),\n    args: (arg, t) => [arg(withPrefix(address), t.Address), arg(message, t.String), arg(keyIndices, t.Array(t.Int)), arg(signaturesArr, t.Array(t.String))]\n  });\n}\n\n/**\n * @description\n * Verify a valid signature/s for an account on Flow.\n *\n * @param {string} message - A message string in hexadecimal format\n * @param {Array} compSigs - An array of Composite Signatures\n * @param {string} compSigs[].addr - The account address\n * @param {number} compSigs[].keyId - The account keyId\n * @param {string} compSigs[].signature - The signature to verify\n * @param {object} [opts={}] - Options object\n * @param {string} opts.fclCryptoContract - An optional override of Flow account address where the FCLCrypto contract is deployed\n * @returns {boolean} - Returns true if the signature is valid, false otherwise\n *\n * @example\n *\n *  const isValid = await fcl.AppUtils.verifyUserSignatures(\n *    Buffer.from('FOO').toString(\"hex\"),\n *    [{f_type: \"CompositeSignature\", f_vsn: \"1.0.0\", addr: \"0x123\", keyId: 0, signature: \"abc123\"}],\n *    {fclCryptoContract}\n *  )\n */\nasync function verifyUserSignatures$1(message, compSigs) {\n  let opts = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n  const address = withPrefix(compSigs[0].addr);\n  validateArgs({\n    message,\n    address,\n    compSigs\n  });\n  let signaturesArr = [];\n  let keyIndices = [];\n  for (const el of compSigs) {\n    signaturesArr.push(el.signature);\n    keyIndices.push(el.keyId.toString());\n  }\n  return query({\n    cadence: await getVerifySignaturesScript(USER_SIGNATURE, opts),\n    args: (arg, t) => [arg(address, t.Address), arg(message, t.String), arg(keyIndices, t.Array(t.Int)), arg(signaturesArr, t.Array(t.String))]\n  });\n}\nvar index$1 = /*#__PURE__*/Object.freeze({\n  __proto__: null,\n  verifyAccountProof: verifyAccountProof,\n  verifyUserSignatures: verifyUserSignatures$1\n});\n\n/**\n * Verify a valid signature/s for an account on Flow.\n *\n * @deprecated since version '1.0.0-alpha.0', use AppUtils.verifyUserSignatures instead\n *\n */\nconst verifyUserSignatures = log.deprecate({\n  pkg: \"FCL\",\n  subject: \"fcl.verifyUserSignatures()\",\n  message: \"Please use fcl.AppUtils.verifyUserSignatures()\",\n  callback: function verifyUserSignatures(message, compSigs) {\n    return verifyUserSignatures$1(message, compSigs);\n  }\n});\nconst serialize = async function () {\n  let args = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];\n  let opts = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n  const resolveFunction = await config$1.first([\"sdk.resolve\"], opts.resolve || resolve);\n  if (Array.isArray(args)) args = await pipe(interaction(), args);\n  return JSON.stringify(createSignableVoucher(await resolveFunction(args)), null, 2);\n};\nasync function configLens(regex) {\n  return Object.fromEntries(Object.entries(await config().where(regex)).map(_ref => {\n    let [key, value] = _ref;\n    return [key.replace(regex, \"\"), value];\n  }));\n}\n\n/**\n * @typedef {import(\"@onflow/typedefs\").Transaction} Transaction\n */\n\n/**\n * @typedef {import(\"@onflow/typedefs\").TransactionStatus} TransactionStatus\n */\n\nconst RATE$1 = 2500;\nconst POLL = \"POLL\";\nconst fetchTxStatus = async transactionId => {\n  return send([getTransactionStatus(transactionId)]).then(decode);\n};\nconst isExpired = tx => tx.status === 5;\nconst isSealed = tx => tx.status >= 4;\nconst isExecuted = tx => tx.status >= 3;\nconst isFinalized = tx => tx.status >= 2;\nconst isPending = tx => tx.status >= 1;\nconst isUnknown = tx => tx.status >= 0;\nconst isDiff = (cur, next) => {\n  return JSON.stringify(cur) !== JSON.stringify(next);\n};\nconst HANDLERS$3 = {\n  [INIT]: async ctx => {\n    ctx.sendSelf(POLL);\n  },\n  [SUBSCRIBE]: (ctx, letter) => {\n    ctx.subscribe(letter.from);\n    ctx.send(letter.from, UPDATED$2, ctx.all());\n  },\n  [UNSUBSCRIBE]: (ctx, letter) => {\n    ctx.unsubscribe(letter.from);\n  },\n  [SNAPSHOT$1]: async (ctx, letter) => {\n    letter.reply(ctx.all());\n  },\n  [POLL]: async ctx => {\n    let tx;\n    try {\n      tx = await fetchTxStatus(ctx.self());\n    } catch (e) {\n      return ctx.fatalError(e);\n    }\n    if (!isSealed(tx)) setTimeout(() => ctx.sendSelf(POLL), RATE$1);\n    if (isDiff(ctx.all(), tx)) ctx.broadcast(UPDATED$2, tx);\n    ctx.merge(tx);\n  }\n};\nconst scoped = transactionId => {\n  if (typeof transactionId === \"object\") transactionId = transactionId.transactionId;\n  if (transactionId == null) throw new Error(\"transactionId required\");\n  return transactionId;\n};\nconst spawnTransaction = transactionId => {\n  return spawn(HANDLERS$3, scoped(transactionId));\n};\n\n/**\n * @callback SubscriptionCallback\n * @param {TransactionStatus} txStatus\n * @returns {void}\n */\n\n/**\n * Provides methods for interacting with a transaction\n * \n * @param {string} transactionId - The transaction ID\n * @returns {{\n *    snapshot: function(): Promise<TransactionStatus>,\n *    subscribe: function(SubscriptionCallback): function(): void,\n *    onceFinalized: function(): Promise<TransactionStatus>,\n *    onceExecuted: function(): Promise<TransactionStatus>,\n *    onceSealed: function(): Promise<TransactionStatus>\n * }}\n */\nfunction transaction(transactionId) {\n  function snapshot() {\n    return snapshoter(transactionId, spawnTransaction);\n  }\n  function subscribe(callback) {\n    return subscriber(scoped(transactionId), spawnTransaction, callback);\n  }\n  function once(predicate) {\n    return function innerOnce() {\n      let opts = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n      const suppress = opts.suppress || false;\n      return new Promise((resolve, reject) => {\n        const unsub = subscribe((txStatus, error) => {\n          if ((error || txStatus.statusCode) && !suppress) {\n            reject(error || txStatus.errorMessage);\n            unsub();\n          } else if (predicate(txStatus)) {\n            resolve(txStatus);\n            unsub();\n          }\n        });\n      });\n    };\n  }\n  return {\n    snapshot,\n    subscribe,\n    onceFinalized: once(isFinalized),\n    onceExecuted: once(isExecuted),\n    onceSealed: once(isSealed)\n  };\n}\ntransaction.isUnknown = isUnknown;\ntransaction.isPending = isPending;\ntransaction.isFinalized = isFinalized;\ntransaction.isExecuted = isExecuted;\ntransaction.isSealed = isSealed;\ntransaction.isExpired = isExpired;\nconst RATE = 10000;\nconst UPDATED$1 = \"UPDATED\";\nconst TICK = \"TICK\";\nconst HIGH_WATER_MARK = \"hwm\";\nconst scheduleTick = async ctx => {\n  return setTimeout(() => ctx.sendSelf(TICK), await config$1().get(\"fcl.eventPollRate\", RATE));\n};\nconst HANDLERS$2 = {\n  [TICK]: async ctx => {\n    if (!ctx.hasSubs()) return;\n    let hwm = ctx.get(HIGH_WATER_MARK);\n    if (hwm == null) {\n      ctx.put(HIGH_WATER_MARK, await block());\n      ctx.put(TICK, await scheduleTick(ctx));\n    } else {\n      let next = await block();\n      ctx.put(HIGH_WATER_MARK, next);\n      if (hwm.height < next.height) {\n        const data = await send([getEventsAtBlockHeightRange(ctx.self(), hwm.height + 1, next.height)]).then(decode);\n        for (let d of data) ctx.broadcast(UPDATED$1, d.data);\n      }\n      ctx.put(TICK, await scheduleTick(ctx));\n    }\n  },\n  [SUBSCRIBE]: async (ctx, letter) => {\n    if (!ctx.hasSubs()) {\n      ctx.put(TICK, await scheduleTick(ctx));\n    }\n    ctx.subscribe(letter.from);\n  },\n  [UNSUBSCRIBE]: (ctx, letter) => {\n    ctx.unsubscribe(letter.from);\n    if (!ctx.hasSubs()) {\n      clearTimeout(ctx.get(TICK));\n      ctx.delete(TICK);\n      ctx.delete(HIGH_WATER_MARK);\n    }\n  }\n};\nconst spawnEvents = key => spawn(HANDLERS$2, key);\n\n/**\n * @typedef {import(\"@onflow/typedefs\").Event} Event\n */\n\n/**\n * @typedef {object} SubscribeObject\n * @property {Function} subscribe - The subscribe function.\n */\n\n/**\n * @callback SubscriptionCallback\n * @returns {Event}\n */\n\n/**\n * @description - Subscribe to events\n * @param {string} key - A valid event name\n * @returns {SubscribeObject}\n * \n * @example\n * import * as fcl from \"@onflow/fcl\"\n * fcl.events(eventName).subscribe((event) => console.log(event))\n */\nfunction events(key) {\n  return {\n    /**\n     * @description - Subscribe to events\n     * @param {Function} callback - The callback function\n     * @returns {SubscriptionCallback}\n     */\n    subscribe: callback => subscriber(key, spawnEvents, callback)\n  };\n}\nconst stub = () => {\n  throw new Error(\"Platform specific Core Strategies are not initialized\");\n};\nconst stubCoreStrategies = {\n  [CORE_STRATEGIES[\"EXT/RPC\"]]: stub,\n  [CORE_STRATEGIES[\"HTTP/POST\"]]: stub,\n  [CORE_STRATEGIES[\"IFRAME/RPC\"]]: stub,\n  [CORE_STRATEGIES[\"POP/RPC\"]]: stub,\n  [CORE_STRATEGIES[\"TAB/RPC\"]]: stub,\n  [CORE_STRATEGIES[\"EXT/RPC\"]]: stub\n};\nconst supportedPlugins = [\"ServicePlugin\"];\nconst supportedServicePlugins = [\"discovery-service\"];\nconst validateDiscoveryPlugin = servicePlugin => {\n  const {\n    services,\n    serviceStrategy\n  } = servicePlugin;\n  invariant(Array.isArray(services) && services.length, \"Array of Discovery Services is required\");\n  for (const ds of services) {\n    invariant(isRequired(ds.f_type) && ds.f_type === \"Service\", \"Service is required\");\n    invariant(isRequired(ds.type) && ds.type === \"authn\", \"Service must be type authn. Received \".concat(ds.type));\n    invariant(ds.method in CORE_STRATEGIES || serviceStrategy.method === ds.method, \"Service method \".concat(ds.method, \" is not supported\"));\n  }\n  invariant(isRequired(serviceStrategy), \"Service strategy is required\");\n  invariant(isRequired(serviceStrategy.method) && isString(serviceStrategy.method), \"Service strategy method is required\");\n  invariant(isRequired(serviceStrategy.exec) && isFunc(serviceStrategy.exec), \"Service strategy exec function is required\");\n  return {\n    discoveryServices: services,\n    serviceStrategy\n  };\n};\nconst ServiceRegistry = _ref => {\n  let {\n    coreStrategies\n  } = _ref;\n  let services = new Set();\n  let strategies = new Map(Object.entries(coreStrategies));\n  const add = servicePlugin => {\n    invariant(supportedServicePlugins.includes(servicePlugin.type), \"Service Plugin type \".concat(servicePlugin.type, \" is not supported\"));\n    if (servicePlugin.type === \"discovery-service\") {\n      const {\n        discoveryServices,\n        serviceStrategy\n      } = validateDiscoveryPlugin(servicePlugin);\n      setServices(discoveryServices);\n      if (!strategies.has(serviceStrategy.method)) {\n        strategies.set(serviceStrategy.method, serviceStrategy.exec);\n      } else {\n        log({\n          title: \"Add Service Plugin\",\n          message: \"Service strategy for \".concat(serviceStrategy.method, \" already exists\"),\n          level: LEVELS.warn\n        });\n      }\n    }\n  };\n  const setServices = discoveryServices => services = new Set([...discoveryServices]);\n  const getServices = () => [...services];\n  const getStrategy = method => strategies.get(method);\n  const getStrategies = () => [...strategies.keys()];\n  return Object.freeze({\n    add,\n    getServices,\n    getStrategy,\n    getStrategies\n  });\n};\nconst validatePlugins = plugins => {\n  let pluginsArray;\n  invariant(plugins, \"No plugins supplied\");\n  if (!Array.isArray(plugins)) {\n    pluginsArray = [plugins];\n  } else {\n    pluginsArray = [...plugins];\n  }\n  for (const p of pluginsArray) {\n    invariant(isRequired(p.name), \"Plugin name is required\");\n    invariant(isRequired(p.f_type), \"Plugin f_type is required\");\n    invariant(supportedPlugins.includes(p.f_type), \"Plugin type \".concat(p.f_type, \" is not supported\"));\n  }\n  return pluginsArray;\n};\nconst PluginRegistry = () => {\n  const pluginsMap = new Map();\n  const getPlugins = () => pluginsMap;\n  const add = plugins => {\n    const pluginsArray = validatePlugins(plugins);\n    for (const p of pluginsArray) {\n      pluginsMap.set(p.name, p);\n      if (p.f_type === \"ServicePlugin\") {\n        serviceRegistry.add(p);\n      }\n    }\n  };\n  return Object.freeze({\n    add,\n    getPlugins\n  });\n};\nlet serviceRegistry;\nconst getIsServiceRegistryInitialized = () => typeof serviceRegistry !== 'undefined';\nconst initServiceRegistry = _ref2 => {\n  let {\n    coreStrategies\n  } = _ref2;\n  if (getIsServiceRegistryInitialized()) {\n    return serviceRegistry;\n  }\n  const _serviceRegistry = ServiceRegistry({\n    coreStrategies\n  });\n  serviceRegistry = _serviceRegistry;\n  return _serviceRegistry;\n};\nconst getServiceRegistry = () => {\n  if (!getIsServiceRegistryInitialized()) {\n    console.warn(\"Registry is not initalized, it will be initialized with stub core strategies\");\n    return initServiceRegistry({\n      coreStrategies: stubCoreStrategies\n    });\n  }\n  return serviceRegistry;\n};\nconst pluginRegistry = PluginRegistry();\nconst makeDiscoveryServices = async () => {\n  var _window;\n  const extensionServices = ((_window = window) === null || _window === void 0 ? void 0 : _window.fcl_extensions) || [];\n  return [...extensionServices, ...getServiceRegistry().getServices()];\n};\nasync function getDiscoveryService(service) {\n  var _service$endpoint;\n  const discoveryAuthnInclude = await config.get(\"discovery.authn.include\", []);\n  const discoveryFeaturesSuggested = await config.get(\"discovery.features.suggested\", []);\n  const discoveryWalletMethod = await config.first([\"discovery.wallet.method\", \"discovery.wallet.method.default\"]);\n  const method = service !== null && service !== void 0 && service.method ? service.method : discoveryWalletMethod;\n  const endpoint = (_service$endpoint = service === null || service === void 0 ? void 0 : service.endpoint) !== null && _service$endpoint !== void 0 ? _service$endpoint : await config.first([\"discovery.wallet\", \"challenge.handshake\"]);\n  invariant(endpoint, \"\\n    If no service is passed to \\\"authenticate,\\\" then \\\"discovery.wallet\\\" must be defined in fcl config.\\n    See: \\\"https://docs.onflow.org/fcl/reference/api/#setting-configuration-values\\\"\\n    \");\n  return {\n    ...service,\n    type: \"authn\",\n    endpoint,\n    method,\n    discoveryAuthnInclude,\n    discoveryFeaturesSuggested\n  };\n}\nasync function getServices(_ref) {\n  var _window2;\n  let {\n    types\n  } = _ref;\n  const endpoint = await config.get(\"discovery.authn.endpoint\");\n  invariant(Boolean(endpoint), \"\\\"discovery.authn.endpoint\\\" in config must be defined.\");\n  const include = await config.get(\"discovery.authn.include\", []);\n  const url = new URL(endpoint);\n  return fetch(url, {\n    method: \"POST\",\n    headers: {\n      \"Content-Type\": \"application/json\"\n    },\n    body: JSON.stringify({\n      type: types,\n      fclVersion: VERSION,\n      include,\n      features: {\n        suggested: await config.get(\"discovery.features.suggested\", [])\n      },\n      clientServices: await makeDiscoveryServices(),\n      supportedStrategies: getServiceRegistry().getStrategies(),\n      userAgent: (_window2 = window) === null || _window2 === void 0 || (_window2 = _window2.navigator) === null || _window2 === void 0 ? void 0 : _window2.userAgent,\n      network: await getChainId()\n    })\n  }).then(d => d.json());\n}\nconst SERVICE_ACTOR_KEYS = {\n  AUTHN: \"authn\",\n  RESULTS: \"results\",\n  SNAPSHOT: \"SNAPSHOT\",\n  UPDATED: \"UPDATED\",\n  UPDATE_RESULTS: \"UPDATE_RESULTS\"\n};\nconst warn = (fact, msg) => {\n  if (fact) {\n    console.warn(\"\\n      %cFCL Warning\\n      ============================\\n      \".concat(msg, \"\\n      For more info, please see the docs: https://docs.onflow.org/fcl/\\n      ============================\\n      \"), \"font-weight:bold;font-family:monospace;\");\n  }\n};\nconst fetchServicesFromDiscovery = async () => {\n  try {\n    const services = await getServices({\n      types: [SERVICE_ACTOR_KEYS.AUTHN]\n    });\n    send$1(SERVICE_ACTOR_KEYS.AUTHN, SERVICE_ACTOR_KEYS.UPDATE_RESULTS, {\n      results: services\n    });\n  } catch (error) {\n    log({\n      title: \"\".concat(error.name, \" Error fetching Discovery API services.\"),\n      message: error.message,\n      level: LEVELS.error\n    });\n  }\n};\nconst HANDLERS$1 = {\n  [INIT]: async ctx => {\n    warn(typeof window === \"undefined\", '\"fcl.discovery\" is only available in the browser.');\n    // If you call this before the window is loaded extensions will not be set yet\n    if (document.readyState === 'complete') {\n      fetchServicesFromDiscovery();\n    } else {\n      window.onload = async () => {\n        fetchServicesFromDiscovery();\n      };\n    }\n  },\n  [SERVICE_ACTOR_KEYS.UPDATE_RESULTS]: (ctx, _letter, data) => {\n    ctx.merge(data);\n    ctx.broadcast(SERVICE_ACTOR_KEYS.UPDATED, {\n      ...ctx.all()\n    });\n  },\n  [SUBSCRIBE]: (ctx, letter) => {\n    ctx.subscribe(letter.from);\n    ctx.send(letter.from, SERVICE_ACTOR_KEYS.UPDATED, {\n      ...ctx.all()\n    });\n  },\n  [UNSUBSCRIBE]: (ctx, letter) => ctx.unsubscribe(letter.from),\n  [SERVICE_ACTOR_KEYS.SNAPSHOT]: async (ctx, letter) => letter.reply({\n    ...ctx.all()\n  })\n};\nconst spawnProviders = () => spawn(HANDLERS$1, SERVICE_ACTOR_KEYS.AUTHN);\n\n/**\n * @typedef {import(\"@onflow/typedefs\").Service} Service\n */\n\n/**\n * @callback SubscriptionCallback\n * @returns {Service[]}\n */\n\n/**\n * @description\n * Discovery methods for interacting with Authn.\n * \n * @typedef {object} Authn\n * @property {Function} subscribe - Subscribe to Discovery authn services\n * @property {Function} snapshot - Get the current Discovery authn services spanshot\n * @property {Function} update - Trigger an update of authn services\n */\nconst authn = {\n  /**\n   * @description - Subscribe to Discovery authn services\n   * @param {Function} cb\n   * @returns {SubscriptionCallback}\n   */\n  subscribe: cb => subscriber(SERVICE_ACTOR_KEYS.AUTHN, spawnProviders, cb),\n  /**\n   * @description - Get the current Discovery authn services spanshot\n   * @returns {Service[]}\n   */\n  snapshot: () => snapshoter(SERVICE_ACTOR_KEYS.AUTHN, spawnProviders),\n  /**\n   * @description - Trigger an update of authn services\n   * @returns {void}\n   */\n  update: () => fetchServicesFromDiscovery()\n};\nconst discovery = {\n  authn\n};\nvar sha3 = {};\nvar sponge = {};\nvar permute = {};\nvar chi = {};\nvar copy = function copy(I, i) {\n  return function (O, o) {\n    var oi = o * 2;\n    var ii = i * 2;\n    O[oi] = I[ii];\n    O[oi + 1] = I[ii + 1];\n  };\n};\nvar copy_1 = copy;\n(function (exports) {\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n  exports[\"default\"] = void 0;\n  var _copy = _interopRequireDefault(copy_1);\n  function _interopRequireDefault(obj) {\n    return obj && obj.__esModule ? obj : {\n      \"default\": obj\n    };\n  }\n  var chi = function chi(_ref) {\n    var A = _ref.A,\n      C = _ref.C;\n    for (var y = 0; y < 25; y += 5) {\n      for (var x = 0; x < 5; x++) {\n        (0, _copy[\"default\"])(A, y + x)(C, x);\n      }\n      for (var _x = 0; _x < 5; _x++) {\n        var xy = (y + _x) * 2;\n        var x1 = (_x + 1) % 5 * 2;\n        var x2 = (_x + 2) % 5 * 2;\n        A[xy] ^= ~C[x1] & C[x2];\n        A[xy + 1] ^= ~C[x1 + 1] & C[x2 + 1];\n      }\n    }\n  };\n  var _default = chi;\n  exports[\"default\"] = _default;\n})(chi);\nvar iota = {};\nvar roundConstants = {};\n(function (exports) {\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n  exports[\"default\"] = void 0;\n  var ROUND_CONSTANTS = new Uint32Array([0, 1, 0, 32898, 2147483648, 32906, 2147483648, 2147516416, 0, 32907, 0, 2147483649, 2147483648, 2147516545, 2147483648, 32777, 0, 138, 0, 136, 0, 2147516425, 0, 2147483658, 0, 2147516555, 2147483648, 139, 2147483648, 32905, 2147483648, 32771, 2147483648, 32770, 2147483648, 128, 0, 32778, 2147483648, 2147483658, 2147483648, 2147516545, 2147483648, 32896, 0, 2147483649, 2147483648, 2147516424]);\n  var _default = ROUND_CONSTANTS;\n  exports[\"default\"] = _default;\n})(roundConstants);\n(function (exports) {\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n  exports[\"default\"] = void 0;\n  var _roundConstants = _interopRequireDefault(roundConstants);\n  function _interopRequireDefault(obj) {\n    return obj && obj.__esModule ? obj : {\n      \"default\": obj\n    };\n  }\n  var iota = function iota(_ref) {\n    var A = _ref.A,\n      roundIndex = _ref.roundIndex;\n    var i = roundIndex * 2;\n    A[0] ^= _roundConstants[\"default\"][i];\n    A[1] ^= _roundConstants[\"default\"][i + 1];\n  };\n  var _default = iota;\n  exports[\"default\"] = _default;\n})(iota);\nvar rhoPi = {};\nvar piShuffles = {};\n(function (exports) {\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n  exports[\"default\"] = void 0;\n  var PI_SHUFFLES = [10, 7, 11, 17, 18, 3, 5, 16, 8, 21, 24, 4, 15, 23, 19, 13, 12, 2, 20, 14, 22, 9, 6, 1];\n  var _default = PI_SHUFFLES;\n  exports[\"default\"] = _default;\n})(piShuffles);\nvar rhoOffsets = {};\n(function (exports) {\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n  exports[\"default\"] = void 0;\n  var RHO_OFFSETS = [1, 3, 6, 10, 15, 21, 28, 36, 45, 55, 2, 14, 27, 41, 56, 8, 25, 43, 62, 18, 39, 61, 20, 44];\n  var _default = RHO_OFFSETS;\n  exports[\"default\"] = _default;\n})(rhoOffsets);\n(function (exports) {\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n  exports[\"default\"] = void 0;\n  var _piShuffles = _interopRequireDefault(piShuffles);\n  var _rhoOffsets = _interopRequireDefault(rhoOffsets);\n  var _copy = _interopRequireDefault(copy_1);\n  function _interopRequireDefault(obj) {\n    return obj && obj.__esModule ? obj : {\n      \"default\": obj\n    };\n  }\n  var rhoPi = function rhoPi(_ref) {\n    var A = _ref.A,\n      C = _ref.C,\n      W = _ref.W;\n    (0, _copy[\"default\"])(A, 1)(W, 0);\n    var H = 0;\n    var L = 0;\n    var Wi = 0;\n    var ri = 32;\n    for (var i = 0; i < 24; i++) {\n      var j = _piShuffles[\"default\"][i];\n      var r = _rhoOffsets[\"default\"][i];\n      (0, _copy[\"default\"])(A, j)(C, 0);\n      H = W[0];\n      L = W[1];\n      ri = 32 - r;\n      Wi = r < 32 ? 0 : 1;\n      W[Wi] = H << r | L >>> ri;\n      W[(Wi + 1) % 2] = L << r | H >>> ri;\n      (0, _copy[\"default\"])(W, 0)(A, j);\n      (0, _copy[\"default\"])(C, 0)(W, 0);\n    }\n  };\n  var _default = rhoPi;\n  exports[\"default\"] = _default;\n})(rhoPi);\nvar theta = {};\n(function (exports) {\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n  exports[\"default\"] = void 0;\n  var _copy = _interopRequireDefault(copy_1);\n  function _interopRequireDefault(obj) {\n    return obj && obj.__esModule ? obj : {\n      \"default\": obj\n    };\n  }\n  var theta = function theta(_ref) {\n    var A = _ref.A,\n      C = _ref.C,\n      D = _ref.D,\n      W = _ref.W;\n    var H = 0;\n    var L = 0;\n    for (var x = 0; x < 5; x++) {\n      var x20 = x * 2;\n      var x21 = (x + 5) * 2;\n      var x22 = (x + 10) * 2;\n      var x23 = (x + 15) * 2;\n      var x24 = (x + 20) * 2;\n      C[x20] = A[x20] ^ A[x21] ^ A[x22] ^ A[x23] ^ A[x24];\n      C[x20 + 1] = A[x20 + 1] ^ A[x21 + 1] ^ A[x22 + 1] ^ A[x23 + 1] ^ A[x24 + 1];\n    }\n    for (var _x = 0; _x < 5; _x++) {\n      (0, _copy[\"default\"])(C, (_x + 1) % 5)(W, 0);\n      H = W[0];\n      L = W[1];\n      W[0] = H << 1 | L >>> 31;\n      W[1] = L << 1 | H >>> 31;\n      D[_x * 2] = C[(_x + 4) % 5 * 2] ^ W[0];\n      D[_x * 2 + 1] = C[(_x + 4) % 5 * 2 + 1] ^ W[1];\n      for (var y = 0; y < 25; y += 5) {\n        A[(y + _x) * 2] ^= D[_x * 2];\n        A[(y + _x) * 2 + 1] ^= D[_x * 2 + 1];\n      }\n    }\n  };\n  var _default = theta;\n  exports[\"default\"] = _default;\n})(theta);\n(function (exports) {\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n  exports[\"default\"] = void 0;\n  var _chi = _interopRequireDefault(chi);\n  var _iota = _interopRequireDefault(iota);\n  var _rhoPi = _interopRequireDefault(rhoPi);\n  var _theta = _interopRequireDefault(theta);\n  function _interopRequireDefault(obj) {\n    return obj && obj.__esModule ? obj : {\n      \"default\": obj\n    };\n  }\n  var permute = function permute() {\n    var C = new Uint32Array(10);\n    var D = new Uint32Array(10);\n    var W = new Uint32Array(2);\n    return function (A) {\n      for (var roundIndex = 0; roundIndex < 24; roundIndex++) {\n        (0, _theta[\"default\"])({\n          A: A,\n          C: C,\n          D: D,\n          W: W\n        });\n        (0, _rhoPi[\"default\"])({\n          A: A,\n          C: C,\n          W: W\n        });\n        (0, _chi[\"default\"])({\n          A: A,\n          C: C\n        });\n        (0, _iota[\"default\"])({\n          A: A,\n          roundIndex: roundIndex\n        });\n      }\n      C.fill(0);\n      D.fill(0);\n      W.fill(0);\n    };\n  };\n  var _default = permute;\n  exports[\"default\"] = _default;\n})(permute);\n(function (exports) {\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n  exports[\"default\"] = void 0;\n  var _buffer = require$$0;\n  var _permute = _interopRequireDefault(permute);\n  function _interopRequireDefault(obj) {\n    return obj && obj.__esModule ? obj : {\n      \"default\": obj\n    };\n  }\n  var xorWords = function xorWords(I, O) {\n    for (var i = 0; i < I.length; i += 8) {\n      var o = i / 4;\n      O[o] ^= I[i + 7] << 24 | I[i + 6] << 16 | I[i + 5] << 8 | I[i + 4];\n      O[o + 1] ^= I[i + 3] << 24 | I[i + 2] << 16 | I[i + 1] << 8 | I[i];\n    }\n    return O;\n  };\n  var readWords = function readWords(I, O) {\n    for (var o = 0; o < O.length; o += 8) {\n      var i = o / 4;\n      O[o] = I[i + 1];\n      O[o + 1] = I[i + 1] >>> 8;\n      O[o + 2] = I[i + 1] >>> 16;\n      O[o + 3] = I[i + 1] >>> 24;\n      O[o + 4] = I[i];\n      O[o + 5] = I[i] >>> 8;\n      O[o + 6] = I[i] >>> 16;\n      O[o + 7] = I[i] >>> 24;\n    }\n    return O;\n  };\n  var Sponge = function Sponge(_ref) {\n    var _this = this;\n    var capacity = _ref.capacity,\n      padding = _ref.padding;\n    var keccak = (0, _permute[\"default\"])();\n    var stateSize = 200;\n    var blockSize = capacity / 8;\n    var queueSize = stateSize - capacity / 4;\n    var queueOffset = 0;\n    var state = new Uint32Array(stateSize / 4);\n    var queue = _buffer.Buffer.allocUnsafe(queueSize);\n    this.absorb = function (buffer) {\n      for (var i = 0; i < buffer.length; i++) {\n        queue[queueOffset] = buffer[i];\n        queueOffset += 1;\n        if (queueOffset >= queueSize) {\n          xorWords(queue, state);\n          keccak(state);\n          queueOffset = 0;\n        }\n      }\n      return _this;\n    };\n    this.squeeze = function () {\n      var options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n      var output = {\n        buffer: options.buffer || _buffer.Buffer.allocUnsafe(blockSize),\n        padding: options.padding || padding,\n        queue: _buffer.Buffer.allocUnsafe(queue.length),\n        state: new Uint32Array(state.length)\n      };\n      queue.copy(output.queue);\n      for (var i = 0; i < state.length; i++) {\n        output.state[i] = state[i];\n      }\n      output.queue.fill(0, queueOffset);\n      output.queue[queueOffset] |= output.padding;\n      output.queue[queueSize - 1] |= 128;\n      xorWords(output.queue, output.state);\n      for (var offset = 0; offset < output.buffer.length; offset += queueSize) {\n        keccak(output.state);\n        readWords(output.state, output.buffer.slice(offset, offset + queueSize));\n      }\n      return output.buffer;\n    };\n    this.reset = function () {\n      queue.fill(0);\n      state.fill(0);\n      queueOffset = 0;\n      return _this;\n    };\n    return this;\n  };\n  var _default = Sponge;\n  exports[\"default\"] = _default;\n})(sponge);\n(function (exports) {\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n  exports[\"default\"] = exports.SHAKE = exports.SHA3Hash = exports.SHA3 = exports.Keccak = void 0;\n  var _buffer = require$$0;\n  var _sponge = _interopRequireDefault(sponge);\n  function _interopRequireDefault(obj) {\n    return obj && obj.__esModule ? obj : {\n      \"default\": obj\n    };\n  }\n  var createHash = function createHash(_ref) {\n    var allowedSizes = _ref.allowedSizes,\n      defaultSize = _ref.defaultSize,\n      padding = _ref.padding;\n    return function Hash() {\n      var _this = this;\n      var size = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : defaultSize;\n      if (!this || this.constructor !== Hash) {\n        return new Hash(size);\n      }\n      if (allowedSizes && !allowedSizes.includes(size)) {\n        throw new Error(\"Unsupported hash length\");\n      }\n      var sponge = new _sponge[\"default\"]({\n        capacity: size\n      });\n      this.update = function (input) {\n        var encoding = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : \"utf8\";\n        if (_buffer.Buffer.isBuffer(input)) {\n          sponge.absorb(input);\n          return _this;\n        }\n        if (typeof input === \"string\") {\n          return _this.update(_buffer.Buffer.from(input, encoding));\n        }\n        throw new TypeError(\"Not a string or buffer\");\n      };\n      this.digest = function () {\n        var formatOrOptions = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : \"binary\";\n        var options = typeof formatOrOptions === \"string\" ? {\n          format: formatOrOptions\n        } : formatOrOptions;\n        var buffer = sponge.squeeze({\n          buffer: options.buffer,\n          padding: options.padding || padding\n        });\n        if (options.format && options.format !== \"binary\") {\n          return buffer.toString(options.format);\n        }\n        return buffer;\n      };\n      this.reset = function () {\n        sponge.reset();\n        return _this;\n      };\n      return this;\n    };\n  };\n  var Keccak = createHash({\n    allowedSizes: [224, 256, 384, 512],\n    defaultSize: 512,\n    padding: 1\n  });\n  exports.Keccak = Keccak;\n  var SHA3 = createHash({\n    allowedSizes: [224, 256, 384, 512],\n    defaultSize: 512,\n    padding: 6\n  });\n  exports.SHA3 = SHA3;\n  var SHAKE = createHash({\n    allowedSizes: [128, 256],\n    defaultSize: 256,\n    padding: 31\n  });\n  exports.SHAKE = SHAKE;\n  var SHA3Hash = Keccak;\n  exports.SHA3Hash = SHA3Hash;\n  SHA3.SHA3Hash = SHA3Hash;\n  var _default = SHA3;\n  exports[\"default\"] = _default;\n})(sha3);\nasync function genHash(utf8String) {\n  const sha = new sha3.SHA3(256);\n  sha.update(Buffer.from(utf8String, \"utf8\"));\n  return sha.digest(\"hex\");\n}\n\n/**\n * @description Generates Interaction Template ID for a given Interaction Template\n *  \n * @param {object} params\n * @param {object} params.template - Interaction Template\n * @returns {Promise<string>} - Interaction Template ID\n */\nasync function generateTemplateId(_ref) {\n  let {\n    template\n  } = _ref;\n  invariant$1(template != undefined, \"generateTemplateId({ template }) -- template must be defined\");\n  invariant$1(typeof template === \"object\", \"generateTemplateId({ template }) -- template must be an object\");\n  invariant$1(typeof template.f_type === \"InteractionTemplate\", \"generateTemplateId({ template }) -- template object must be an InteractionTemplate\");\n  template = normalizeInteractionTemplate(template);\n  switch (template.f_version) {\n    case \"1.0.0\":\n      const templateData = template.data;\n      const messages = await Promise.all(Object.keys(templateData.messages).map(async messageKey => {\n        var _templateData$message;\n        return [await genHash(messageKey), await Promise.all(Object.keys((_templateData$message = templateData.messages) === null || _templateData$message === void 0 || (_templateData$message = _templateData$message[messageKey]) === null || _templateData$message === void 0 ? void 0 : _templateData$message.i18n).map(async i18nkeylanguage => {\n          var _templateData$message2;\n          return [await genHash(i18nkeylanguage), await genHash((_templateData$message2 = templateData.messages) === null || _templateData$message2 === void 0 || (_templateData$message2 = _templateData$message2[messageKey]) === null || _templateData$message2 === void 0 || (_templateData$message2 = _templateData$message2.i18n) === null || _templateData$message2 === void 0 ? void 0 : _templateData$message2[i18nkeylanguage])];\n        }))];\n      }));\n      const dependencies = await Promise.all(Object.keys(templateData === null || templateData === void 0 ? void 0 : templateData.dependencies).map(async dependencyAddressPlaceholder => {\n        var _templateData$depende;\n        return [await genHash(dependencyAddressPlaceholder), await Promise.all(Object.keys(templateData === null || templateData === void 0 || (_templateData$depende = templateData.dependencies) === null || _templateData$depende === void 0 ? void 0 : _templateData$depende[dependencyAddressPlaceholder]).map(async dependencyContract => {\n          var _templateData$depende2;\n          return [await genHash(dependencyContract), await Promise.all(Object.keys(templateData === null || templateData === void 0 || (_templateData$depende2 = templateData.dependencies) === null || _templateData$depende2 === void 0 || (_templateData$depende2 = _templateData$depende2[dependencyAddressPlaceholder]) === null || _templateData$depende2 === void 0 ? void 0 : _templateData$depende2[dependencyContract]).map(async dependencyContractNetwork => {\n            var _templateData$depende3, _templateData$depende4, _templateData$depende5, _templateData$depende6, _templateData$depende7;\n            return [await genHash(dependencyContractNetwork), [await genHash(templateData === null || templateData === void 0 || (_templateData$depende3 = templateData.dependencies) === null || _templateData$depende3 === void 0 || (_templateData$depende3 = _templateData$depende3[dependencyAddressPlaceholder]) === null || _templateData$depende3 === void 0 || (_templateData$depende3 = _templateData$depende3[dependencyContract]) === null || _templateData$depende3 === void 0 ? void 0 : _templateData$depende3[dependencyContractNetwork].address), await genHash(templateData === null || templateData === void 0 || (_templateData$depende4 = templateData.dependencies) === null || _templateData$depende4 === void 0 || (_templateData$depende4 = _templateData$depende4[dependencyAddressPlaceholder]) === null || _templateData$depende4 === void 0 || (_templateData$depende4 = _templateData$depende4[dependencyContract]) === null || _templateData$depende4 === void 0 ? void 0 : _templateData$depende4[dependencyContractNetwork].contract), await genHash(templateData === null || templateData === void 0 || (_templateData$depende5 = templateData.dependencies) === null || _templateData$depende5 === void 0 || (_templateData$depende5 = _templateData$depende5[dependencyAddressPlaceholder]) === null || _templateData$depende5 === void 0 || (_templateData$depende5 = _templateData$depende5[dependencyContract]) === null || _templateData$depende5 === void 0 ? void 0 : _templateData$depende5[dependencyContractNetwork].fq_address), await genHash(templateData === null || templateData === void 0 || (_templateData$depende6 = templateData.dependencies) === null || _templateData$depende6 === void 0 || (_templateData$depende6 = _templateData$depende6[dependencyAddressPlaceholder]) === null || _templateData$depende6 === void 0 || (_templateData$depende6 = _templateData$depende6[dependencyContract]) === null || _templateData$depende6 === void 0 ? void 0 : _templateData$depende6[dependencyContractNetwork].pin), await genHash(String(templateData === null || templateData === void 0 || (_templateData$depende7 = templateData.dependencies) === null || _templateData$depende7 === void 0 || (_templateData$depende7 = _templateData$depende7[dependencyAddressPlaceholder]) === null || _templateData$depende7 === void 0 || (_templateData$depende7 = _templateData$depende7[dependencyContract]) === null || _templateData$depende7 === void 0 ? void 0 : _templateData$depende7[dependencyContractNetwork].pin_block_height))]];\n          }))];\n        }))];\n      }));\n      const _arguments = await Promise.all(Object.keys(templateData === null || templateData === void 0 ? void 0 : templateData[\"arguments\"]).map(async argumentLabel => {\n        var _templateData$argumen, _templateData$argumen2, _templateData$argumen3, _templateData$argumen4;\n        return [await genHash(argumentLabel), [await genHash(String(templateData === null || templateData === void 0 || (_templateData$argumen = templateData[\"arguments\"]) === null || _templateData$argumen === void 0 ? void 0 : _templateData$argumen[argumentLabel].index)), await genHash(templateData === null || templateData === void 0 || (_templateData$argumen2 = templateData[\"arguments\"]) === null || _templateData$argumen2 === void 0 ? void 0 : _templateData$argumen2[argumentLabel].type), await genHash((templateData === null || templateData === void 0 || (_templateData$argumen3 = templateData[\"arguments\"]) === null || _templateData$argumen3 === void 0 ? void 0 : _templateData$argumen3[argumentLabel].balance) || \"\"), await Promise.all(Object.keys(templateData === null || templateData === void 0 || (_templateData$argumen4 = templateData[\"arguments\"]) === null || _templateData$argumen4 === void 0 ? void 0 : _templateData$argumen4[argumentLabel].messages).map(async argumentMessageKey => {\n          var _templateData$argumen5;\n          return [await genHash(argumentMessageKey), await Promise.all(Object.keys(templateData === null || templateData === void 0 || (_templateData$argumen5 = templateData[\"arguments\"]) === null || _templateData$argumen5 === void 0 || (_templateData$argumen5 = _templateData$argumen5[argumentLabel].messages) === null || _templateData$argumen5 === void 0 ? void 0 : _templateData$argumen5[argumentMessageKey].i18n).map(async i18nkeylanguage => {\n            var _templateData$argumen6;\n            return [await genHash(i18nkeylanguage), await genHash(templateData === null || templateData === void 0 || (_templateData$argumen6 = templateData[\"arguments\"]) === null || _templateData$argumen6 === void 0 || (_templateData$argumen6 = _templateData$argumen6[argumentLabel].messages) === null || _templateData$argumen6 === void 0 || (_templateData$argumen6 = _templateData$argumen6[argumentMessageKey].i18n) === null || _templateData$argumen6 === void 0 ? void 0 : _templateData$argumen6[i18nkeylanguage])];\n          }))];\n        }))]];\n      }));\n      const encodedHex = encode([await genHash(\"InteractionTemplate\"), await genHash(\"1.0.0\"), await genHash(templateData === null || templateData === void 0 ? void 0 : templateData.type), await genHash(templateData === null || templateData === void 0 ? void 0 : templateData.interface), messages, await genHash(templateData === null || templateData === void 0 ? void 0 : templateData.cadence), dependencies, _arguments]).toString(\"hex\");\n      return genHash(encodedHex);\n    default:\n      throw new Error(\"generateTemplateId Error: Unsupported template version\");\n  }\n}\n\n/**\n * @description Returns whether a set of auditors have audited a given Interaction Template\n *\n * @param {object} params\n * @param {object} params.template - Interaction Template\n * @param {Array<string>} params.auditors - Array of auditors\n * @param {object} opts\n * @param {string} opts.flowInteractionAuditContract - Flow Interaction Template Audit contract address\n * @returns {Promise<object>} - Object of auditor addresses and audit status\n */\nasync function getInteractionTemplateAudits(_ref) {\n  let {\n    template,\n    auditors\n  } = _ref;\n  let opts = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n  invariant$1(template != undefined, \"getInteractionTemplateAudits({ template }) -- template must be defined\");\n  template = normalizeInteractionTemplate(template);\n  invariant$1(template.f_type === \"InteractionTemplate\", \"getInteractionTemplateAudits({ template }) -- template must be an InteractionTemplate\");\n\n  // Recompute ID to be sure it matches\n  let recomputedTemplateID = await generateTemplateId({\n    template\n  });\n  if (recomputedTemplateID !== template.id) {\n    log({\n      title: \"getInteractionTemplateAudits Debug Error\",\n      message: \"Could not recompute and match template ID\\n                computed: \".concat(recomputedTemplateID, \"\\n                template: \").concat(template.id, \"\\n            \"),\n      level: LEVELS.debug\n    });\n    throw new Error(\"getInteractionTemplateAudits Error: Could not recompute and match template ID\");\n  }\n  switch (template.f_version) {\n    case \"1.0.0\":\n      const _auditors = auditors || (await config$1().get(\"flow.auditors\"));\n      invariant$1(_auditors, \"getInteractionTemplateAudits Error: Required configuration for 'fcl.auditors' is not set\");\n      invariant$1(Array.isArray(_auditors), \"getInteractionTemplateAudits Error: Required configuration for 'fcl.auditors' is not an array\");\n      let FlowInteractionAuditContract = opts.flowInteractionAuditContract;\n      if (!FlowInteractionAuditContract) {\n        const fclNetwork = await getChainId(opts);\n        invariant$1(fclNetwork === \"mainnet\" || fclNetwork === \"testnet\", \"getInteractionTemplateAudits Error: Unable to determine address for FlowInteractionTemplateAudit contract. Set configuration for 'fcl.network' to 'mainnet' or 'testnet'\");\n        if (fclNetwork === \"mainnet\") {\n          FlowInteractionAuditContract = \"0xfd100e39d50a13e6\";\n        } else {\n          FlowInteractionAuditContract = \"0xf78bfc12d0a786dc\";\n        }\n      }\n      const audits = await query({\n        cadence: \"\\n        import FlowInteractionTemplateAudit from \".concat(FlowInteractionAuditContract, \"\\n        pub fun main(templateId: String, auditors: [Address]): {Address:Bool} {\\n          return FlowInteractionTemplateAudit.getHasTemplateBeenAuditedByAuditors(templateId: templateId, auditors: auditors)\\n        }\\n        \"),\n        args: (arg, t) => [arg(recomputedTemplateID, t.String), arg(_auditors, t.Array(t.Address))]\n      });\n      return audits;\n    default:\n      throw new Error(\"getInteractionTemplateAudits Error: Unsupported template version\");\n  }\n}\nfunction generateImport(_ref) {\n  let {\n    contractName,\n    address\n  } = _ref;\n  return {\n    contractName,\n    address,\n    contract: \"\"\n  };\n}\nfunction findImports(cadence) {\n  let imports = [];\n  let importsReg = /import ((\\w|,| )+)* from 0x\\w+/g;\n  let fileImports = cadence.match(importsReg) || [];\n  for (const fileImport of fileImports) {\n    const importLineReg = /import ((\\w+|, |)*) from (0x\\w+)/g;\n    const importLine = importLineReg.exec(fileImport);\n    const contractsReg = /((?:\\w+)+),?/g;\n    const contracts = importLine[1].match(contractsReg) || [];\n    for (const contract of contracts) {\n      imports.push(generateImport({\n        address: importLine[3],\n        contractName: contract.replace(/,/g, \"\")\n      }));\n    }\n  }\n  return imports;\n}\n\n/**\n * @description Produces a dependency pin for a contract at a given block height\n * @param {object} params\n * @param {string} params.address - The address of the account containing the contract\n * @param {string} params.contractName - The name of the contract\n * @param {number} params.blockHeight - The block height to produce the dependency pin for\n * @param {object} opts - Options to pass to the interaction\n * @returns {Promise<string>} - The dependency pin\n */\nasync function generateDependencyPin(_ref) {\n  let {\n    address,\n    contractName,\n    blockHeight\n  } = _ref;\n  let opts = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n  invariant$1(address != undefined, \"generateDependencyPin({ address }) -- address must be defined\");\n  invariant$1(contractName != undefined, \"generateDependencyPin({ contractName }) -- contractName must be defined\");\n  invariant$1(blockHeight != undefined, \"generateDependencyPin({ blockHeight }) -- blockHeight must be defined\");\n  invariant$1(typeof address === \"string\", \"generateDependencyPin({ address }) -- address must be a string\");\n  invariant$1(typeof contractName === \"string\", \"generateDependencyPin({ contractName }) -- contractName must be a string\");\n  invariant$1(typeof blockHeight === \"number\", \"generateDependencyPin({ blockHeight }) -- blockHeight must be a number\");\n  let horizon = [generateImport({\n    contractName,\n    address\n  })];\n  for (const horizonImport of horizon) {\n    var _account$contracts;\n    let account = await send([getAccount(await config$1().get(horizonImport.address, horizonImport.address)), atBlockHeight(blockHeight)], opts).then(decode);\n    horizonImport.contract = (_account$contracts = account.contracts) === null || _account$contracts === void 0 ? void 0 : _account$contracts[horizonImport.contractName];\n    if (!horizonImport.contract) {\n      console.error(\"Did not find expected contract\", horizonImport, account);\n      throw new Error(\"Did not find expected contract\");\n    }\n    let contractImports = findImports(horizonImport.contract);\n    horizon.push(...contractImports);\n  }\n  let contractHashes = horizon.map(iport => genHash(iport.contract));\n  let contractHashesJoined = contractHashes.join(\"\");\n  return genHash(contractHashesJoined);\n}\n\n/**\n * @description Produces a dependency pin for a contract at latest sealed block\n * @param {object} params\n * @param {string} params.address - The address of the account containing the contract\n * @param {string} params.contractName - The name of the contract\n * @param {object} opts - Options to pass to the interaction\n * @returns {Promise<string>} - The dependency pin\n */\nasync function generateDependencyPinAtLatestSealedBlock(_ref2) {\n  let {\n    address,\n    contractName\n  } = _ref2;\n  let opts = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n  let latestSealedBlock = await block({\n    sealed: true\n  }, opts);\n  let latestSealedBlockHeight = latestSealedBlock === null || latestSealedBlock === void 0 ? void 0 : latestSealedBlock.height;\n  return generateDependencyPin({\n    address,\n    contractName,\n    blockHeight: latestSealedBlockHeight\n  }, opts);\n}\nfunction normalizeInteractionTemplateInterface(templateInterface) {\n  if (templateInterface == null) return null;\n  switch (templateInterface[\"f_version\"]) {\n    case \"1.0.0\":\n      return templateInterface;\n    default:\n      throw new Error(\"normalizeInteractionTemplateInterface Error: Invalid InteractionTemplateInterface\");\n  }\n}\n\n/**\n * @description Generates Interaction Template Interface ID for a given Interaction Template Interface\n * \n * @param {object} params\n * @param {object} params.templateInterface - Interaction Template Interface\n * @returns {Promise<string>} - Interaction Template Interface ID\n */\nasync function generateTemplateInterfaceId(_ref) {\n  let {\n    templateInterface\n  } = _ref;\n  invariant$1(templateInterface != undefined, \"generateTemplateInterfaceId({ templateInterface }) -- templateInterface must be defined\");\n  invariant$1(typeof templateInterface === \"object\", \"generateTemplateInterfaceId({ templateInterface }) -- templateInterface must be an object\");\n  invariant$1(typeof templateInterface.f_type === \"InteractionTemplateInterface\", \"generateTemplateInterfaceId({ templateInterface }) -- templateInterface object must be an InteractionTemplate\");\n  templateInterface = normalizeInteractionTemplateInterface(templateInterface);\n  switch (templateInterface.f_version) {\n    case \"1.0.0\":\n      const interfaceData = templateInterface.data;\n      const encodedHex = encode([await genHash(\"InteractionTemplateInterface\"), await genHash(\"1.0.0\"), await genHash(interfaceData.flip), await Promise.all(Object.keys(interfaceData.arguments).map(async argumentLabel => [await genHash(argumentLabel), await genHash(String(interfaceData.arguments[argumentLabel].index)), await genHash(interfaceData.arguments[argumentLabel].type)]))]).toString(\"hex\");\n      return genHash(encodedHex);\n    default:\n      throw new Error(\"generateTemplateInterfaceId Error: Unsupported templateInterface version\");\n  }\n}\n\n/**\n * @description Checks if an Interaction Template's pins match those generated at a block height\n * \n * @param {object} params\n * @param {object} params.template - Interaction Template to check pins for\n * @param {number} params.blockHeight - Block height to check pins at\n * @param {string} params.network - Network to check pins on\n * @param {object} opts\n * @returns {Promise<boolean>} - Whether or not the pins match\n */\nasync function verifyDependencyPinsSame(_ref) {\n  let {\n    template,\n    blockHeight,\n    network\n  } = _ref;\n  let opts = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n  invariant$1(template != undefined, \"generateDependencyPin({ template }) -- template must be defined\");\n  invariant$1(typeof template === \"object\", \"generateDependencyPin({ template }) -- template must be an object\");\n  invariant$1(template.f_type === \"InteractionTemplate\", \"generateDependencyPin({ template }) -- template must be an InteractionTemplate\");\n  template = normalizeInteractionTemplate(template);\n  invariant$1(network != undefined, \"generateDependencyPin({ network }) network must be defined\");\n  invariant$1(blockHeight != undefined, \"generateDependencyPin({ blockHeight }) blockHeight must be defined\");\n  invariant$1(typeof blockHeight === \"number\", \"generateDependencyPin({ blockHeight }) blockHeight must be a number\");\n  switch (template.f_version) {\n    case \"1.0.0\":\n      let templateDependenciesPlaceholderKeys = Object.keys(template.data.dependencies);\n      for (let templateDependencyPlaceholderKey of templateDependenciesPlaceholderKeys) {\n        let templateDependencyPlaceholder = template.data.dependencies[templateDependencyPlaceholderKey];\n        let templateDependencyPlaceholderContractNames = Object.keys(templateDependencyPlaceholder);\n        for (let templateDependencyPlaceholderContractName of templateDependencyPlaceholderContractNames) {\n          let templateDependencyPlaceholderContractNetworks = template.data.dependencies[templateDependencyPlaceholderKey][templateDependencyPlaceholderContractName];\n          let templateDependency = templateDependencyPlaceholderContractNetworks[network];\n          if (typeof templateDependency === \"undefined\") continue;\n          let pin = await generateDependencyPin({\n            address: templateDependency.address,\n            contractName: templateDependency.contract,\n            blockHeight\n          }, opts);\n          if (pin !== templateDependency.pin) {\n            log({\n              title: \"verifyDependencyPinsSame Debug Error\",\n              message: \"Could not recompute and match dependency pin.\\n                                address: \".concat(templateDependency.address, \" | contract: \").concat(templateDependency.contract, \"\\n                                computed: \").concat(pin, \"\\n                                template: \").concat(templateDependency.pin, \"\\n                            \"),\n              level: LEVELS.debug\n            });\n            return false;\n          }\n        }\n      }\n      return true;\n    default:\n      throw new Error(\"verifyDependencyPinsSame Error: Unsupported template version\");\n  }\n}\n\n/**\n * @description Checks if an Interaction Template's pins match those generated at the latest block height\n * \n * @param {object} params\n * @param {object} params.template - Interaction Template to check pins for\n * @param {string} params.network - Network to check pins on\n * @param {object} opts\n * @returns {Promise<boolean>} - Whether or not the pins match\n */\nasync function verifyDependencyPinsSameAtLatestSealedBlock(_ref2) {\n  let {\n    template,\n    network\n  } = _ref2;\n  let opts = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n  let latestSealedBlock = await block({\n    sealed: true\n  });\n  let latestSealedBlockHeight = latestSealedBlock === null || latestSealedBlock === void 0 ? void 0 : latestSealedBlock.height;\n  return verifyDependencyPinsSame({\n    template,\n    network,\n    blockHeight: latestSealedBlockHeight\n  }, opts);\n}\n\n/**\n * @description Get Interaction Template argument message\n * \n * @param {object} params\n * @param {string} params.localization [localization=\"en-US\"] - Localization code\n * @param {string} params.messageKey - Message key\n * @param {object} params.template - Interaction Template\n * @returns {string} - Message\n */\nfunction getTemplateMessage(_ref) {\n  var _template$data3, _messages$messageKey;\n  let {\n    localization = \"en-US\",\n    messageKey,\n    template\n  } = _ref;\n  invariant$1(messageKey, \"getTemplateMessage({ messageKey }) -- messageKey must be defined\");\n  invariant$1(typeof messageKey === \"string\", \"getTemplateMessage({ messageKey }) -- messageKey must be a string\");\n  invariant$1(localization, \"getTemplateMessage({ localization }) -- localization must be defined\");\n  invariant$1(typeof localization === \"string\", \"getTemplateMessage({ localization }) -- localization must be a string\");\n  invariant$1(template != undefined, \"getTemplateMessage({ template }) -- template must be defined\");\n  invariant$1(typeof template === \"object\", \"getTemplateMessage({ template }) -- template must be an object\");\n  invariant$1(typeof template.f_type === \"InteractionTemplate\", \"getTemplateMessage({ template }) -- template object must be an InteractionTemplate\");\n  const messages = template === null || template === void 0 || (_template$data3 = template.data) === null || _template$data3 === void 0 ? void 0 : _template$data3.messages;\n  return messages === null || messages === void 0 || (_messages$messageKey = messages[messageKey]) === null || _messages$messageKey === void 0 || (_messages$messageKey = _messages$messageKey.i18n) === null || _messages$messageKey === void 0 ? void 0 : _messages$messageKey[localization];\n}\n\n/**\n * @description Gets Interaction Template argument message by message key, argument label, and localization\n * \n * @param {object} opts\n * @param {string} opts.localization [localization=\"en-US\"] - Localization to get message for\n * @param {string} opts.argumentLabel - Argument label to get message for\n * @param {string} opts.messageKey - Message key to get message for\n * @param {object} opts.template - Interaction Template to get message from\n * @returns {string} - Message\n */\nfunction getTemplateArgumentMessage(_ref) {\n  var _template$data4, _args$argumentLabel;\n  let {\n    localization = \"en-US\",\n    argumentLabel,\n    messageKey,\n    template\n  } = _ref;\n  invariant$1(messageKey, \"getTemplateArgumentMessage({ messageKey }) -- messageKey must be defined\");\n  invariant$1(typeof messageKey === \"string\", \"getTemplateArgumentMessage({ messageKey }) -- messageKey must be a string\");\n  invariant$1(argumentLabel, \"getTemplateArgumentMessage({ argumentLabel }) -- argumentLabel must be defined\");\n  invariant$1(typeof messageKey === \"string\", \"getTemplateArgumentMessage({ argumentLabel }) -- argumentLabel must be a string\");\n  invariant$1(localization, \"getTemplateArgumentMessage({ localization }) -- localization must be defined\");\n  invariant$1(typeof localization === \"string\", \"getTemplateArgumentMessage({ localization }) -- localization must be a string\");\n  invariant$1(template != undefined, \"getTemplateArgumentMessage({ template }) -- template must be defined\");\n  invariant$1(typeof template === \"object\", \"getTemplateArgumentMessage({ template }) -- template must be an object\");\n  invariant$1(typeof template.f_type === \"InteractionTemplate\", \"getTemplateArgumentMessage({ template }) -- template object must be an InteractionTemplate\");\n  const args = template === null || template === void 0 || (_template$data4 = template.data) === null || _template$data4 === void 0 ? void 0 : _template$data4.arguments;\n  return args === null || args === void 0 || (_args$argumentLabel = args[argumentLabel]) === null || _args$argumentLabel === void 0 || (_args$argumentLabel = _args$argumentLabel.messages) === null || _args$argumentLabel === void 0 || (_args$argumentLabel = _args$argumentLabel[messageKey]) === null || _args$argumentLabel === void 0 || (_args$argumentLabel = _args$argumentLabel.i18n) === null || _args$argumentLabel === void 0 ? void 0 : _args$argumentLabel[localization];\n}\nvar index = /*#__PURE__*/Object.freeze({\n  __proto__: null,\n  getInteractionTemplateAudits: getInteractionTemplateAudits,\n  generateDependencyPin: generateDependencyPin,\n  generateDependencyPinAtLatestSealedBlock: generateDependencyPinAtLatestSealedBlock,\n  generateTemplateId: generateTemplateId,\n  generateTemplateInterfaceId: generateTemplateInterfaceId,\n  verifyDependencyPinsSame: verifyDependencyPinsSame,\n  verifyDependencyPinsSameAtLatestSealedBlock: verifyDependencyPinsSameAtLatestSealedBlock,\n  deriveCadenceByNetwork: deriveCadenceByNetwork,\n  getTemplateMessage: getTemplateMessage,\n  getTemplateArgumentMessage: getTemplateArgumentMessage\n});\n\n/**\n * @type {Types}\n */\nconst t = t$1;\n\n// Set chain id default on access node change\nwatchForChainIdChanges();\nasync function fetchServices(servicesURL, code) {\n  if (servicesURL == null || code == null) return [];\n  const url = new URL(servicesURL);\n  url.searchParams.append(\"code\", code);\n  const resp = await fetch(url, {\n    method: \"GET\",\n    headers: {\n      \"Content-Type\": \"application/json\"\n    }\n  }).then(d => d.json());\n  if (Array.isArray(resp)) return resp;\n\n  // Backwards compatibility for First-Gen Wallet Providers\n  const services = [];\n\n  // Convert authorizations into authz services\n  if (Array.isArray(resp.authorizations)) {\n    for (let service of resp.authorizations) {\n      services.push({\n        type: \"authz\",\n        keyId: resp.keyId,\n        ...service\n      });\n    }\n  }\n\n  // Convert Provider info into an authn service\n  if (resp.provider != null) {\n    services.push({\n      type: \"authn\",\n      id: \"wallet-provider#authn\",\n      ...resp.provider\n    });\n  }\n  return services;\n}\nfunction mergeServices() {\n  let sx1 = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];\n  let sx2 = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : [];\n  // TODO: Make this smarter\n  return [...sx1, ...sx2];\n}\n\n// {\n//   \"f_type\": \"Service\",\n//   \"f_vsn\": \"1.0.0\",\n//   \"type\": \"authn\",\n//   \"uid\": \"uniqueDedupeKey\",\n//   \"endpoint\": \"https://rawr\",\n//   \"id\": \"xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx\", // wallets internal id for the user\n//   \"identity\": {\n//     \"address\": \"0x____\"\n//   },\n//   \"provider\": {\n//     \"address\": \"0x____\",\n//     \"name\": \"Best Wallet\",\n//     \"description\": \"The Best Wallet\"\n//     \"icon\": \"https://\",\n//   }\n// }\nfunction normalizeAuthn(service) {\n  if (service == null) return null;\n  if (!service[\"f_vsn\"]) {\n    return {\n      ...SERVICE_PRAGMA,\n      type: service.type,\n      uid: service.id,\n      endpoint: service.authn,\n      id: service.pid,\n      provider: {\n        address: withPrefix(service.addr),\n        name: service.name,\n        icon: service.icon\n      }\n    };\n  }\n  switch (service[\"f_vsn\"]) {\n    case \"1.0.0\":\n      return service;\n    default:\n      return null;\n  }\n}\n\n// {\n//   \"f_type\": \"service\",\n//   \"f_vsn\": \"1.0.0\",\n//   \"type\": \"authz\",\n//   \"uid\": \"uniqueDedupeKey\",\n//   \"endpoint\": \"https://rawr\",\n//   \"method\": \"HTTP/POST\", // HTTP/POST | IFRAME/RPC | HTTP/RPC\n//   \"identity\": {\n//      \"address\": \"0x______\",\n//      \"keyId\": 0,\n//   },\n//   \"data\": {}, // included in body of authz request\n//   \"params\": {}, // included as query params on endpoint url\n// }\nfunction normalizeAuthz(service) {\n  if (service == null) return null;\n  if (!service[\"f_vsn\"]) {\n    return {\n      ...SERVICE_PRAGMA,\n      type: service.type,\n      uid: service.id,\n      endpoint: service.endpoint,\n      method: service.method,\n      identity: {\n        ...IDENTITY_PRAGMA,\n        address: withPrefix(service.addr),\n        keyId: service.keyId\n      },\n      params: service.params,\n      data: service.data\n    };\n  }\n  switch (service[\"f_vsn\"]) {\n    case \"1.0.0\":\n      return service;\n    default:\n      return null;\n  }\n}\n\n// {\n//   \"f_type\": \"service\",\n//   \"f_vsn\": \"1.0.0\",\n//   \"type\": \"pre-authz\",\n//   \"uid\": \"uniqueDedupeKey\",\n//   \"endpoint\": \"https://rawr\",\n//   \"method\": \"HTTP/POST\", // HTTP/POST | IFRAME/RPC | HTTP/RPC\n//   \"identity\": {\n//      \"address\": \"0x______\",\n//      \"keyId\": 0,\n//   },\n//   \"data\": {}, // included in body of pre-authz request\n//   \"params\": {}, // included as query params on endpoint url\n// }\nfunction normalizePreAuthz(service) {\n  if (service == null) return null;\n  if (!service[\"f_vsn\"]) {\n    return {\n      ...SERVICE_PRAGMA,\n      type: service.type,\n      uid: service.id,\n      endpoint: service.endpoint,\n      method: service.method,\n      identity: {\n        ...IDENTITY_PRAGMA,\n        address: withPrefix(service.addr),\n        keyId: service.keyId\n      },\n      params: service.params,\n      data: service.data\n    };\n  }\n  switch (service[\"f_vsn\"]) {\n    case \"1.0.0\":\n      return service;\n    default:\n      return null;\n  }\n}\n\n// {\n//    \"f_type\": \"Service\",\n//    \"f_vsn\": \"1.0.0\",\n//    \"type\": \"frame\",\n//    \"endpoint\": \"https://rawr\",\n//    \"data\": {},   // Sent to frame when ready\n//    \"params\": {}, // include in query params on frame\n// }\nfunction normalizeFrame(service) {\n  if (service == null) return null;\n  if (!service[\"f_vsn\"]) {\n    return {\n      old: service,\n      ...SERVICE_PRAGMA,\n      type: \"frame\",\n      endpoint: service.endpoint,\n      params: service.params || {},\n      data: service.data || {}\n    };\n  }\n  switch (service[\"f_vsn\"]) {\n    case \"1.0.0\":\n      return service;\n    default:\n      return null;\n  }\n}\n\n// {\n//    \"f_type\": \"Service\",\n//    \"f_vsn\": \"1.0.0\",\n//    \"type\": \"back-channel-rpc\",\n//    \"endpoint\": \"https://rawr\",\n//    \"method\": \"HTTP/GET\", // HTTP/GET | HTTP/POST\n//    \"data\": {},           // included in body of rpc\n//    \"params\": {},         // included as query params on endpoint url\n// }\nfunction normalizeBackChannelRpc(service) {\n  if (service == null) return null;\n  if (!service[\"f_vsn\"]) {\n    return {\n      ...SERVICE_PRAGMA,\n      type: \"back-channel-rpc\",\n      endpoint: service.endpoint,\n      method: service.method,\n      params: service.params || {},\n      data: service.data || {}\n    };\n  }\n  switch (service[\"f_vsn\"]) {\n    case \"1.0.0\":\n      return service;\n    default:\n      return null;\n  }\n}\n\n// {\n//   \"f_type\": \"Service\",\n//   \"f_vsn\": \"1.0.0\",\n//   \"type\": \"open-id\",\n//   \"uid\": \"uniqueDedupeKey\",\n//   \"method: \"data\",\n//   \"data\": {\n//      \"profile\": {\n//        \"name\": \"Bob\",\n//        \"family_name\": \"Builder\",\n//        \"given_name\": \"Robert\",\n//        \"middle_name\": \"the\",\n//        \"nickname\": \"Bob the Builder\",\n//        \"perferred_username\": \"bob\",\n//        \"profile\": \"https://www.bobthebuilder.com/\",\n//        \"picture\": \"https://avatars.onflow.org/avatar/bob\",\n//        \"gender\": \"...\",\n//        \"birthday\": \"2001-01-18\",\n//        \"zoneinfo\": \"America/Vancouver\",\n//        \"locale\": \"en-us\",\n//        \"updated_at\": \"1614970797388\"\n//      },\n//      \"email\": {\n//        \"email\": \"bob@bob.bob\",\n//        \"email_verified\": true\n//      },\n//      \"address\": {\n//        \"address\": \"One Apple Park Way, Cupertino, CA 95014, USA\"\n//      },\n//      \"phone\": {\n//        \"phone_number\": \"+1 (xxx) yyy-zzzz\",\n//        \"phone_number_verified\": true\n//      },\n//      \"social\": {\n//        \"twitter\": \"@_qvvg\",\n//        \"twitter_verified\": true\n//      },\n//   }\n// }\nfunction normalizeOpenId(service) {\n  if (service == null) return null;\n  switch (service[\"f_vsn\"]) {\n    case \"1.0.0\":\n      return service;\n    default:\n      return null;\n  }\n}\n\n// {\n//   \"f_type\": \"Service\",\n//   \"f_vsn\": \"1.0.0\",\n//   \"type\": \"user-signature\",\n//   \"uid\": \"uniqueDedupeKey\",\n//   \"endpoint\": \"https://rawr\",\n//   \"method\": \"IFRAME/RPC\", // HTTP/POST | IFRAME/RPC | HTTP/RPC\n//   \"id\": \"xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx\", // wallets internal id for the user\n//   \"data\": {}, // included in body of user-signature request\n//   \"params\": {}, // included as query params on endpoint url\n// }\nfunction normalizeUserSignature(service) {\n  if (service == null) return null;\n  if (!service[\"f_vsn\"]) {\n    throw new Error(\"Invalid user-signature service\");\n  }\n  switch (service[\"f_vsn\"]) {\n    case \"1.0.0\":\n      return service;\n    default:\n      return null;\n  }\n}\n\n// {\n//    \"f_type\": \"Service\",\n//    \"f_vsn\": \"1.0.0\",\n//    type: \"local-view\",\n//    method: \"VIEW/IFRAME\",\n//    endpoint: \"https://woot.org/authz/local\",\n//    data: {},\n//    params: {},\n// }\nfunction normalizeLocalView(resp) {\n  if (resp == null) return null;\n  if (resp.method == null) {\n    resp = {\n      ...resp,\n      type: \"local-view\",\n      method: \"VIEW/IFRAME\"\n    };\n  }\n  if (!resp[\"f_vsn\"]) {\n    return {\n      ...SERVICE_PRAGMA,\n      type: resp.type || \"local-view\",\n      method: resp.method,\n      endpoint: resp.endpoint,\n      data: resp.data || {},\n      params: resp.params || {}\n    };\n  }\n  switch (resp[\"f_vsn\"]) {\n    case \"1.0.0\":\n      return resp;\n    default:\n      return null;\n  }\n}\n\n// {\n//   \"f_type\": \"Service\",                    // Its a service!\n//   \"f_vsn\": \"1.0.0\",                       // Follows the v1.0.0 spec for the service\n//   \"type\": \"account-proof\",                // the type of service it is\n//   \"method\": \"DATA\",                       // Its data!\n//   \"uid\": \"awesome-wallet#account-proof\",  // A unique identifier for the service\n//   \"data\": {\n//     \"f_type\": \"account-proof\",\n//     \"f_vsn\": \"1.0.0\",\n//     \"nonce\": \"0A1BC2FF\",                  // Nonce signed by the current account-proof (minimum 32 bytes in total, i.e 64 hex characters)\n//     \"address\": \"0xUSER\",                  // The user's address (8 bytes, i.e 16 hex characters)\n//     \"signature\": CompositeSignature,      // address (sans-prefix), keyId, signature (hex)\n// }\n\nfunction normalizeAccountProof(service) {\n  if (service == null) return null;\n  if (!service[\"f_vsn\"]) {\n    throw new Error(\"FCL Normalizer Error: Invalid account-proof service\");\n  }\n  switch (service[\"f_vsn\"]) {\n    case \"1.0.0\":\n      return service;\n    default:\n      return null;\n  }\n}\n\n// {\n//   \"f_type\": \"Service\",\n//   \"f_vsn\": \"1.0.0\",\n//   \"type\": \"authn-refresh\",\n//   \"uid\": \"uniqueDedupeKey\",\n//   \"endpoint\": \"https://rawr\",\n//   \"method\": \"HTTP/POST\",  // \"HTTP/POST\", // HTTP/POST | IFRAME/RPC | HTTP/RPC\n//   \"id\": \"xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx\", // wallets internal id for the user\n//   \"data\": {}, // included in body of request\n//   \"params\": {}, // included as query params on endpoint url\n// }\nfunction normalizeAuthnRefresh(service) {\n  if (service == null) return null;\n  if (!service[\"f_vsn\"]) {\n    throw new Error(\"Invalid authn-refresh service\");\n  }\n  switch (service[\"f_vsn\"]) {\n    case \"1.0.0\":\n      return service;\n    default:\n      return null;\n  }\n}\nfunction normalizeServices(services, data) {\n  return services.map(service => normalizeService(service, data)).filter(Boolean);\n}\nconst serviceNormalizers = {\n  \"back-channel-rpc\": normalizeBackChannelRpc,\n  \"pre-authz\": normalizePreAuthz,\n  authz: normalizeAuthz,\n  authn: normalizeAuthn,\n  frame: normalizeFrame,\n  \"open-id\": normalizeOpenId,\n  \"user-signature\": normalizeUserSignature,\n  \"local-view\": normalizeLocalView,\n  \"account-proof\": normalizeAccountProof,\n  \"authn-refresh\": normalizeAuthnRefresh\n};\nfunction normalizeService(service, data) {\n  try {\n    var normalized = serviceNormalizers[service.type](service, data);\n    return normalized;\n  } catch (error) {\n    console.error(\"Unrecognized FCL Service Type [\".concat(service.type, \"]\"), service, error);\n    return service;\n  }\n}\nfunction serviceOfType() {\n  let services = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];\n  let type = arguments.length > 1 ? arguments[1] : undefined;\n  // Find the greatest version of the service type\n  return services.reduce((mostRecent, service) => service.type === type ? !mostRecent || semver.compare(service.f_vsn, mostRecent.f_vsn) > 0 ? service : mostRecent : mostRecent, null);\n}\nfunction deriveCompositeId(authn) {\n  return rlp.encode([authn.provider.address || authn.provider.name || \"UNSPECIFIED\", authn.id]).toString(\"hex\");\n}\nfunction normalizeData(data) {\n  data.addr = data.addr ? withPrefix(data.addr) : null;\n  data.paddr = data.paddr ? withPrefix(data.paddr) : null;\n  return data;\n}\nasync function buildUser(data) {\n  data = normalizeData(data);\n  var services = normalizeServices(mergeServices(data.services || [], await fetchServices(data.hks, data.code)));\n  const authn = serviceOfType(services, \"authn\");\n  return {\n    ...USER_PRAGMA,\n    addr: withPrefix(data.addr),\n    cid: deriveCompositeId(authn),\n    loggedIn: true,\n    services: services,\n    expiresAt: data.expires\n  };\n}\nconst execStrategy = async _ref => {\n  let {\n    service,\n    body,\n    config,\n    opts\n  } = _ref;\n  const strategy = getServiceRegistry().getStrategy(service.method);\n  return strategy({\n    service,\n    body,\n    config,\n    opts\n  });\n};\nasync function execService(_ref2) {\n  var _window$location$host, _window3;\n  let {\n    service,\n    msg = {},\n    config = {},\n    opts = {},\n    platform\n  } = _ref2;\n  msg.data = service.data;\n  const execConfig = {\n    services: await configLens(/^service\\./),\n    app: await configLens(/^app\\.detail\\./),\n    client: {\n      ...config.client,\n      platform,\n      fclVersion: VERSION,\n      fclLibrary: \"https://github.com/onflow/fcl-js\",\n      hostname: (_window$location$host = (_window3 = window) === null || _window3 === void 0 || (_window3 = _window3.location) === null || _window3 === void 0 ? void 0 : _window3.hostname) !== null && _window$location$host !== void 0 ? _window$location$host : null,\n      network: await getChainId(opts)\n    }\n  };\n  try {\n    const res = await execStrategy({\n      service,\n      body: msg,\n      config: execConfig,\n      opts\n    });\n    if (res.status === \"REDIRECT\") {\n      invariant(service.type === res.data.type, \"Cannot shift recursive service type in execService\");\n      return await execService({\n        service: res.data,\n        msg,\n        config: execConfig,\n        opts\n      });\n    } else {\n      return res;\n    }\n  } catch (error) {\n    log({\n      title: \"Error on execService \".concat(service === null || service === void 0 ? void 0 : service.type),\n      message: error,\n      level: LEVELS.error\n    });\n    throw error;\n  }\n}\n\n// {\n//    \"f_type\": \"CompositeSignature\",\n//    \"f_vsn\": \"1.0.0\",\n//    \"addr\": \"_____\",         // sans-prefix\n//    \"signature\": \"adfe1234\", // hex\n//    \"keyId\": 3,\n// }\nfunction normalizeCompositeSignature(resp) {\n  if (resp == null) return null;\n  if (!resp[\"f_vsn\"]) {\n    return {\n      ...COMPOSITE_SIGNATURE_PRAGMA,\n      addr: sansPrefix(resp.addr || resp.address),\n      signature: resp.signature || resp.sig,\n      keyId: resp.keyId\n    };\n  }\n  switch (resp[\"f_vsn\"]) {\n    case \"1.0.0\":\n      return resp;\n    default:\n      return null;\n  }\n}\n\n/**\n * @typedef {import(\"@onflow/typedefs\").CurrentUser} CurrentUser\n * @typedef {import(\"@onflow/typedefs\").CompositeSignature} CompositeSignature\n */\n\nconst isFn = d => typeof d === \"function\";\nconst NAME = \"CURRENT_USER\";\nconst UPDATED = \"CURRENT_USER/UPDATED\";\nconst SNAPSHOT = \"SNAPSHOT\";\nconst SET_CURRENT_USER = \"SET_CURRENT_USER\";\nconst DEL_CURRENT_USER = \"DEL_CURRENT_USER\";\nconst DATA = \"{\\n  \\\"f_type\\\": \\\"User\\\",\\n  \\\"f_vsn\\\": \\\"1.0.0\\\",\\n  \\\"addr\\\":null,\\n  \\\"cid\\\":null,\\n  \\\"loggedIn\\\":null,\\n  \\\"expiresAt\\\":null,\\n  \\\"services\\\":[]\\n}\";\nconst getStoredUser = async storage => {\n  const fallback = JSON.parse(DATA);\n  const stored = await storage.get(NAME);\n  if (stored != null && fallback[\"f_vsn\"] !== stored[\"f_vsn\"]) {\n    storage.removeItem(NAME);\n    return fallback;\n  }\n  return stored || fallback;\n};\nconst HANDLERS = {\n  [INIT]: async ctx => {\n    if (typeof window === \"undefined\") {\n      console.warn(\"\\n        %cFCL Warning\\n        ============================\\n        \\\"currentUser\\\" is only available in the browser.\\n        For more info, please see the docs: https://docs.onflow.org/fcl/\\n        ============================\\n        \", \"font-weight:bold;font-family:monospace;\");\n    }\n    ctx.merge(JSON.parse(DATA));\n    const storage = await config.first([\"fcl.storage\", \"fcl.storage.default\"]);\n    if (storage.can) {\n      const user = await getStoredUser(storage);\n      if (notExpired(user)) ctx.merge(user);\n    }\n  },\n  [SUBSCRIBE]: (ctx, letter) => {\n    ctx.subscribe(letter.from);\n    ctx.send(letter.from, UPDATED, {\n      ...ctx.all()\n    });\n  },\n  [UNSUBSCRIBE]: (ctx, letter) => {\n    ctx.unsubscribe(letter.from);\n  },\n  [SNAPSHOT]: async (ctx, letter) => {\n    letter.reply({\n      ...ctx.all()\n    });\n  },\n  [SET_CURRENT_USER]: async (ctx, letter, data) => {\n    ctx.merge(data);\n    const storage = await config.first([\"fcl.storage\", \"fcl.storage.default\"]);\n    if (storage.can) storage.put(NAME, ctx.all());\n    ctx.broadcast(UPDATED, {\n      ...ctx.all()\n    });\n  },\n  [DEL_CURRENT_USER]: async (ctx, letter) => {\n    ctx.merge(JSON.parse(DATA));\n    const storage = await config.first([\"fcl.storage\", \"fcl.storage.default\"]);\n    if (storage.can) storage.put(NAME, ctx.all());\n    ctx.broadcast(UPDATED, {\n      ...ctx.all()\n    });\n  }\n};\nconst spawnCurrentUser = () => spawn(HANDLERS, NAME);\nfunction notExpired(user) {\n  return user.expiresAt == null || user.expiresAt === 0 || user.expiresAt > Date.now();\n}\nasync function getAccountProofData() {\n  let accountProofDataResolver = await config.get(\"fcl.accountProof.resolver\");\n  if (accountProofDataResolver == null) return;\n  if (!isFn(accountProofDataResolver)) {\n    log({\n      title: \"Account Proof Data Resolver must be a function\",\n      message: \"Check fcl.accountProof.resolver configuration.\\n                Expected: fcl.accountProof.resolver: async () => { ... }\\n                Received: fcl.accountProof.resolver: \".concat(typeof accountProofDataResolver, \"\\n                \"),\n      level: LEVELS.warn\n    });\n    return;\n  }\n  const accountProofData = await accountProofDataResolver();\n  if (accountProofData == null) return;\n  invariant(typeof accountProofData.appIdentifier === \"string\", \"appIdentifier must be a string\");\n  invariant(/^[0-9a-f]+$/i.test(accountProofData.nonce), \"Nonce must be a hex string\");\n  return accountProofData;\n}\nconst makeConfig = async _ref => {\n  let {\n    discoveryAuthnInclude,\n    discoveryFeaturesSuggested\n  } = _ref;\n  return {\n    client: {\n      discoveryAuthnInclude,\n      discoveryFeaturesSuggested,\n      clientServices: await makeDiscoveryServices(),\n      supportedStrategies: getServiceRegistry().getStrategies()\n    }\n  };\n};\n\n/**\n * @description - Authenticate a user\n * @param {object} [opts] - Options\n * @param {object} [opts.platform] - platform that runs the function\n * @param {object} [opts.service] - Optional service to use for authentication\n * @param {boolean} [opts.redir=false] - Optional flag to allow window to stay open after authentication\n * @returns {function(*)Promise<CurrentUser>} - User object\n */\nconst getAuthenticate = _ref2 => {\n  let {\n    platform\n  } = _ref2;\n  return async function () {\n    var _service$provider, _service$provider2;\n    let {\n      service,\n      redir = false\n    } = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    if (service && !(service !== null && service !== void 0 && (_service$provider = service.provider) !== null && _service$provider !== void 0 && _service$provider.is_installed) && service !== null && service !== void 0 && (_service$provider2 = service.provider) !== null && _service$provider2 !== void 0 && _service$provider2.requires_install) {\n      var _service$provider3;\n      window.location.href = service === null || service === void 0 || (_service$provider3 = service.provider) === null || _service$provider3 === void 0 ? void 0 : _service$provider3.install_link;\n      return;\n    }\n    return new Promise(async (resolve, reject) => {\n      spawnCurrentUser();\n      const opts = {\n        redir\n      };\n      const user = await snapshot();\n      const discoveryService = await getDiscoveryService(service);\n      const refreshService = serviceOfType(user.services, \"authn-refresh\");\n      let accountProofData;\n      if (user.loggedIn) {\n        if (refreshService) {\n          try {\n            const response = await execService({\n              service: refreshService,\n              msg: accountProofData,\n              opts,\n              platform\n            });\n            send$1(NAME, SET_CURRENT_USER, await buildUser(response));\n          } catch (error) {\n            log({\n              title: \"\".concat(error.name, \" Could not refresh wallet authentication.\"),\n              message: error.message,\n              level: LEVELS.error\n            });\n          } finally {\n            return resolve(await snapshot());\n          }\n        } else {\n          return resolve(user);\n        }\n      }\n      try {\n        accountProofData = await getAccountProofData();\n      } catch (error) {\n        log({\n          title: \"\".concat(error.name, \" On Authentication: Could not resolve account proof data.\"),\n          message: error.message,\n          level: LEVELS.error\n        });\n        return reject(error);\n      }\n      try {\n        const response = await execService({\n          service: discoveryService,\n          msg: accountProofData,\n          config: await makeConfig(discoveryService),\n          opts,\n          platform\n        });\n        send$1(NAME, SET_CURRENT_USER, await buildUser(response));\n      } catch (error) {\n        log({\n          title: \"\".concat(error, \" On Authentication\"),\n          message: error,\n          level: LEVELS.error\n        });\n      } finally {\n        resolve(await snapshot());\n      }\n    });\n  };\n};\n\n/**\n * @description - Unauthenticate a user\n * @returns {void}\n */\nfunction unauthenticate$1() {\n  spawnCurrentUser();\n  send$1(NAME, DEL_CURRENT_USER);\n}\nconst normalizePreAuthzResponse = authz => ({\n  f_type: \"PreAuthzResponse\",\n  f_vsn: \"1.0.0\",\n  proposer: (authz || {}).proposer,\n  payer: (authz || {}).payer || [],\n  authorization: (authz || {}).authorization || []\n});\nconst getResolvePreAuthz = _ref3 => {\n  let {\n    platform\n  } = _ref3;\n  return authz => {\n    const resp = normalizePreAuthzResponse(authz);\n    const axs = [];\n    if (resp.proposer != null) axs.push([\"PROPOSER\", resp.proposer]);\n    for (let az of resp.payer || []) axs.push([\"PAYER\", az]);\n    for (let az of resp.authorization || []) axs.push([\"AUTHORIZER\", az]);\n    var result = axs.map(_ref4 => {\n      let [role, az] = _ref4;\n      return {\n        tempId: [az.identity.address, az.identity.keyId].join(\"|\"),\n        addr: az.identity.address,\n        keyId: az.identity.keyId,\n        signingFunction(signable) {\n          return execService({\n            service: az,\n            msg: signable,\n            platform\n          });\n        },\n        role: {\n          proposer: role === \"PROPOSER\",\n          payer: role === \"PAYER\",\n          authorizer: role === \"AUTHORIZER\"\n        }\n      };\n    });\n    return result;\n  };\n};\n\n/**\n * @description\n * Produces the needed authorization details for the current user to submit transactions to Flow\n * It defines a signing function that connects to a user's wallet provider to produce signatures to submit transactions.\n *\n * @param {object} ops - running options\n * @param {string} ops.platform - platform that runs the function\n * @param {object} account - Account object\n * @returns {Promise<object>} - Account object with signing function\n */\nconst getAuthorization = _ref5 => {\n  let {\n    platform\n  } = _ref5;\n  return async account => {\n    spawnCurrentUser();\n    return {\n      ...account,\n      tempId: \"CURRENT_USER\",\n      async resolve(account, preSignable) {\n        const user = await getAuthenticate({\n          platform\n        })({\n          redir: true\n        });\n        const authz = serviceOfType(user.services, \"authz\");\n        const preAuthz = serviceOfType(user.services, \"pre-authz\");\n        if (preAuthz) return getResolvePreAuthz({\n          platform\n        })(await execService({\n          service: preAuthz,\n          msg: preSignable,\n          platform\n        }));\n        if (authz) {\n          let windowRef;\n          if (isMobile() && authz.method === \"WC/RPC\") {\n            windowRef = window.open(\"\", \"_blank\");\n          }\n          return {\n            ...account,\n            tempId: \"CURRENT_USER\",\n            resolve: null,\n            addr: sansPrefix(authz.identity.address),\n            keyId: authz.identity.keyId,\n            sequenceNum: null,\n            signature: null,\n            async signingFunction(signable) {\n              return normalizeCompositeSignature(await execService({\n                service: authz,\n                msg: signable,\n                opts: {\n                  includeOlderJsonRpcCall: true,\n                  windowRef\n                },\n                platform\n              }));\n            }\n          };\n        }\n        throw new Error(\"No Authz or PreAuthz Service configured for CURRENT_USER\");\n      }\n    };\n  };\n};\n\n/**\n * @description\n * The callback passed to subscribe will be called when the user authenticates and un-authenticates, making it easy to update the UI accordingly.\n *\n * @param {Function} callback - Callback function\n * @returns {Function} - Unsubscribe function\n */\nfunction subscribe(callback) {\n  spawnCurrentUser();\n  const EXIT = \"@EXIT\";\n  const self = spawn(async ctx => {\n    ctx.send(NAME, SUBSCRIBE);\n    while (1) {\n      const letter = await ctx.receive();\n      if (letter.tag === EXIT) {\n        ctx.send(NAME, UNSUBSCRIBE);\n        return;\n      }\n      callback(letter.data);\n    }\n  });\n  return () => send$1(self, EXIT);\n}\n\n/**\n * @description - Gets the current user\n * @returns {Promise<CurrentUser>} - User object\n */\nfunction snapshot() {\n  spawnCurrentUser();\n  return send$1(NAME, SNAPSHOT, null, {\n    expectReply: true,\n    timeout: 0\n  });\n}\n\n/**\n * @description - Resolves the current user as an argument\n *\n * @param {object} ops - running options\n * @param {string} ops.platform - platform that runs the function\n * @returns {Promise<Function>}\n */\nconst getResolveArgument = _ref6 => {\n  let {\n    platform\n  } = _ref6;\n  return async () => {\n    const {\n      addr\n    } = await getAuthenticate({\n      platform\n    })();\n    return arg(withPrefix(addr), t$1.Address);\n  };\n};\nconst makeSignable = msg => {\n  invariant(/^[0-9a-f]+$/i.test(msg), \"Message must be a hex string\");\n  return {\n    message: msg\n  };\n};\n\n/**\n * @description - A method to use allowing the user to personally sign data via FCL Compatible Wallets/Services.\n * @param {string} msg - Message to sign\n * @returns {Promise<CompositeSignature[]>} - Array of CompositeSignatures\n */\nconst getSignUserMessage = _ref7 => {\n  let {\n    platform\n  } = _ref7;\n  return async msg => {\n    spawnCurrentUser();\n    const user = await getAuthenticate({\n      platform\n    })({\n      redir: true\n    });\n    const signingService = serviceOfType(user.services, \"user-signature\");\n    invariant(signingService, \"Current user must have authorized a signing service.\");\n    try {\n      const response = await execService({\n        service: signingService,\n        msg: makeSignable(msg),\n        platform\n      });\n      if (Array.isArray(response)) {\n        return response.map(compSigs => normalizeCompositeSignature(compSigs));\n      } else {\n        return [normalizeCompositeSignature(response)];\n      }\n    } catch (error) {\n      return error;\n    }\n  };\n};\nconst getCurrentUser = _ref8 => {\n  let {\n    platform\n  } = _ref8;\n  let currentUser = () => {\n    return {\n      authenticate: getAuthenticate({\n        platform\n      }),\n      unauthenticate: unauthenticate$1,\n      authorization: getAuthorization({\n        platform\n      }),\n      signUserMessage: getSignUserMessage({\n        platform\n      }),\n      subscribe,\n      snapshot,\n      resolveArgument: getResolveArgument({\n        platform\n      })\n    };\n  };\n  currentUser.authenticate = getAuthenticate({\n    platform\n  });\n  currentUser.unauthenticate = unauthenticate$1;\n  currentUser.authorization = getAuthorization({\n    platform\n  });\n  currentUser.signUserMessage = getSignUserMessage({\n    platform\n  });\n  currentUser.subscribe = subscribe;\n  currentUser.snapshot = snapshot;\n  currentUser.resolveArgument = getResolveArgument({\n    platform\n  });\n  return currentUser;\n};\nconst getMutate = _ref => {\n  let {\n    platform\n  } = _ref;\n  /**\n   * @description\n   * Allows you to submit transactions to the blockchain to potentially mutate the state.\n   *\n   * @param {object} [opts] - Mutation Options and configuration\n   * @param {string} [opts.cadence] - Cadence Transaction used to mutate Flow\n   * @param {import(\"../shared-exports\").ArgsFn} [opts.args] - Arguments passed to cadence transaction\n   * @param {object | string} [opts.template] - Interaction Template for a transaction\n   * @param {number} [opts.limit] - Compute Limit for transaction\n   * @param {Function} [opts.authz] - Authorization function for transaction\n   * @param {Function} [opts.proposer] - Proposer Authorization function for transaction\n   * @param {Function} [opts.payer] - Payer Authorization function for transaction\n   * @param {Array<Function>} [opts.authorizations] - Authorizations function for transaction\n   * @returns {Promise<string>} Transaction Id\n   *\n   * @example\n   * fcl.mutate({\n   *   cadence: `\n   *     transaction(a: Int, b: Int, c: Address) {\n   *       prepare(acct: AuthAccount) {\n   *         log(acct)\n   *         log(a)\n   *         log(b)\n   *         log(c)\n   *       }\n   *     }\n   *   `,\n   *   args: (arg, t) => [\n   *     arg(6, t.Int),\n   *     arg(7, t.Int),\n   *     arg(\"0xba1132bc08f82fe2\", t.Address),\n   *   ],\n   * })\n   *\n   *\n   * Options:\n   * type Options = {\n   *   template: InteractionTemplate | String // InteractionTemplate or url to one\n   *   cadence: String!,\n   *   args: (arg, t) => Array<Arg>,\n   *   limit: Number,\n   *   authz: AuthzFn, // will overload the trinity of signatory roles\n   *   proposer: AuthzFn, // will overload the proposer signatory role\n   *   payer: AuthzFn, // will overload the payer signatory role\n   *   authorizations: [AuthzFn], // an array of authorization functions used as authorizations signatory roles\n   * }\n   */\n  const mutate = async function () {\n    let opts = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    var txid;\n    try {\n      await preMutate(opts);\n      opts = await prepTemplateOpts(opts);\n      const currentUser = getCurrentUser({\n        platform\n      });\n      // Allow for a config to overwrite the authorization function.\n      // prettier-ignore\n      const authz = await sdk.config().get(\"fcl.authz\", currentUser().authorization);\n      txid = sdk.config().overload(opts.dependencies || {}, async () =>\n      // prettier-ignore\n      sdk.send([sdk.transaction(opts.cadence), sdk.args(normalizeArgs(opts.args || [])), opts.limit && isNumber(opts.limit) && sdk.limit(opts.limit),\n      // opts.proposer > opts.authz > authz\n      sdk.proposer(opts.proposer || opts.authz || authz),\n      // opts.payer > opts.authz > authz\n      sdk.payer(opts.payer || opts.authz || authz),\n      // opts.authorizations > [opts.authz > authz]\n      sdk.authorizations(opts.authorizations || [opts.authz || authz])]).then(sdk.decode));\n      return txid;\n    } catch (error) {\n      throw error;\n    }\n  };\n  return mutate;\n};\nconst FRAME = \"FCL_IFRAME\";\nconst FRAME_STYLES = \"\\n  position:fixed;\\n  top: 0px;\\n  right: 0px;\\n  bottom: 0px;\\n  left: 0px;\\n  height: 100%;\\n  width: 100vw;\\n  display:block;\\n  background:rgba(0,0,0,0.25);\\n  z-index: 2147483647;\\n  box-sizing: border-box;\\n  color-scheme: light;\\n\";\nfunction renderFrame(src) {\n  invariant(!document.getElementById(FRAME), \"Attempt at triggering multiple Frames\", {\n    src\n  });\n  const $frame = document.createElement(\"iframe\");\n  $frame.src = src;\n  $frame.id = FRAME;\n  $frame.allow = \"usb *; hid *\";\n  $frame.frameBorder = \"0\";\n  $frame.style.cssText = FRAME_STYLES;\n  document.body.append($frame);\n  const unmount = () => {\n    if (document.getElementById(FRAME)) {\n      document.getElementById(FRAME).remove();\n    }\n  };\n  return [$frame.contentWindow, unmount];\n}\nconst POP = \"FCL_POP\";\nlet popup = null;\nlet previousUrl$1 = null;\nfunction popupWindow(url, windowName, win, w, h) {\n  const y = win.top.outerHeight / 2 + win.top.screenY - h / 2;\n  const x = win.top.outerWidth / 2 + win.top.screenX - w / 2;\n  const popup = win.open(url, windowName, \"toolbar=no, location=no, directories=no, status=no, menubar=no, scrollbars=no, resizable=no, copyhistory=no, width=\".concat(w, \", height=\").concat(h, \", top=\").concat(y, \", left=\").concat(x));\n  if (!popup) throw new Error(\"Popup failed to open (was it blocked by a popup blocker?)\");\n  return popup;\n}\nfunction renderPop(src) {\n  var _popup;\n  if (popup == null || (_popup = popup) !== null && _popup !== void 0 && _popup.closed) {\n    popup = popupWindow(src, POP, window, 640, 770);\n  } else if (previousUrl$1 !== src) {\n    popup.location.replace(src);\n    popup.focus();\n  } else {\n    popup.focus();\n  }\n  previousUrl$1 = src;\n  const unmount = () => {\n    if (popup && !popup.closed) {\n      popup.close();\n    }\n    popup = null;\n  };\n  return [popup, unmount];\n}\nlet tab$1 = null;\nlet previousUrl = null;\nfunction renderTab(src) {\n  var _tab$;\n  if (tab$1 == null || (_tab$ = tab$1) !== null && _tab$ !== void 0 && _tab$.closed) {\n    tab$1 = window.open(src, \"_blank\");\n    if (!tab$1) throw new Error(\"Tab failed to open (was it blocked by the browser?)\");\n  } else if (previousUrl !== src) {\n    tab$1.location.replace(src);\n    tab$1.focus();\n  } else {\n    tab$1.focus();\n  }\n  previousUrl = src;\n  const unmount = () => {\n    if (tab$1 && !tab$1.closed) {\n      tab$1.close();\n    }\n    tab$1 = null;\n  };\n  return [tab$1, unmount];\n}\nconst isServerSide = () => typeof window === \"undefined\";\nconst getSessionStorage = () => {\n  try {\n    const SESSION_STORAGE = {\n      can: !isServerSide(),\n      get: async key => JSON.parse(sessionStorage.getItem(key)),\n      put: async (key, value) => sessionStorage.setItem(key, JSON.stringify(value))\n    };\n    return SESSION_STORAGE;\n  } catch (error) {\n    return null;\n  }\n};\nconst getDefaultConfig = () => {\n  return {\n    \"discovery.wallet.method.default\": \"IFRAME/RPC\",\n    \"fcl.storage.default\": getSessionStorage()\n  };\n};\nfunction serviceEndpoint(service) {\n  var _window4;\n  const url = new URL(service.endpoint);\n  if ((_window4 = window) !== null && _window4 !== void 0 && (_window4 = _window4.location) !== null && _window4 !== void 0 && _window4.origin) {\n    url.searchParams.append(\"l6n\", window.location.origin);\n  }\n  if (service.params != null) {\n    for (let [key, value] of Object.entries(service.params || {})) {\n      url.searchParams.append(key, value);\n    }\n  }\n  return url;\n}\nfunction fetchService(service) {\n  let opts = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n  const method = opts.method || \"POST\";\n  const body = method === \"GET\" ? undefined : JSON.stringify(opts.data || service.data || {});\n  return fetch(serviceEndpoint(service), {\n    method: method,\n    headers: {\n      ...(service.headers || {}),\n      ...(opts.headers || {}),\n      \"Content-Type\": \"application/json\"\n    },\n    body: body\n  }).then(d => d.json());\n}\n\n// {\n//    \"f_type\": \"PollingResponse\",\n//    \"f_vsn\": \"1.0.0\",\n//    \"status\": \"PENDING\", // PENDING | APPROVED | DECLINED | REDIRECT\n//    \"reason\": null,      // Reason for Declining Transaction\n//    \"data\": null,        // Return value for APPROVED\n//    \"updates\": BackChannelRpc,\n//    \"local\": Frame,\n// }\nfunction normalizePollingResponse(resp) {\n  if (resp == null) return null;\n  if (!resp[\"f_vsn\"]) {\n    var _resp$status, _resp$reason;\n    return {\n      ...POLLING_RESPONSE_PRAGMA,\n      status: (_resp$status = resp.status) !== null && _resp$status !== void 0 ? _resp$status : \"APPROVED\",\n      reason: (_resp$reason = resp.reason) !== null && _resp$reason !== void 0 ? _resp$reason : null,\n      data: resp.compositeSignature || resp.data || {\n        ...resp\n      } || {},\n      updates: normalizeBackChannelRpc(resp.authorizationUpdates),\n      local: normalizeFrame((resp.local || [])[0])\n    };\n  }\n  switch (resp[\"f_vsn\"]) {\n    case \"1.0.0\":\n      return resp;\n    default:\n      return null;\n  }\n}\nconst OPTIONS = {\n  \"HTTP/GET\": \"GET\",\n  \"HTTP/POST\": \"POST\"\n};\nconst serviceMethod = service => {\n  invariant(OPTIONS[service.method], \"Invalid Service Method for type back-channel-rpc\", {\n    service\n  });\n  return OPTIONS[service.method];\n};\nasync function poll(service) {\n  let checkCanContinue = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : () => true;\n  invariant(service, \"Missing Polling Service\", {\n    service\n  });\n  const canContinue = checkCanContinue();\n  if (!canContinue) throw new Error(\"Externally Halted\");\n  let resp;\n  try {\n    if (typeof document !== \"undefined\" && document.visibilityState === \"hidden\") {\n      await new Promise(r => setTimeout(r, 500));\n      return poll(service, checkCanContinue);\n    }\n    resp = await fetchService(service, {\n      method: serviceMethod(service)\n    }).then(normalizePollingResponse);\n  } catch (error) {\n    throw error;\n  }\n  switch (resp.status) {\n    case \"APPROVED\":\n      return resp.data;\n    case \"DECLINED\":\n      throw new Error(\"Declined: \".concat(resp.reason || \"No reason supplied.\"));\n    default:\n      await new Promise(r => setTimeout(r, 500));\n      return poll(resp.updates, checkCanContinue);\n  }\n}\nconst getExecHttpPost = execLocal => async _ref => {\n  let {\n    service,\n    body,\n    config,\n    opts\n  } = _ref;\n  const resp = await fetchService(service, {\n    data: {\n      fclVersion: VERSION,\n      service: {\n        params: service.params,\n        data: service.data,\n        type: service.type\n      },\n      config,\n      ...body\n    }\n  }).then(normalizePollingResponse);\n  if (resp.status === \"APPROVED\") {\n    return resp.data;\n  } else if (resp.status === \"DECLINED\") {\n    throw new Error(\"Declined: \".concat(resp.reason || \"No reason supplied.\"));\n  } else if (resp.status === \"REDIRECT\") {\n    return resp;\n  } else if (resp.status === \"PENDING\") {\n    // these two flags are required to run polling one more time before it stops\n    var canContinue = true;\n    var shouldContinue = true;\n    const [_, unmount] = await execLocal(normalizeLocalView(resp.local), {\n      serviceEndpoint,\n      onClose: () => shouldContinue = false\n    });\n    const close = () => {\n      try {\n        unmount();\n        shouldContinue = false;\n      } catch (error) {\n        console.error(\"Frame Close Error\", error);\n      }\n    };\n    /**\n     * this function is run once per poll call.\n     * Offsetting canContinue flag to make sure that\n     * the polling is performed one extra time after canContinue flag is set to false\n     * to prevent halting on Android when a browser calls window.close\n     * before FCL receives a successful result from polling\n     *\n     * @returns {boolean} \n     */\n    const checkCanContinue = () => {\n      const offsetCanContinue = canContinue;\n      canContinue = shouldContinue;\n      return offsetCanContinue;\n    };\n    return poll(resp.updates, checkCanContinue).then(serviceResponse => {\n      close();\n      return serviceResponse;\n    }).catch(error => {\n      console.error(error);\n      close();\n      throw error;\n    });\n  } else {\n    console.error(\"Auto Decline: Invalid Response\", {\n      service,\n      resp\n    });\n    throw new Error(\"Auto Decline: Invalid Response\");\n  }\n};\nconst CLOSE_EVENT = \"FCL:VIEW:CLOSE\";\nconst READY_EVENT = \"FCL:VIEW:READY\";\nconst RESPONSE_EVENT = \"FCL:VIEW:RESPONSE\";\nconst _ = e => typeof e === \"string\" && e.toLowerCase();\nconst IGNORE = new Set([\"monetizationstart\", \"monetizationpending\", \"monetizationprogress\", \"monetizationstop\"]);\nconst deprecate = (was, want) => console.warn(\"DEPRECATION NOTICE\", \"Received \".concat(was, \", please use \").concat(want, \" for this and future versions of FCL\"));\nconst buildMessageHandler = _ref => {\n  let {\n    close,\n    send,\n    onReady,\n    onResponse,\n    onMessage\n  } = _ref;\n  return e => {\n    try {\n      if (typeof e.data !== \"object\") return;\n      if (IGNORE.has(e.data.type)) return;\n      if (_(e.data.type) === _(CLOSE_EVENT)) close();\n      if (_(e.data.type) === _(READY_EVENT)) onReady(e, {\n        send,\n        close\n      });\n      if (_(e.data.type) === _(RESPONSE_EVENT)) onResponse(e, {\n        send,\n        close\n      });\n      onMessage(e, {\n        send,\n        close\n      });\n\n      // Backwards Compatible\n      if (_(e.data.type) === _(\"FCL:FRAME:READY\")) {\n        deprecate(e.data.type, READY_EVENT);\n        onReady(e, {\n          send,\n          close\n        });\n      }\n      if (_(e.data.type) === _(\"FCL:FRAME:RESPONSE\")) {\n        deprecate(e.data.type, RESPONSE_EVENT);\n        onResponse(e, {\n          send,\n          close\n        });\n      }\n      if (_(e.data.type) === _(\"FCL:FRAME:CLOSE\")) {\n        deprecate(e.data.type, CLOSE_EVENT);\n        close();\n      }\n      //\n      if (_(e.data.type) === _(\"FCL::CHALLENGE::RESPONSE\")) {\n        deprecate(e.data.type, RESPONSE_EVENT);\n        onResponse(e, {\n          send,\n          close\n        });\n      }\n      if (_(e.data.type) === _(\"FCL::AUTHZ_READY\")) {\n        deprecate(e.data.type, READY_EVENT);\n        onReady(e, {\n          send,\n          close\n        });\n      }\n      if (_(e.data.type) === _(\"FCL::CHALLENGE::CANCEL\")) {\n        deprecate(e.data.type, CLOSE_EVENT);\n        close();\n      }\n      if (_(e.data.type) === _(\"FCL::CANCEL\")) {\n        deprecate(e.data.type, CLOSE_EVENT);\n        close();\n      }\n    } catch (error) {\n      console.error(\"Frame Callback Error\", error);\n      close();\n    }\n  };\n};\nconst noop$3 = () => {};\nfunction frame(service) {\n  let opts = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n  if (service == null) return {\n    send: noop$3,\n    close: noop$3\n  };\n  const onClose = opts.onClose || noop$3;\n  const onMessage = opts.onMessage || noop$3;\n  const onReady = opts.onReady || noop$3;\n  const onResponse = opts.onResponse || noop$3;\n  const handler = buildMessageHandler({\n    close,\n    send,\n    onReady,\n    onResponse,\n    onMessage\n  });\n  window.addEventListener(\"message\", handler);\n  const [$frame, unmount] = renderFrame(serviceEndpoint(service));\n  return {\n    send,\n    close\n  };\n  function close() {\n    try {\n      window.removeEventListener(\"message\", handler);\n      unmount();\n      onClose();\n    } catch (error) {\n      console.error(\"Frame Close Error\", error);\n    }\n  }\n  function send(msg) {\n    try {\n      $frame.postMessage(JSON.parse(JSON.stringify(msg || {})), \"*\");\n    } catch (error) {\n      console.error(\"Frame Send Error\", msg, error);\n    }\n  }\n}\nfunction execIframeRPC(_ref) {\n  let {\n    service,\n    body,\n    config,\n    opts\n  } = _ref;\n  return new Promise((resolve, reject) => {\n    const id = uid();\n    const includeOlderJsonRpcCall = opts.includeOlderJsonRpcCall;\n    frame(service, {\n      async onReady(_, _ref2) {\n        let {\n          send\n        } = _ref2;\n        try {\n          send({\n            type: \"FCL:VIEW:READY:RESPONSE\",\n            fclVersion: VERSION,\n            body,\n            service: {\n              params: service.params,\n              data: service.data,\n              type: service.type\n            },\n            config\n          });\n          send({\n            fclVersion: VERSION,\n            type: \"FCL:FRAME:READY:RESPONSE\",\n            body,\n            service: {\n              params: service.params,\n              data: service.data,\n              type: service.type\n            },\n            config,\n            deprecated: {\n              message: \"FCL:FRAME:READY:RESPONSE is deprecated and replaced with type: FCL:VIEW:READY:RESPONSE\"\n            }\n          });\n          if (includeOlderJsonRpcCall) {\n            send({\n              jsonrpc: \"2.0\",\n              id: id,\n              method: \"fcl:sign\",\n              params: [body, service.params],\n              deprecated: {\n                message: \"jsonrpc is deprecated and replaced with type: FCL:VIEW:READY:RESPONSE\"\n              }\n            });\n          }\n        } catch (error) {\n          throw error;\n        }\n      },\n      onResponse(e, _ref3) {\n        let {\n          close\n        } = _ref3;\n        try {\n          if (typeof e.data !== \"object\") return;\n          const resp = normalizePollingResponse(e.data);\n          switch (resp.status) {\n            case \"APPROVED\":\n              resolve(resp.data);\n              close();\n              break;\n            case \"DECLINED\":\n              reject(\"Declined: \".concat(resp.reason || \"No reason supplied\"));\n              close();\n              break;\n            case \"REDIRECT\":\n              resolve(resp);\n              close();\n              break;\n            default:\n              reject(\"Declined: No reason supplied\");\n              close();\n              break;\n          }\n        } catch (error) {\n          console.error(\"execIframeRPC onResponse error\", error);\n          throw error;\n        }\n      },\n      onMessage(e, _ref4) {\n        let {\n          close\n        } = _ref4;\n        try {\n          if (typeof e.data !== \"object\") return;\n          if (e.data.jsonrpc !== \"2.0\") return;\n          if (e.data.id !== id) return;\n          const resp = normalizePollingResponse(e.data.result);\n          switch (resp.status) {\n            case \"APPROVED\":\n              resolve(resp.data);\n              close();\n              break;\n            case \"DECLINED\":\n              reject(\"Declined: \".concat(resp.reason || \"No reason supplied\"));\n              close();\n              break;\n            case \"REDIRECT\":\n              resolve(resp);\n              close();\n              break;\n            default:\n              reject(\"Declined: No reason supplied\");\n              close();\n              break;\n          }\n        } catch (error) {\n          console.error(\"execIframeRPC onMessage error\", error);\n          throw error;\n        }\n      },\n      onClose() {\n        reject(\"Declined: Externally Halted\");\n      }\n    });\n  });\n}\nconst noop$2 = () => {};\nfunction pop(service) {\n  let opts = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n  if (service == null) return {\n    send: noop$2,\n    close: noop$2\n  };\n  const onClose = opts.onClose || noop$2;\n  const onMessage = opts.onMessage || noop$2;\n  const onReady = opts.onReady || noop$2;\n  const onResponse = opts.onResponse || noop$2;\n  const handler = buildMessageHandler({\n    close,\n    send,\n    onReady,\n    onResponse,\n    onMessage\n  });\n  window.addEventListener(\"message\", handler);\n  const [$pop, unmount] = renderPop(serviceEndpoint(service));\n  const timer = setInterval(function () {\n    if ($pop && $pop.closed) {\n      close();\n    }\n  }, 500);\n  return {\n    send,\n    close\n  };\n  function close() {\n    try {\n      window.removeEventListener(\"message\", handler);\n      clearInterval(timer);\n      unmount();\n      onClose();\n    } catch (error) {\n      console.error(\"Popup Close Error\", error);\n    }\n  }\n  function send(msg) {\n    try {\n      $pop.postMessage(JSON.parse(JSON.stringify(msg || {})), \"*\");\n    } catch (error) {\n      console.error(\"Popup Send Error\", msg, error);\n    }\n  }\n}\nfunction execPopRPC(_ref) {\n  let {\n    service,\n    body,\n    config,\n    opts\n  } = _ref;\n  return new Promise((resolve, reject) => {\n    const id = uid();\n    const {\n      redir,\n      includeOlderJsonRpcCall\n    } = opts;\n    pop(service, {\n      async onReady(_, _ref2) {\n        let {\n          send\n        } = _ref2;\n        try {\n          send({\n            fclVersion: VERSION,\n            type: \"FCL:VIEW:READY:RESPONSE\",\n            body,\n            service: {\n              params: service.params,\n              data: service.data,\n              type: service.type\n            },\n            config\n          });\n          send({\n            fclVersion: VERSION,\n            type: \"FCL:FRAME:READY:RESPONSE\",\n            body,\n            service: {\n              params: service.params,\n              data: service.data,\n              type: service.type\n            },\n            config,\n            deprecated: {\n              message: \"FCL:FRAME:READY:RESPONSE is deprecated and replaced with type: FCL:VIEW:READY:RESPONSE\"\n            }\n          });\n          if (includeOlderJsonRpcCall) {\n            send({\n              jsonrpc: \"2.0\",\n              id: id,\n              method: \"fcl:sign\",\n              params: [body, service.params]\n            });\n          }\n        } catch (error) {\n          throw error;\n        }\n      },\n      onResponse(e, _ref3) {\n        let {\n          close\n        } = _ref3;\n        try {\n          if (typeof e.data !== \"object\") return;\n          const resp = normalizePollingResponse(e.data);\n          switch (resp.status) {\n            case \"APPROVED\":\n              resolve(resp.data);\n              !redir && close();\n              break;\n            case \"DECLINED\":\n              reject(\"Declined: \".concat(resp.reason || \"No reason supplied\"));\n              close();\n              break;\n            case \"REDIRECT\":\n              resolve(resp);\n              close();\n              break;\n            default:\n              reject(\"Declined: No reason supplied\");\n              close();\n              break;\n          }\n        } catch (error) {\n          console.error(\"execPopRPC onResponse error\", error);\n          throw error;\n        }\n      },\n      onMessage(e, _ref4) {\n        let {\n          close\n        } = _ref4;\n        try {\n          if (typeof e.data !== \"object\") return;\n          if (e.data.jsonrpc !== \"2.0\") return;\n          if (e.data.id !== id) return;\n          const resp = normalizePollingResponse(e.data.result);\n          switch (resp.status) {\n            case \"APPROVED\":\n              resolve(resp.data);\n              !redir && close();\n              break;\n            case \"DECLINED\":\n              reject(\"Declined: \".concat(resp.reason || \"No reason supplied\"));\n              close();\n              break;\n            case \"REDIRECT\":\n              resolve(resp);\n              close();\n              break;\n            default:\n              reject(\"Declined: No reason supplied\");\n              close();\n              break;\n          }\n        } catch (error) {\n          console.error(\"execPopRPC onMessage error\", error);\n          throw error;\n        }\n      },\n      onClose() {\n        reject(\"Declined: Externally Halted\");\n      }\n    });\n  });\n}\nconst noop$1 = () => {};\nfunction tab(service) {\n  let opts = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n  if (service == null) return {\n    send: noop$1,\n    close: noop$1\n  };\n  const onClose = opts.onClose || noop$1;\n  const onMessage = opts.onMessage || noop$1;\n  const onReady = opts.onReady || noop$1;\n  const onResponse = opts.onResponse || noop$1;\n  const handler = buildMessageHandler({\n    close,\n    send,\n    onReady,\n    onResponse,\n    onMessage\n  });\n  window.addEventListener(\"message\", handler);\n  const [$tab, unmount] = renderTab(serviceEndpoint(service));\n  const timer = setInterval(function () {\n    if ($tab && $tab.closed) {\n      close();\n    }\n  }, 500);\n  return {\n    send,\n    close\n  };\n  function close() {\n    try {\n      window.removeEventListener(\"message\", handler);\n      clearInterval(timer);\n      unmount();\n      onClose();\n    } catch (error) {\n      console.error(\"Tab Close Error\", error);\n    }\n  }\n  function send(msg) {\n    try {\n      $tab.postMessage(JSON.parse(JSON.stringify(msg || {})), \"*\");\n    } catch (error) {\n      console.error(\"Tab Send Error\", msg, error);\n    }\n  }\n}\nfunction execTabRPC(_ref) {\n  let {\n    service,\n    body,\n    config,\n    opts\n  } = _ref;\n  return new Promise((resolve, reject) => {\n    const id = uid();\n    const {\n      redir,\n      includeOlderJsonRpcCall\n    } = opts;\n    tab(service, {\n      async onReady(_, _ref2) {\n        let {\n          send\n        } = _ref2;\n        try {\n          send({\n            fclVersion: VERSION,\n            type: \"FCL:VIEW:READY:RESPONSE\",\n            body,\n            service: {\n              params: service.params,\n              data: service.data,\n              type: service.type\n            },\n            config\n          });\n          send({\n            fclVersion: VERSION,\n            type: \"FCL:FRAME:READY:RESPONSE\",\n            body,\n            service: {\n              params: service.params,\n              data: service.data,\n              type: service.type\n            },\n            config,\n            deprecated: {\n              message: \"FCL:FRAME:READY:RESPONSE is deprecated and replaced with type: FCL:VIEW:READY:RESPONSE\"\n            }\n          });\n          if (includeOlderJsonRpcCall) {\n            send({\n              jsonrpc: \"2.0\",\n              id: id,\n              method: \"fcl:sign\",\n              params: [body, service.params]\n            });\n          }\n        } catch (error) {\n          throw error;\n        }\n      },\n      onResponse(e, _ref3) {\n        let {\n          close\n        } = _ref3;\n        try {\n          if (typeof e.data !== \"object\") return;\n          const resp = normalizePollingResponse(e.data);\n          switch (resp.status) {\n            case \"APPROVED\":\n              resolve(resp.data);\n              !redir && close();\n              break;\n            case \"DECLINED\":\n              reject(\"Declined: \".concat(resp.reason || \"No reason supplied\"));\n              close();\n              break;\n            case \"REDIRECT\":\n              resolve(resp);\n              close();\n              break;\n            default:\n              reject(\"Declined: No reason supplied\");\n              close();\n              break;\n          }\n        } catch (error) {\n          console.error(\"execPopRPC onResponse error\", error);\n          throw error;\n        }\n      },\n      onMessage(e, _ref4) {\n        let {\n          close\n        } = _ref4;\n        try {\n          if (typeof e.data !== \"object\") return;\n          if (e.data.jsonrpc !== \"2.0\") return;\n          if (e.data.id !== id) return;\n          const resp = normalizePollingResponse(e.data.result);\n          switch (resp.status) {\n            case \"APPROVED\":\n              resolve(resp.data);\n              !redir && close();\n              break;\n            case \"DECLINED\":\n              reject(\"Declined: \".concat(resp.reason || \"No reason supplied\"));\n              close();\n              break;\n            case \"REDIRECT\":\n              resolve(resp);\n              close();\n              break;\n            default:\n              reject(\"Declined: No reason supplied\");\n              close();\n              break;\n          }\n        } catch (error) {\n          console.error(\"execPopRPC onMessage error\", error);\n          throw error;\n        }\n      },\n      onClose() {\n        reject(\"Declined: Externally Halted\");\n      }\n    });\n  });\n}\nconst noop = () => {};\nfunction extension(service) {\n  let opts = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n  if (service == null) return {\n    send: noop,\n    close: noop\n  };\n  const onClose = opts.onClose || noop;\n  const onMessage = opts.onMessage || noop;\n  const onReady = opts.onReady || noop;\n  const onResponse = opts.onResponse || noop;\n  const handler = buildMessageHandler({\n    close,\n    send,\n    onReady,\n    onResponse,\n    onMessage\n  });\n  window.addEventListener(\"message\", handler);\n  send({\n    service\n  });\n  return {\n    send,\n    close\n  };\n  function close() {\n    try {\n      window.removeEventListener(\"message\", handler);\n      onClose();\n    } catch (error) {\n      console.error(\"Ext Close Error\", error);\n    }\n  }\n  function send(msg) {\n    try {\n      window && window.postMessage(JSON.parse(JSON.stringify(msg || {})), \"*\");\n    } catch (error) {\n      console.error(\"Ext Send Error\", msg, error);\n    }\n  }\n}\nfunction execExtRPC(_ref) {\n  let {\n    service,\n    body,\n    config,\n    opts\n  } = _ref;\n  return new Promise((resolve, reject) => {\n    extension(service, {\n      async onReady(_, _ref2) {\n        let {\n          send\n        } = _ref2;\n        try {\n          send({\n            fclVersion: VERSION,\n            type: \"FCL:VIEW:READY:RESPONSE\",\n            body,\n            service: {\n              params: service.params,\n              data: service.data,\n              type: service.type\n            },\n            config\n          });\n        } catch (error) {\n          throw error;\n        }\n      },\n      onResponse(e, _ref3) {\n        let {\n          close\n        } = _ref3;\n        try {\n          if (typeof e.data !== \"object\") return;\n          const resp = normalizePollingResponse(e.data);\n          switch (resp.status) {\n            case \"APPROVED\":\n              resolve(resp.data);\n              close();\n              break;\n            case \"DECLINED\":\n              reject(\"Declined: \".concat(resp.reason || \"No reason supplied\"));\n              close();\n              break;\n            case \"REDIRECT\":\n              resolve(resp);\n              close();\n              break;\n            default:\n              reject(\"Declined: No reason supplied\");\n              close();\n              break;\n          }\n        } catch (error) {\n          console.error(\"execExtRPC onResponse error\", error);\n          throw error;\n        }\n      },\n      onClose() {\n        reject(\"Declined: Externally Halted\");\n      }\n    });\n  });\n}\nconst NOT_IMPLEMENTED = () => {\n  throw new Error(\"Strategy util has not been implemented on this platform\");\n};\nconst VIEWS = {\n  \"VIEW/IFRAME\": renderFrame,\n  \"VIEW/POP\": renderPop,\n  \"VIEW/TAB\": renderTab,\n  \"VIEW/MOBILE_BROWSER\": NOT_IMPLEMENTED,\n  \"VIEW/DEEPLINK\": NOT_IMPLEMENTED\n};\nasync function execLocal(service) {\n  let opts = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {\n    serviceEndpoint: () => {}\n  };\n  const {\n    serviceEndpoint\n  } = opts;\n  try {\n    return VIEWS[service.method](serviceEndpoint(service), opts);\n  } catch (error) {\n    console.error(\"execLocal({service, opts = {}})\", error, {\n      service,\n      opts\n    });\n    throw error;\n  }\n}\nconst coreStrategies = {\n  [CORE_STRATEGIES[\"HTTP/RPC\"]]: getExecHttpPost(execLocal),\n  [CORE_STRATEGIES[\"HTTP/POST\"]]: getExecHttpPost(execLocal),\n  [CORE_STRATEGIES[\"IFRAME/RPC\"]]: execIframeRPC,\n  [CORE_STRATEGIES[\"POP/RPC\"]]: execPopRPC,\n  [CORE_STRATEGIES[\"TAB/RPC\"]]: execTabRPC,\n  [CORE_STRATEGIES[\"EXT/RPC\"]]: execExtRPC\n};\nconst mutate = getMutate({\n  platform: \"web\"\n});\nconst currentUser = getCurrentUser({\n  platform: \"web\"\n});\nconst authenticate = function () {\n  let opts = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n  return currentUser().authenticate(opts);\n};\nconst unauthenticate = () => currentUser().unauthenticate();\nconst reauthenticate = function () {\n  let opts = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n  currentUser().unauthenticate();\n  return currentUser().authenticate(opts);\n};\nconst signUp = function () {\n  let opts = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n  return currentUser().authenticate(opts);\n};\nconst logIn = function () {\n  let opts = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n  return currentUser().authenticate(opts);\n};\nconst authz = currentUser().authorization;\nconfig(getDefaultConfig());\ninitServiceRegistry({\n  coreStrategies\n});\nexport { index$1 as AppUtils, index as InteractionTemplateUtils, VERSION, index$2 as WalletUtils, authenticate, authz, currentUser, discovery, events, getChainId, logIn, mutate, pluginRegistry, query, reauthenticate, serialize, signUp, t, transaction as tx, unauthenticate, verifyUserSignatures };","map":{"version":3,"names":["VERSION","is","type","d","isRequired","isObject","isString","isFunc","isNumber","normalizeArgs","ax","sdk","arg","t$1","httpDocumentResolver","_ref","url","invariant","res","fetchTransport","e","Error","document","ok","json","DOCUMENT_RESOLVERS","Map","retrieve","_ref2","documentResolversFromConfig","config","where","Object","keys","map","key","resolverFromConfig","resolverProtocol","replace","set","urlParts","exec","protocol","resolver","get","concat","normalizeInteractionTemplate","template","deriveCadenceByNetwork","_template","network","invariant$1","undefined","f_type","f_version","networkDependencies","data","dependencies","dependencyPlaceholder","_template2","dependencyNetworkContracts","values","length","dependencyContract","dependencyContractForNetwork","address","reduce","cadence","placeholder","regex","RegExp","fetchChainId","opts","arguments","response","send","getNetworkParameters","then","decode","chainId","chainIdCache","hasWarnedEnv","getChainId","flowNetworkCfg","envCfg","log","deprecate","pkg","subject","message","transition","accessNode","node","catch","error","watchForChainIdChanges","subscribe","enableRequestLogging","isAndroid","navigator","test","userAgent","isSmallIOS","isLargeIOS","isIOS","isMobile","deriveDependencies","_template$data","derivedDependencies","dependencyPlaceholderKeys","dependencyPlaceholderKey","_template$data2","dependencyPlaceholderContractsKeys","dependencyPlaceholderContract","dependency","withPrefix","prepTemplateOpts","pre","preMutate","preQuery","query","overload","script","args","limit","FCL_REDIRECT_URL_PARAM_NAME","FCL_RESPONSE_PARAM_NAME","CORE_STRATEGIES","onMessageFromFCL","messageType","cb","buildData","_data$body","deprecated","console","warn","body","interaction","internal","window","addEventListener","removeEventListener","_URL","globalThis","URL","constructor","base","_len","Array","_key","sendMsgToFCL","msg","urlParams","URLSearchParams","location","search","redirectUrl","searchParams","append","JSON","stringify","href","parent","postMessage","opener","ready","close","approve","f_vsn","status","reason","decline","redirect","SERVICE_PRAGMA","IDENTITY_PRAGMA","USER_PRAGMA","POLLING_RESPONSE_PRAGMA","COMPOSITE_SIGNATURE_PRAGMA","CompositeSignature","addr","keyId","signature","Number","rightPaddedHexBuffer","value","pad","Buffer","from","padEnd","leftPaddedHexBuffer","padStart","addressBuffer","nonceBuffer","nonce","encodeAccountProof","appIdentifier","includeDomainTag","ACCOUNT_PROOF_DOMAIN_TAG","toString","encode","sansPrefix","injectExtService","service","endpoint","isArray","fcl_extensions","push","ACCOUNT_PROOF","USER_SIGNATURE","validateArgs","signatures","every","sig","i","arr","cs","compSigs","getVerifySignaturesScript","verifyFunction","fclCryptoContract","verifyAccountProof","signaturesArr","keyIndices","el","t","Address","String","Int","verifyUserSignatures$1","verifyUserSignatures","callback","serialize","resolveFunction","config$1","first","resolve","pipe","createSignableVoucher","configLens","fromEntries","entries","RATE$1","POLL","fetchTxStatus","transactionId","getTransactionStatus","isExpired","tx","isSealed","isExecuted","isFinalized","isPending","isUnknown","isDiff","cur","next","HANDLERS$3","INIT","ctx","sendSelf","SUBSCRIBE","letter","UPDATED$2","all","UNSUBSCRIBE","unsubscribe","SNAPSHOT$1","reply","self","fatalError","setTimeout","broadcast","merge","scoped","spawnTransaction","spawn","transaction","snapshot","snapshoter","subscriber","once","predicate","innerOnce","suppress","Promise","reject","unsub","txStatus","statusCode","errorMessage","onceFinalized","onceExecuted","onceSealed","RATE","UPDATED$1","TICK","HIGH_WATER_MARK","scheduleTick","HANDLERS$2","hasSubs","hwm","put","block","height","getEventsAtBlockHeightRange","clearTimeout","delete","spawnEvents","events","stub","stubCoreStrategies","supportedPlugins","supportedServicePlugins","validateDiscoveryPlugin","servicePlugin","services","serviceStrategy","ds","method","discoveryServices","ServiceRegistry","coreStrategies","Set","strategies","add","includes","setServices","has","title","level","LEVELS","getServices","getStrategy","getStrategies","freeze","validatePlugins","plugins","pluginsArray","p","name","PluginRegistry","pluginsMap","getPlugins","serviceRegistry","getIsServiceRegistryInitialized","initServiceRegistry","_serviceRegistry","getServiceRegistry","pluginRegistry","makeDiscoveryServices","_window","extensionServices","getDiscoveryService","_service$endpoint","discoveryAuthnInclude","discoveryFeaturesSuggested","discoveryWalletMethod","_window2","types","Boolean","include","fetch","headers","fclVersion","features","suggested","clientServices","supportedStrategies","SERVICE_ACTOR_KEYS","AUTHN","RESULTS","SNAPSHOT","UPDATED","UPDATE_RESULTS","fact","fetchServicesFromDiscovery","send$1","results","HANDLERS$1","readyState","onload","_letter","spawnProviders","authn","update","discovery","copy","I","O","o","oi","ii","copy_1","defineProperty","exports","_copy","_interopRequireDefault","obj","__esModule","chi","A","C","y","x","_x","xy","x1","x2","_default","ROUND_CONSTANTS","Uint32Array","_roundConstants","roundConstants","iota","roundIndex","PI_SHUFFLES","RHO_OFFSETS","_piShuffles","piShuffles","_rhoOffsets","rhoOffsets","rhoPi","W","H","L","Wi","ri","j","r","theta","D","x20","x21","x22","x23","x24","_chi","_iota","_rhoPi","_theta","permute","fill","_buffer","require$$0","_permute","xorWords","readWords","Sponge","_this","capacity","padding","keccak","stateSize","blockSize","queueSize","queueOffset","state","queue","allocUnsafe","absorb","buffer","squeeze","options","output","offset","slice","reset","SHAKE","SHA3Hash","SHA3","Keccak","_sponge","sponge","createHash","allowedSizes","defaultSize","Hash","size","input","encoding","isBuffer","TypeError","digest","formatOrOptions","format","genHash","utf8String","sha","sha3","generateTemplateId","templateData","messages","messageKey","_templateData$message","i18n","i18nkeylanguage","_templateData$message2","dependencyAddressPlaceholder","_templateData$depende","_templateData$depende2","dependencyContractNetwork","_templateData$depende3","_templateData$depende4","_templateData$depende5","_templateData$depende6","_templateData$depende7","contract","fq_address","pin","pin_block_height","_arguments","argumentLabel","_templateData$argumen","_templateData$argumen2","_templateData$argumen3","_templateData$argumen4","index","balance","argumentMessageKey","_templateData$argumen5","_templateData$argumen6","encodedHex","interface","getInteractionTemplateAudits","auditors","recomputedTemplateID","id","debug","_auditors","FlowInteractionAuditContract","flowInteractionAuditContract","fclNetwork","audits","generateImport","contractName","findImports","imports","importsReg","fileImports","match","fileImport","importLineReg","importLine","contractsReg","contracts","generateDependencyPin","blockHeight","horizon","horizonImport","_account$contracts","account","getAccount","atBlockHeight","contractImports","contractHashes","iport","contractHashesJoined","join","generateDependencyPinAtLatestSealedBlock","latestSealedBlock","sealed","latestSealedBlockHeight","normalizeInteractionTemplateInterface","templateInterface","generateTemplateInterfaceId","interfaceData","flip","verifyDependencyPinsSame","templateDependenciesPlaceholderKeys","templateDependencyPlaceholderKey","templateDependencyPlaceholder","templateDependencyPlaceholderContractNames","templateDependencyPlaceholderContractName","templateDependencyPlaceholderContractNetworks","templateDependency","verifyDependencyPinsSameAtLatestSealedBlock","getTemplateMessage","_template$data3","_messages$messageKey","localization","getTemplateArgumentMessage","_template$data4","_args$argumentLabel","fetchServices","servicesURL","code","resp","authorizations","provider","mergeServices","sx1","sx2","normalizeAuthn","uid","pid","icon","normalizeAuthz","identity","params","normalizePreAuthz","normalizeFrame","old","normalizeBackChannelRpc","normalizeOpenId","normalizeUserSignature","normalizeLocalView","normalizeAccountProof","normalizeAuthnRefresh","normalizeServices","normalizeService","filter","serviceNormalizers","authz","frame","normalized","serviceOfType","mostRecent","semver","compare","deriveCompositeId","rlp","normalizeData","paddr","buildUser","hks","cid","loggedIn","expiresAt","expires","execStrategy","strategy","execService","_window$location$host","_window3","platform","execConfig","app","client","fclLibrary","hostname","normalizeCompositeSignature","isFn","NAME","SET_CURRENT_USER","DEL_CURRENT_USER","DATA","getStoredUser","storage","fallback","parse","stored","removeItem","HANDLERS","can","user","notExpired","spawnCurrentUser","Date","now","getAccountProofData","accountProofDataResolver","accountProofData","makeConfig","getAuthenticate","_service$provider","_service$provider2","redir","is_installed","requires_install","_service$provider3","install_link","discoveryService","refreshService","unauthenticate$1","normalizePreAuthzResponse","proposer","payer","authorization","getResolvePreAuthz","_ref3","axs","az","result","_ref4","role","tempId","signingFunction","signable","authorizer","getAuthorization","_ref5","preSignable","preAuthz","windowRef","open","sequenceNum","includeOlderJsonRpcCall","EXIT","receive","tag","expectReply","timeout","getResolveArgument","_ref6","makeSignable","getSignUserMessage","_ref7","signingService","getCurrentUser","_ref8","currentUser","authenticate","signUserMessage","resolveArgument","unauthenticate","getMutate","mutate","txid","FRAME","FRAME_STYLES","renderFrame","src","getElementById","$frame","createElement","allow","frameBorder","style","cssText","unmount","remove","contentWindow","POP","popup","previousUrl$1","popupWindow","windowName","win","w","h","top","outerHeight","screenY","outerWidth","screenX","renderPop","_popup","closed","focus","tab$1","previousUrl","renderTab","_tab$","isServerSide","getSessionStorage","SESSION_STORAGE","sessionStorage","getItem","setItem","getDefaultConfig","serviceEndpoint","_window4","origin","fetchService","normalizePollingResponse","_resp$status","_resp$reason","compositeSignature","updates","authorizationUpdates","local","OPTIONS","serviceMethod","poll","checkCanContinue","canContinue","visibilityState","getExecHttpPost","execLocal","shouldContinue","_","onClose","offsetCanContinue","serviceResponse","CLOSE_EVENT","READY_EVENT","RESPONSE_EVENT","toLowerCase","IGNORE","was","want","buildMessageHandler","onReady","onResponse","onMessage","noop$3","handler","execIframeRPC","jsonrpc","noop$2","pop","$pop","timer","setInterval","clearInterval","execPopRPC","noop$1","tab","$tab","execTabRPC","noop","extension","execExtRPC","NOT_IMPLEMENTED","VIEWS","reauthenticate","signUp","logIn"],"sources":["../src/VERSION.js","../src/utils/is.js","../src/exec/utils/normalize-args.js","../src/document/document.js","../src/normalizers/interaction-template/interaction-template.js","../src/interaction-template-utils/derive-cadence-by-network.js","../src/utils/chain-id/fetch-chain-id.js","../src/utils/chain-id/get-chain-id.js","../src/utils/chain-id/chain-id-watcher.js","../src/utils/index.js","../src/exec/utils/derive-dependencies.js","../src/exec/utils/prep-template-opts.js","../src/exec/utils/pre.js","../src/exec/query.js","../src/utils/constants.js","../src/wallet-utils/on-message-from-fcl.js","../src/utils/url.js","../src/wallet-utils/send-msg-to-fcl.js","../src/normalizers/service/__vsn.js","../src/wallet-utils/CompositeSignature.js","../src/wallet-utils/encode-account-proof.js","../src/wallet-utils/inject-ext-service.js","../src/app-utils/verify-signatures.js","../src/exec/verify.js","../src/serialize/index.js","../src/default-config.js","../src/transaction/index.js","../src/events/index.js","../src/current-user/exec-service/plugins.js","../src/discovery/utils.js","../src/discovery/services.js","../src/discovery/services/authn.js","../src/discovery/index.js","../../../node_modules/sha3/sponge/permute/copy/index.js","../../../node_modules/sha3/sponge/permute/chi/index.js","../../../node_modules/sha3/sponge/permute/iota/round-constants/index.js","../../../node_modules/sha3/sponge/permute/iota/index.js","../../../node_modules/sha3/sponge/permute/rho-pi/pi-shuffles/index.js","../../../node_modules/sha3/sponge/permute/rho-pi/rho-offsets/index.js","../../../node_modules/sha3/sponge/permute/rho-pi/index.js","../../../node_modules/sha3/sponge/permute/theta/index.js","../../../node_modules/sha3/sponge/permute/index.js","../../../node_modules/sha3/sponge/index.js","../../../node_modules/sha3/index.js","../src/interaction-template-utils/utils/hash.js","../src/interaction-template-utils/generate-template-id.js","../src/interaction-template-utils/get-interaction-template-audits.js","../src/interaction-template-utils/utils/generate-import.js","../src/interaction-template-utils/utils/find-imports.js","../src/interaction-template-utils/generate-dependency-pin.js","../src/normalizers/interaction-template/interaction-template-interface.js","../src/interaction-template-utils/generate-template-interface-id.js","../src/interaction-template-utils/verify-dependency-pin-same-at-block.js","../src/interaction-template-utils/get-template-message.js","../src/interaction-template-utils/get-template-argument-message.js","../src/shared-exports.js","../src/current-user/fetch-services.js","../src/current-user/merge-services.js","../src/normalizers/service/authn.js","../src/normalizers/service/authz.js","../src/normalizers/service/pre-authz.js","../src/normalizers/service/frame.js","../src/normalizers/service/back-channel-rpc.js","../src/normalizers/service/open-id.js","../src/normalizers/service/user-signature.js","../src/normalizers/service/local-view.js","../src/normalizers/service/account-proof.js","../src/normalizers/service/authn-refresh.js","../src/normalizers/service/service.js","../src/current-user/service-of-type.js","../src/current-user/build-user.js","../src/current-user/exec-service/index.js","../src/normalizers/service/composite-signature.js","../src/current-user/index.js","../src/exec/mutate.js","../src/utils/web/render-frame.js","../src/utils/web/render-pop.js","../src/utils/web/render-tab.js","../src/utils/web/default-config.js","../src/current-user/exec-service/strategies/utils/service-endpoint.js","../src/current-user/exec-service/strategies/utils/fetch-service.js","../src/normalizers/service/polling-response.js","../src/current-user/exec-service/strategies/utils/poll.js","../src/current-user/exec-service/strategies/http-post.js","../src/current-user/exec-service/strategies/utils/buildMessageHandler.js","../src/utils/web/strategies/utils/frame.js","../src/utils/web/strategies/iframe-rpc.js","../src/utils/web/strategies/utils/pop.js","../src/utils/web/strategies/pop-rpc.js","../src/utils/web/strategies/utils/tab.js","../src/utils/web/strategies/tab-rpc.js","../src/utils/web/strategies/utils/extension.js","../src/utils/web/strategies/ext-rpc.js","../src/utils/web/exec-local.js","../src/utils/web/coreStrategies.js","../src/fcl.js"],"sourcesContent":["export const VERSION = PACKAGE_CURRENT_VERSION || \"TESTVERSION\"\n","const is = type => d => typeof d === type\n\nexport const isRequired = d => d != null\nexport const isObject = is(\"object\")\nexport const isString = is(\"string\")\nexport const isFunc = is(\"function\")\nexport const isNumber = is(\"number\")\n","import {isFunc} from \"../../utils/is\"\nimport * as sdk from \"@onflow/sdk\"\nimport * as t from \"@onflow/types\"\n\nexport function normalizeArgs(ax) {\n  if (isFunc(ax)) return ax(sdk.arg, t)\n  return []\n}\n","import {invariant} from \"@onflow/util-invariant\"\nimport fetchTransport from \"cross-fetch\"\nimport {config} from \"@onflow/config\"\n\nasync function httpDocumentResolver({url}) {\n  invariant(\n    typeof url !== \"undefined\",\n    \"retrieve({ url }) -- url must be defined\"\n  )\n\n  let res\n  try {\n    res = await fetchTransport(url)\n  } catch (e) {\n    throw new Error(\"httpDocumentResolver Error: Failed to retrieve document.\")\n  }\n\n  let document = res.ok ? await res.json() : null\n\n  return document\n}\n\nconst DOCUMENT_RESOLVERS = new Map([\n  [\"http\", httpDocumentResolver],\n  [\"https\", httpDocumentResolver],\n])\n\nexport async function retrieve({url}) {\n  invariant(\n    typeof url !== \"undefined\",\n    \"retrieve({ url }) -- url must be defined\"\n  )\n  invariant(\n    typeof url === \"string\",\n    \"retrieve({ url }) -- url must be a string\"\n  )\n\n  const documentResolversFromConfig = await config().where(\n    /^document\\.resolver\\./\n  )\n  Object.keys(documentResolversFromConfig).map(key => {\n    const resolverFromConfig = documentResolversFromConfig[key]\n    const resolverProtocol = key.replace(/^document\\.resolver\\./, \"\")\n    DOCUMENT_RESOLVERS.set(resolverProtocol, resolverFromConfig)\n  })\n\n  const urlParts = /^(.*):\\/\\/([A-Za-z0-9\\-\\.]+)(:[0-9]+)?(.*)$/.exec(url)\n  invariant(urlParts, \"Failed to parse URL\")\n  const protocol = urlParts[1]\n  invariant(urlParts, \"Failed to parse URL protocol\")\n\n  const resolver = DOCUMENT_RESOLVERS.get(protocol)\n  invariant(resolver, `No resolver found for protcol=${protocol}`)\n\n  let document = await resolver({url})\n\n  return document\n}\n","export function normalizeInteractionTemplate(template) {\n  if (template == null) return null\n\n  switch (template[\"f_version\"]) {\n    case \"1.0.0\":\n      return template\n\n    default:\n      throw new Error(\n        \"normalizeInteractionTemplate Error: Invalid InteractionTemplate\"\n      )\n  }\n}\n","import {invariant} from \"@onflow/sdk\"\nimport {normalizeInteractionTemplate} from \"../normalizers/interaction-template/interaction-template\"\n\n/**\n * @description Fills import addresses in Cadence for network\n * \n * @param {object} params\n * @param {string} params.network - Network to derive Cadence for\n * @param {object} params.template - Interaction Template to derive Cadence from\n * @returns {string} - Cadence\n */\nexport function deriveCadenceByNetwork({network, template}) {\n  invariant(\n    network != undefined,\n    \"deriveCadenceByNetwork({ network }) -- network must be defined\"\n  )\n  invariant(\n    typeof network === \"string\",\n    \"deriveCadenceByNetwork({ network }) -- network must be a string\"\n  )\n\n  invariant(\n    template != undefined,\n    \"generateDependencyPin({ template }) -- template must be defined\"\n  )\n  invariant(\n    typeof template === \"object\",\n    \"generateDependencyPin({ template }) -- template must be an object\"\n  )\n  invariant(\n    template.f_type === \"InteractionTemplate\",\n    \"generateDependencyPin({ template }) -- template must be an InteractionTemplate\"\n  )\n\n  template = normalizeInteractionTemplate(template)\n\n  switch (template.f_version) {\n    case \"1.0.0\":\n      let networkDependencies = Object.keys(template?.data?.dependencies).map(\n        dependencyPlaceholder => {\n          let dependencyNetworkContracts = Object.values(\n            template?.data?.dependencies?.[dependencyPlaceholder]\n          )\n\n          invariant(\n            dependencyNetworkContracts,\n            `deriveCadenceByNetwork -- Could not find contracts for dependency placeholder: ${dependencyPlaceholder}`\n          )\n\n          invariant(\n            dependencyNetworkContracts.length === 0,\n            `deriveCadenceByNetwork -- Could not find contracts for dependency placeholder: ${dependencyPlaceholder}`\n          )\n\n          let dependencyContract = dependencyNetworkContracts[0]\n          let dependencyContractForNetwork = dependencyContract?.[network]\n\n          invariant(\n            dependencyContractForNetwork,\n            `deriveCadenceByNetwork -- Could not find ${network} network information for dependency: ${dependencyPlaceholder}`\n          )\n\n          return [dependencyPlaceholder, dependencyContractForNetwork.address]\n        }\n      )\n\n      return networkDependencies.reduce((cadence, [placeholder, address]) => {\n        const regex = new RegExp(\"(\\\\b\" + placeholder + \"\\\\b)\", \"g\")\n        return cadence.replace(regex, address)\n      }, template.data.cadence)\n\n    default:\n      throw new Error(\n        \"deriveCadenceByNetwork Error: Unsupported template version\"\n      )\n  }\n}\n","import * as sdk from \"@onflow/sdk\"\n\nexport async function fetchChainId(opts = {}) {\n  const response = await sdk\n    .send([sdk.getNetworkParameters()], opts)\n    .then(sdk.decode)\n  return response.chainId\n}\n","import {config} from \"@onflow/config\"\nimport {fetchChainId} from \"./fetch-chain-id\"\nimport {log} from \"@onflow/util-logger\"\n\n// Cache of chainId promises for each access node value\n// key: access node, value: chainId promise\nlet chainIdCache = {}\n\nlet hasWarnedFlowNetwork = false\nlet hasWarnedEnv = false\n\n/**\n * @description\n * Gets the chain ID if its set, otherwise gets the chain ID from the access node\n *\n * @param {object} opts - Optional parameters\n * @returns {Promise<string>} The chain ID of the access node\n * @throws {Error} If the chain ID is not found\n *\n * @example\n * // returns \"testnet\"\n * getChainId()\n */\nexport async function getChainId(opts = {}) {\n  let flowNetworkCfg = await config.get(\"flow.network\")\n  let envCfg = await config.get(\"env\")\n\n  /* \n    TODO: Add deprecation warning for flow.network config key\n    Remove this if statement when deprecation is complete\n\n    config.load() depends on flow.network config key even though this deprecation\n    warning has been available since https://github.com/onflow/fcl-js/pull/1420\n    it has effectively never been shown because of an issue in the implementation\n    of getChainId()\n\n    Showing this warning is the correct and intended behavior, but it would lead to\n    mixed messaging for users since config.load() depends on flow.network config key\n\n    We need to remove the dependency on flow.network config key from config.load()\n    before we can show this warning.\n  */\n  if (false && flowNetworkCfg && !hasWarnedFlowNetwork) {\n    log.deprecate({\n      pkg: \"FCL\",\n      subject:\n        'Using the \"flow.network\" configuration key for specifying the flow network',\n      message: \"Configuring flow.network is no longer required\",\n      transition:\n        \"https://github.com/onflow/flow-js-sdk/blob/master/packages/fcl/TRANSITIONS.md#0002-deprecate-flow.network-config-key\",\n    })\n    hasWarnedFlowNetwork = true\n  }\n\n  if (envCfg && !hasWarnedEnv) {\n    log.deprecate({\n      pkg: \"FCL\",\n      subject:\n        'Using the \"env\" configuration key for specifying the flow network',\n      message: \"Configuring to specify flow network is no longer required\",\n      transition:\n        \"https://github.com/onflow/flow-js-sdk/blob/master/packages/fcl/TRANSITIONS.md#0001-deprecate-env-config-key\",\n    })\n    hasWarnedEnv = true\n  }\n\n  const accessNode = opts.node || (await config.get(\"accessNode.api\"))\n  if (!accessNode) {\n    // Fall back to deprecated flow.network and env config keys\n    // This probably should have been done before trying to fetch the chainId from the access node\n    // However, this was the behaviour with the initial implementation of getChainId()\n    if (flowNetworkCfg) {\n      return flowNetworkCfg\n    } else if (envCfg) {\n      return envCfg\n    }\n\n    throw new Error(\n      `Either the \"accessNode.api\" config key or opts.node must be set`\n    )\n  }\n\n  // Try using cached chainId first if it exists and access node is the same\n  if (chainIdCache[accessNode]) {\n    try {\n      return await chainIdCache[accessNode]\n    } catch {}\n  }\n\n  // If no cached chainId, value is stale, or last attempt failed, try getting chainId from access node\n  // Check if another getChainId() call has already started a new promise, if not, start a new one\n  // There may have been concurrent calls to getChainId() while the first call was waiting for the response\n  if (!chainIdCache[accessNode]) {\n    chainIdCache[accessNode] = fetchChainId(opts).catch(error => {\n      // If there was an error, reset the promise so that the next call will try again\n      chainIdCache[accessNode] = null\n      throw error\n    })\n  }\n\n  // Use newly created promise\n  try {\n    return await chainIdCache[accessNode]\n  } catch (e) {\n    // Fall back to deprecated flow.network and env config keys\n    // This probably should have been done before trying to fetch the chainId from the access node\n    // However, this was the behaviour with the initial implementation of getChainId()\n    if (flowNetworkCfg) {\n      return flowNetworkCfg\n    } else if (envCfg) {\n      return envCfg\n    }\n\n    throw new Error(\n      `Error getting chainId from access node - are you using the correct access node endpoint.  If running locally, is your emulator up-to-date? ${e.message}`\n    )\n  }\n}\n\n/**\n * @description\n * Clears the chainId cache, useful for testing\n */\nexport function clearChainIdCache() {\n  chainIdCache = {}\n}\n","import {config} from \"@onflow/config\"\nimport {getChainId} from \"./get-chain-id\"\n\n/**\n * @description\n * Watches the config for changes to access node and updates the chain id accordingly\n *\n * @returns {Function} A function that unsubscribes the listener\n *\n */\nexport function watchForChainIdChanges() {\n  return config.subscribe(() => {\n    // Call getChainId to update the chainId cache if access node has changed\n    getChainId({\n      enableRequestLogging: false,\n    }).catch(() => {})\n  })\n}\n","export {getChainId} from \"./chain-id/get-chain-id\"\nexport {watchForChainIdChanges} from \"./chain-id/chain-id-watcher\"\n\nexport function isAndroid() {\n  return (\n    typeof navigator !== \"undefined\" && /android/i.test(navigator.userAgent)\n  )\n}\n\nexport function isSmallIOS() {\n  return (\n    typeof navigator !== \"undefined\" && /iPhone|iPod/.test(navigator.userAgent)\n  )\n}\n\nexport function isLargeIOS() {\n  return typeof navigator !== \"undefined\" && /iPad/.test(navigator.userAgent)\n}\n\nexport function isIOS() {\n  return isSmallIOS() || isLargeIOS()\n}\n\nexport function isMobile() {\n  return isAndroid() || isIOS()\n}\n","import {invariant} from \"@onflow/util-invariant\"\nimport {withPrefix} from \"@onflow/util-address\"\nimport {getChainId} from \"../../utils\"\n\nexport async function deriveDependencies(opts = {}) {\n  const template = opts.template\n  const network = await getChainId(opts)\n\n  const derivedDependencies = {}\n\n  switch (template[\"f_version\"]) {\n    case \"1.0.0\":\n      const dependencyPlaceholderKeys = Object.keys(\n        template?.data?.dependencies\n      )\n      for (let dependencyPlaceholderKey of dependencyPlaceholderKeys) {\n        let dependencyPlaceholder =\n          template?.data?.dependencies[dependencyPlaceholderKey]\n\n        const dependencyPlaceholderContractsKeys = Object.keys(\n          dependencyPlaceholder\n        )\n        invariant(\n          dependencyPlaceholderContractsKeys.length > 0,\n          `FCL configureDependencies Error: No contracts found in template for placeholder=${dependencyPlaceholderKey}`\n        )\n        const dependencyPlaceholderContract =\n          dependencyPlaceholder[dependencyPlaceholderContractsKeys[0]]\n        const dependency = dependencyPlaceholderContract[network]\n\n        invariant(\n          dependency,\n          `FCL configureDependencies Error: No dependency information for placeholder=${dependencyPlaceholderKey} contract=${dependencyPlaceholderContractsKeys[0]} network=${network}`\n        )\n        invariant(\n          dependency?.address,\n          `FCL configureDependencies Error: No address information for placeholder=${dependencyPlaceholderKey} contract=${dependencyPlaceholderContractsKeys[0]} network=${network}`\n        )\n\n        derivedDependencies[dependencyPlaceholderKey] = withPrefix(\n          dependency?.address\n        )\n      }\n\n      return derivedDependencies\n\n    default:\n      throw new Error(\n        \"FCL configureDependencies Error: Unsupported template version\"\n      )\n  }\n}\n","import {retrieve} from \"../../document/document.js\"\nimport {normalizeInteractionTemplate} from \"../../normalizers/interaction-template/interaction-template\"\nimport {deriveCadenceByNetwork} from \"../../interaction-template-utils/derive-cadence-by-network.js\"\nimport {deriveDependencies} from \"./derive-dependencies\"\nimport {isString} from \"../../utils/is\"\nimport {getChainId} from \"../../utils\"\n\nexport async function prepTemplateOpts(opts) {\n  if (isString(opts?.template)) {\n    opts.template = await retrieve({url: opts?.template})\n  }\n\n  let dependencies = {}\n  if (opts?.template) {\n    opts.template = normalizeInteractionTemplate(opts?.template)\n    dependencies = await deriveDependencies({template: opts.template})\n  }\n\n  const cadence =\n    opts.cadence ||\n    deriveCadenceByNetwork({\n      template: opts.template,\n      network: await getChainId(opts),\n    })\n\n  opts.cadence = cadence\n  opts.dependencies = dependencies\n\n  return opts\n}\n","import {invariant} from \"@onflow/util-invariant\"\nimport * as sdk from \"@onflow/sdk\"\nimport {isRequired, isObject, isString} from \"../../utils/is\"\n\nasync function pre(type, opts) {\n  // prettier-ignore\n  invariant(isRequired(opts), `${type}(opts) -- opts is required`)\n  // prettier-ignore\n  invariant(isObject(opts), `${type}(opts) -- opts must be an object`)\n  // prettier-ignore\n  invariant(!(opts.cadence && opts.template), `${type}({ template, cadence }) -- cannot pass both cadence and template`)\n  // prettier-ignore\n  invariant(isRequired(opts.cadence || opts?.template), `${type}({ cadence }) -- cadence is required`)\n  // // prettier-ignore\n  invariant(\n    isString(opts.cadence) || opts?.template,\n    `${type}({ cadence }) -- cadence must be a string`\n  )\n  // prettier-ignore\n  invariant(\n    await sdk.config().get(\"accessNode.api\"),\n    `${type}(opts) -- Required value for \"accessNode.api\" not defined in config. See: ${\"https://github.com/onflow/flow-js-sdk/blob/master/packages/fcl/src/exec/query.md#configuration\"}`\n  )\n}\n\nexport async function preMutate(opts) {\n  return pre(\"mutate\", opts)\n}\n\nexport async function preQuery(opts) {\n  return pre(\"query\", opts)\n}\n","import * as sdk from \"@onflow/sdk\"\nimport {normalizeArgs} from \"./utils/normalize-args\"\nimport {prepTemplateOpts} from \"./utils/prep-template-opts.js\"\nimport {preQuery} from \"./utils/pre.js\"\n\n/**\n * @description\n * Allows you to submit scripts to query the blockchain.\n *\n *  @param {object} opts - Query Options and configuration\n *  @param {string} opts.cadence - Cadence Script used to query Flow\n *  @param {import(\"../fcl\").ArgsFn} [opts.args] - Arguments passed to cadence script\n *  @param {object} [opts.template] - Interaction Template for a script\n *  @param {number} [opts.limit]   - Compute Limit for Query\n *  @returns {Promise}\n *\n *  @example\n *    const cadence = `\n *      cadence: `\n *        pub fun main(a: Int, b: Int, c: Address): Int {\n *          log(c)\n *          return a + b\n *        }\n *    `.trim()\n *\n *    const args = (arg, t) => [\n *      arg(5, t.Int),\n *      arg(7, t.Int),\n *      arg(\"0xb2db43ad6bc345fec9\", t.Address),\n *    ]\n *\n *    await query({ cadence, args })\n */\nexport async function query(opts = {}) {\n  await preQuery(opts)\n  opts = await prepTemplateOpts(opts)\n\n  return sdk.config().overload(opts.dependencies || {}, async () =>\n    // prettier-ignore\n    sdk.send([\n      sdk.script(opts.cadence),\n      sdk.args(normalizeArgs(opts.args || [])),\n      opts.limit && typeof opts.limit === \"number\" && sdk.limit(opts.limit)\n    ]).then(sdk.decode)\n  )\n}\n","export const FCL_REDIRECT_URL_PARAM_NAME = 'fcl_redirect_url'\nexport const FCL_RESPONSE_PARAM_NAME = 'fclResponseJson'\n\nexport const CORE_STRATEGIES = {\n  \"HTTP/RPC\": \"HTTP/RPC\",\n  \"HTTP/POST\": \"HTTP/POST\",\n  \"IFRAME/RPC\": \"IFRAME/RPC\",\n  \"POP/RPC\": \"POP/RPC\",\n  \"TAB/RPC\": \"TAB/RPC\",\n  \"EXT/RPC\": \"EXT/RPC\",\n  \"DEEPLINK/RPC\": \"DEEPLINK/RPC\"\n}\n","/**\n * @description\n * Listens for messages from FCL\n * \n * @param {string} messageType - Message type\n * @param {Function} cb - Callback function\n * @returns {Function} - Function to remove event listener\n */\nexport const onMessageFromFCL = (messageType, cb = () => {}) => {\n  const buildData = data => {\n    if (data.deprecated)\n      console.warn(\"DEPRECATION NOTICE\", data.deprecated.message)\n    delete data?.body?.interaction\n\n    return data\n  }\n\n  const internal = e => {\n    const {data} = e\n    if (typeof data !== \"object\") return\n    if (typeof data == null) return\n    if (data.type !== messageType) return\n\n    cb(buildData(data))\n  }\n\n  window.addEventListener(\"message\", internal)\n  return () => window.removeEventListener(\"message\", internal)\n}\n","// This is a workaround for an ongoing issue with URL in React Native\n// It does not parse the URL correctly and appends trailing slashes\n// See: https://github.com/facebook/react-native/issues/24428\n// See: https://github.com/facebook/react-native/issues/24428\n\n// The React Native team is aware of this issue but does not plan to fix it\n// since it could break existing apps, even though this is out of spec\n// See whatwg implementation: https://github.com/jsdom/whatwg-url/blob/master/lib/URL-impl.js#L6-L34\n// See react-native implementation: https://github.com/facebook/react-native/blob/main/packages/react-native/Libraries/Blob/URL.js#L144-L146\n\n// This is not polyfilled globally because it could break other libraries or the user's code\nimport {isReactNative} from \"./is-react-native\"\n\nconst _URL = globalThis.URL\nexport class URL extends _URL {\n  constructor(url, base, ...args) {\n    super(url, base, ...args)\n\n    // Extra check if in React Native\n    if (!isReactNative()) {\n      return\n    }\n\n    // Fix trailing slash issue\n    if (this._url && !url.endsWith(\"/\") && this._url.endsWith(\"/\")) {\n      this._url = this._url.slice(0, -1)\n    }\n  }\n}\n","import {\n  FCL_REDIRECT_URL_PARAM_NAME,\n  FCL_RESPONSE_PARAM_NAME,\n} from \"../utils/constants\"\nimport {onMessageFromFCL} from \"./on-message-from-fcl\"\nimport {URL} from \"../utils/url\"\n\n/**\n * @description\n * Sends message to FCL window\n *\n * @param {string} type - Message type\n * @param {object} msg - Message object\n * @returns {void}\n *\n * @example\n * sendMsgToFCL(\"FCL:VIEW:RESPONSE\", {\n *    f_type: \"PollingResponse\",\n *    f_vsn: \"1.0.0\",\n *    status: \"APPROVED\",\n *    reason: null,\n *    data: data,\n *  })\n */\nexport const sendMsgToFCL = (type, msg = {}) => {\n  const data = {...msg, type}\n\n  const urlParams = new URLSearchParams(window.location.search)\n  const redirectUrl = urlParams.get(FCL_REDIRECT_URL_PARAM_NAME)\n  if (redirectUrl) {\n    const url = new URL(redirectUrl)\n    url.searchParams.append(FCL_RESPONSE_PARAM_NAME, JSON.stringify(data))\n    window.location.href = url.href\n  } else if (window.location !== window.parent.location) {\n    window.parent.postMessage({...msg, type}, \"*\")\n  } else if (window.opener) {\n    window.opener.postMessage({...msg, type}, \"*\")\n  } else {\n    throw new Error(\"Unable to communicate with parent FCL instance\")\n  }\n}\n\n/**\n * @description\n * Listens for \"FCL:VIEW:READY:RESPONSE\" and sends \"FCL:VIEW:READY\"\n *\n * @param {Function} cb - Callback function\n * @param {object} msg - Message object\n * @returns {void}\n */\nexport const ready = (cb, msg = {}) => {\n  onMessageFromFCL(\"FCL:VIEW:READY:RESPONSE\", cb)\n  sendMsgToFCL(\"FCL:VIEW:READY\")\n}\n\n/**\n * @description\n * Sends \"FCL:VIEW:CLOSE\"\n *\n * @returns {void}\n */\nexport const close = () => {\n  sendMsgToFCL(\"FCL:VIEW:CLOSE\")\n}\n\n/**\n * @description\n * Sends \"FCL:VIEW:RESPONSE\" with status \"APPROVED\"\n *\n * @param {object} data - Data object\n * @returns {void}\n */\nexport const approve = data => {\n  sendMsgToFCL(\"FCL:VIEW:RESPONSE\", {\n    f_type: \"PollingResponse\",\n    f_vsn: \"1.0.0\",\n    status: \"APPROVED\",\n    reason: null,\n    data: data,\n  })\n}\n\n/**\n * @description\n * Sends \"FCL:VIEW:RESPONSE\" with status \"DECLINED\"\n *\n * @param {string} reason - Reason for declining\n * @returns {void}\n */\nexport const decline = reason => {\n  sendMsgToFCL(\"FCL:VIEW:RESPONSE\", {\n    f_type: \"PollingResponse\",\n    f_vsn: \"1.0.0\",\n    status: \"DECLINED\",\n    reason: reason,\n    data: null,\n  })\n}\n\n/**\n * @description\n * Sends \"FCL:VIEW:RESPONSE\" with status \"REDIRECT\"\n *\n * @param {object} data - Data object\n * @returns {void}\n */\nexport const redirect = data => {\n  sendMsgToFCL(\"FCL:VIEW:RESPONSE\", {\n    f_type: \"PollingResponse\",\n    f_vsn: \"1.0.0\",\n    status: \"REDIRECT\",\n    reason: null,\n    data: data,\n  })\n}\n","export const SERVICE_PRAGMA = {\n  f_type: \"Service\",\n  f_vsn: \"1.0.0\",\n}\n\nexport const IDENTITY_PRAGMA = {\n  f_type: \"Identity\",\n  f_vsn: \"1.0.0\",\n}\n\nexport const PROVIDER_PRAGMA = {\n  f_type: \"Provider\",\n  f_vsn: \"1.0.0\",\n}\n\nexport const USER_PRAGMA = {\n  f_type: \"USER\",\n  f_vsn: \"1.0.0\",\n}\n\nexport const POLLING_RESPONSE_PRAGMA = {\n  f_type: \"PollingResponse\",\n  f_vsn: \"1.0.0\",\n}\n\nexport const COMPOSITE_SIGNATURE_PRAGMA = {\n  f_type: \"CompositeSignature\",\n  f_vsn: \"1.0.0\",\n}\n\nexport const OPEN_ID_PRAGMA = {\n  f_type: \"OpenId\",\n  f_vsn: \"1.0.0\",\n}\n","import {withPrefix} from \"@onflow/util-address\"\nimport {COMPOSITE_SIGNATURE_PRAGMA} from \"../normalizers/service/__vsn\"\n\n/**\n * @description\n * Constructs a new CompositeSignature instance.\n *\n * @param {string} addr - Flow Address\n * @param {number} keyId - Key ID\n * @param {string} signature - Signature as a hex string\n */\nexport function CompositeSignature(addr, keyId, signature) {\n  this.f_type = COMPOSITE_SIGNATURE_PRAGMA.f_type\n  this.f_vsn = COMPOSITE_SIGNATURE_PRAGMA.f_vsn\n  this.addr = withPrefix(addr)\n  this.keyId = Number(keyId)\n  this.signature = signature\n}\n","import {sansPrefix} from \"@onflow/util-address\"\nimport {invariant} from \"@onflow/util-invariant\"\nimport {Buffer, encode as rlpEncode} from \"@onflow/rlp\"\n\nconst rightPaddedHexBuffer = (value, pad) =>\n  Buffer.from(value.padEnd(pad * 2, \"0\"), \"hex\")\n\nconst leftPaddedHexBuffer = (value, pad) =>\n  Buffer.from(value.padStart(pad * 2, \"0\"), \"hex\")\n\nconst addressBuffer = addr => leftPaddedHexBuffer(addr, 8)\n\nconst nonceBuffer = nonce => Buffer.from(nonce, \"hex\")\n\nexport const encodeAccountProof = (\n  {address, nonce, appIdentifier},\n  includeDomainTag = true\n) => {\n  invariant(\n    address,\n    \"Encode Message For Provable Authn Error: address must be defined\"\n  )\n  invariant(\n    nonce,\n    \"Encode Message For Provable Authn Error: nonce must be defined\"\n  )\n  invariant(\n    appIdentifier,\n    \"Encode Message For Provable Authn Error: appIdentifier must be defined\"\n  )\n\n  invariant(\n    nonce.length >= 64,\n    \"Encode Message For Provable Authn Error: nonce must be minimum of 32 bytes\"\n  )\n\n  const ACCOUNT_PROOF_DOMAIN_TAG = rightPaddedHexBuffer(\n    Buffer.from(\"FCL-ACCOUNT-PROOF-V0.0\").toString(\"hex\"),\n    32\n  )\n\n  if (includeDomainTag) {\n    return Buffer.concat([\n      ACCOUNT_PROOF_DOMAIN_TAG,\n      rlpEncode([\n        appIdentifier,\n        addressBuffer(sansPrefix(address)),\n        nonceBuffer(nonce),\n      ]),\n    ]).toString(\"hex\")\n  }\n\n  return rlpEncode([\n    appIdentifier,\n    addressBuffer(sansPrefix(address)),\n    nonceBuffer(nonce),\n  ]).toString(\"hex\")\n}\n","export function injectExtService(service) {\n  if (service.type === \"authn\" && service.endpoint != null) {\n    if (!Array.isArray(window.fcl_extensions)) {\n      window.fcl_extensions = []\n    }\n    window.fcl_extensions.push(service)\n  } else {\n    console.warn(\"Authn service is required\")\n  }\n}\n","import {invariant} from \"@onflow/util-invariant\"\nimport {withPrefix, sansPrefix} from \"@onflow/util-address\"\nimport {query} from \"../exec/query\"\nimport {encodeAccountProof} from \"../wallet-utils\"\nimport {isString} from \"../utils/is\"\nimport {getChainId} from \"../utils\"\n\nconst ACCOUNT_PROOF = \"ACCOUNT_PROOF\"\nconst USER_SIGNATURE = \"USER_SIGNATURE\"\n\nexport const validateArgs = args => {\n  if (args.appIdentifier) {\n    const {appIdentifier, address, nonce, signatures} = args\n    invariant(\n      isString(appIdentifier),\n      \"verifyAccountProof({ appIdentifier }) -- appIdentifier must be a string\"\n    )\n    invariant(\n      isString(address) && sansPrefix(address).length === 16,\n      \"verifyAccountProof({ address }) -- address must be a valid address\"\n    )\n    invariant(/^[0-9a-f]+$/i.test(nonce), \"nonce must be a hex string\")\n    invariant(\n      Array.isArray(signatures) &&\n        signatures.every((sig, i, arr) => sig.f_type === \"CompositeSignature\"),\n      \"Must include an Array of CompositeSignatures to verify\"\n    )\n    invariant(\n      signatures.map(cs => cs.addr).every((addr, i, arr) => addr === arr[0]),\n      \"User signatures to be verified must be from a single account address\"\n    )\n    return true\n  } else {\n    const {message, address, compSigs} = args\n    invariant(\n      /^[0-9a-f]+$/i.test(message),\n      \"Signed message must be a hex string\"\n    )\n    invariant(\n      isString(address) && sansPrefix(address).length === 16,\n      \"verifyUserSignatures({ address }) -- address must be a valid address\"\n    )\n    invariant(\n      Array.isArray(compSigs) &&\n        compSigs.every((sig, i, arr) => sig.f_type === \"CompositeSignature\"),\n      \"Must include an Array of CompositeSignatures to verify\"\n    )\n    invariant(\n      compSigs.map(cs => cs.addr).every((addr, i, arr) => addr === arr[0]),\n      \"User signatures to be verified must be from a single account address\"\n    )\n    return true\n  }\n}\n\n// TODO: pass in option for contract but we're connected to testnet\n// log address + network -> in sync?\nconst getVerifySignaturesScript = async (sig, opts) => {\n  const verifyFunction =\n    sig === \"ACCOUNT_PROOF\"\n      ? \"verifyAccountProofSignatures\"\n      : \"verifyUserSignatures\"\n\n  let network = await getChainId(opts)\n\n  let fclCryptoContract\n\n  invariant(\n    opts.fclCryptoContract || network === \"testnet\" || network === \"mainnet\",\n    \"${verifyFunction}({ fclCryptoContract }) -- fclCrypto contract address must be set for non-mainnet/testnet networks\"\n  )\n\n  if (opts.fclCryptoContract) {\n    fclCryptoContract = opts.fclCryptoContract\n  } else {\n    fclCryptoContract =\n      network === \"testnet\" ? \"0x74daa6f9c7ef24b1\" : \"0xb4b82a1c9d21d284\"\n  }\n\n  return `\n      import FCLCrypto from ${fclCryptoContract}\n\n      pub fun main(\n          address: Address, \n          message: String, \n          keyIndices: [Int], \n          signatures: [String]\n      ): Bool {\n        return FCLCrypto.${verifyFunction}(address: address, message: message, keyIndices: keyIndices, signatures: signatures)\n      }\n    `\n}\n\n/**\n * @description\n * Verify a valid account proof signature or signatures for an account on Flow.\n *\n * @param {string} appIdentifier - A message string in hexadecimal format\n * @param {object} accountProofData - An object consisting of address, nonce, and signatures\n * @param {string} accountProofData.address - A Flow account address\n * @param {string} accountProofData.nonce - A random string in hexadecimal format (minimum 32 bytes in total, i.e 64 hex characters)\n * @param {object[]} accountProofData.signatures - An array of composite signatures to verify\n * @param {object} [opts={}] - Options object\n * @param {string} opts.fclCryptoContract - An optional override Flow account address where the FCLCrypto contract is deployed\n * @returns {Promise<boolean>} - Returns true if the signature is valid, false otherwise\n *\n * @example\n *\n *  const accountProofData = {\n *   address: \"0x123\",\n *   nonce: \"F0123\"\n *   signatures: [{f_type: \"CompositeSignature\", f_vsn: \"1.0.0\", addr: \"0x123\", keyId: 0, signature: \"abc123\"}],\n *  }\n *\n *  const isValid = await fcl.AppUtils.verifyAccountProof(\n *    \"AwesomeAppId\",\n *    accountProofData,\n *    {fclCryptoContract}\n *  )\n */\nexport async function verifyAccountProof(\n  appIdentifier,\n  {address, nonce, signatures},\n  opts = {}\n) {\n  validateArgs({appIdentifier, address, nonce, signatures})\n  const message = encodeAccountProof({address, nonce, appIdentifier}, false)\n\n  let signaturesArr = []\n  let keyIndices = []\n\n  for (const el of signatures) {\n    signaturesArr.push(el.signature)\n    keyIndices.push(el.keyId.toString())\n  }\n\n  return query({\n    cadence: await getVerifySignaturesScript(ACCOUNT_PROOF, opts),\n    args: (arg, t) => [\n      arg(withPrefix(address), t.Address),\n      arg(message, t.String),\n      arg(keyIndices, t.Array(t.Int)),\n      arg(signaturesArr, t.Array(t.String)),\n    ],\n  })\n}\n\n/**\n * @description\n * Verify a valid signature/s for an account on Flow.\n *\n * @param {string} message - A message string in hexadecimal format\n * @param {Array} compSigs - An array of Composite Signatures\n * @param {string} compSigs[].addr - The account address\n * @param {number} compSigs[].keyId - The account keyId\n * @param {string} compSigs[].signature - The signature to verify\n * @param {object} [opts={}] - Options object\n * @param {string} opts.fclCryptoContract - An optional override of Flow account address where the FCLCrypto contract is deployed\n * @returns {boolean} - Returns true if the signature is valid, false otherwise\n *\n * @example\n *\n *  const isValid = await fcl.AppUtils.verifyUserSignatures(\n *    Buffer.from('FOO').toString(\"hex\"),\n *    [{f_type: \"CompositeSignature\", f_vsn: \"1.0.0\", addr: \"0x123\", keyId: 0, signature: \"abc123\"}],\n *    {fclCryptoContract}\n *  )\n */\nexport async function verifyUserSignatures(message, compSigs, opts = {}) {\n  const address = withPrefix(compSigs[0].addr)\n  validateArgs({message, address, compSigs})\n\n  let signaturesArr = []\n  let keyIndices = []\n\n  for (const el of compSigs) {\n    signaturesArr.push(el.signature)\n    keyIndices.push(el.keyId.toString())\n  }\n\n  return query({\n    cadence: await getVerifySignaturesScript(USER_SIGNATURE, opts),\n    args: (arg, t) => [\n      arg(address, t.Address),\n      arg(message, t.String),\n      arg(keyIndices, t.Array(t.Int)),\n      arg(signaturesArr, t.Array(t.String)),\n    ],\n  })\n}\n","import {log} from \"@onflow/util-logger\"\nimport {verifyUserSignatures as verify} from \"../app-utils\"\n\n/**\n * Verify a valid signature/s for an account on Flow.\n *\n * @deprecated since version '1.0.0-alpha.0', use AppUtils.verifyUserSignatures instead\n *\n */\nexport const verifyUserSignatures = log.deprecate({\n  pkg: \"FCL\",\n  subject: \"fcl.verifyUserSignatures()\",\n  message: \"Please use fcl.AppUtils.verifyUserSignatures()\",\n  callback: function verifyUserSignatures(message, compSigs) {\n    return verify(message, compSigs)\n  },\n})\n","import {interaction, pipe} from \"@onflow/sdk\"\nimport {resolve as defaultResolve} from \"@onflow/sdk\"\nimport {config, createSignableVoucher} from \"@onflow/sdk\"\n\nexport const serialize = async (args = [], opts = {}) => {\n  const resolveFunction = await config.first(\n    [\"sdk.resolve\"],\n    opts.resolve || defaultResolve\n  )\n\n  if (Array.isArray(args)) args = await pipe(interaction(), args)\n\n  return JSON.stringify(\n    createSignableVoucher(await resolveFunction(args)),\n    null,\n    2\n  )\n}\n","import {config} from \"@onflow/config\"\n\nexport async function configLens(regex) {\n  return Object.fromEntries(\n    Object.entries(await config().where(regex)).map(([key, value]) => [\n      key.replace(regex, \"\"),\n      value,\n    ])\n  )\n}\n","import \"../default-config\"\nimport {\n  spawn,\n  subscriber,\n  snapshoter,\n  UPDATED,\n  SNAPSHOT,\n  INIT,\n  SUBSCRIBE,\n  UNSUBSCRIBE,\n} from \"@onflow/util-actor\"\nimport {send as fclSend, decode, getTransactionStatus} from \"@onflow/sdk\"\n\n/**\n * @typedef {import(\"@onflow/typedefs\").Transaction} Transaction\n */\n\n/**\n * @typedef {import(\"@onflow/typedefs\").TransactionStatus} TransactionStatus\n */\n\nconst RATE = 2500\nconst POLL = \"POLL\"\n\nconst fetchTxStatus = async transactionId => {\n  return fclSend([getTransactionStatus(transactionId)]).then(decode)\n}\n\nconst isExpired = tx => tx.status === 5\nconst isSealed = tx => tx.status >= 4\nconst isExecuted = tx => tx.status >= 3\nconst isFinalized = tx => tx.status >= 2\nconst isPending = tx => tx.status >= 1\nconst isUnknown = tx => tx.status >= 0\n\nconst isDiff = (cur, next) => {\n  return JSON.stringify(cur) !== JSON.stringify(next)\n}\n\nconst HANDLERS = {\n  [INIT]: async ctx => {\n    ctx.sendSelf(POLL)\n  },\n  [SUBSCRIBE]: (ctx, letter) => {\n    ctx.subscribe(letter.from)\n    ctx.send(letter.from, UPDATED, ctx.all())\n  },\n  [UNSUBSCRIBE]: (ctx, letter) => {\n    ctx.unsubscribe(letter.from)\n  },\n  [SNAPSHOT]: async (ctx, letter) => {\n    letter.reply(ctx.all())\n  },\n  [POLL]: async ctx => {\n    let tx\n    try {\n      tx = await fetchTxStatus(ctx.self())\n    } catch (e) {\n      return ctx.fatalError(e)\n    }\n\n    if (!isSealed(tx)) setTimeout(() => ctx.sendSelf(POLL), RATE)\n    if (isDiff(ctx.all(), tx)) ctx.broadcast(UPDATED, tx)\n    ctx.merge(tx)\n  },\n}\n\nconst scoped = transactionId => {\n  if (typeof transactionId === \"object\")\n    transactionId = transactionId.transactionId\n  if (transactionId == null) throw new Error(\"transactionId required\")\n  return transactionId\n}\n\nconst spawnTransaction = transactionId => {\n  return spawn(HANDLERS, scoped(transactionId))\n}\n\n/**\n * @callback SubscriptionCallback\n * @param {TransactionStatus} txStatus\n * @returns {void}\n */\n\n/**\n * Provides methods for interacting with a transaction\n * \n * @param {string} transactionId - The transaction ID\n * @returns {{\n *    snapshot: function(): Promise<TransactionStatus>,\n *    subscribe: function(SubscriptionCallback): function(): void,\n *    onceFinalized: function(): Promise<TransactionStatus>,\n *    onceExecuted: function(): Promise<TransactionStatus>,\n *    onceSealed: function(): Promise<TransactionStatus>\n * }}\n */\nexport function transaction(transactionId) {\n  function snapshot() {\n    return snapshoter(transactionId, spawnTransaction)\n  }\n\n  function subscribe(callback) {\n    return subscriber(scoped(transactionId), spawnTransaction, callback)\n  }\n\n  function once(predicate) {\n    return function innerOnce(opts = {}) {\n      const suppress = opts.suppress || false\n      return new Promise((resolve, reject) => {\n        const unsub = subscribe((txStatus, error) => {\n          if ((error || txStatus.statusCode) && !suppress) {\n            reject(error || txStatus.errorMessage)\n            unsub()\n          } else if (predicate(txStatus)) {\n            resolve(txStatus)\n            unsub()\n          }\n        })\n      })\n    }\n  }\n\n  return {\n    snapshot,\n    subscribe,\n    onceFinalized: once(isFinalized),\n    onceExecuted: once(isExecuted),\n    onceSealed: once(isSealed),\n  }\n}\n\ntransaction.isUnknown = isUnknown\ntransaction.isPending = isPending\ntransaction.isFinalized = isFinalized\ntransaction.isExecuted = isExecuted\ntransaction.isSealed = isSealed\ntransaction.isExpired = isExpired\n","import {spawn, subscriber, SUBSCRIBE, UNSUBSCRIBE} from \"@onflow/util-actor\"\nimport {\n  config,\n  block,\n  getEventsAtBlockHeightRange,\n  send,\n  decode,\n} from \"@onflow/sdk\"\n\nconst RATE = 10000\nconst UPDATED = \"UPDATED\"\nconst TICK = \"TICK\"\nconst HIGH_WATER_MARK = \"hwm\"\n\nconst scheduleTick = async ctx => {\n  return setTimeout(\n    () => ctx.sendSelf(TICK),\n    await config().get(\"fcl.eventPollRate\", RATE)\n  )\n}\n\nconst HANDLERS = {\n  [TICK]: async ctx => {\n    if (!ctx.hasSubs()) return\n    let hwm = ctx.get(HIGH_WATER_MARK)\n    if (hwm == null) {\n      ctx.put(HIGH_WATER_MARK, await block())\n      ctx.put(TICK, await scheduleTick(ctx))\n    } else {\n      let next = await block()\n      ctx.put(HIGH_WATER_MARK, next)\n      if (hwm.height < next.height) {\n        const data = await send([\n          getEventsAtBlockHeightRange(ctx.self(), hwm.height + 1, next.height),\n        ]).then(decode)\n        for (let d of data) ctx.broadcast(UPDATED, d.data)\n      }\n      ctx.put(TICK, await scheduleTick(ctx))\n    }\n  },\n  [SUBSCRIBE]: async (ctx, letter) => {\n    if (!ctx.hasSubs()) {\n      ctx.put(TICK, await scheduleTick(ctx))\n    }\n    ctx.subscribe(letter.from)\n  },\n  [UNSUBSCRIBE]: (ctx, letter) => {\n    ctx.unsubscribe(letter.from)\n    if (!ctx.hasSubs()) {\n      clearTimeout(ctx.get(TICK))\n      ctx.delete(TICK)\n      ctx.delete(HIGH_WATER_MARK)\n    }\n  },\n}\n\nconst spawnEvents = key => spawn(HANDLERS, key)\n\n/**\n * @typedef {import(\"@onflow/typedefs\").Event} Event\n */\n\n/**\n * @typedef {object} SubscribeObject\n * @property {Function} subscribe - The subscribe function.\n */\n\n/**\n * @callback SubscriptionCallback\n * @returns {Event}\n */\n\n/**\n * @description - Subscribe to events\n * @param {string} key - A valid event name\n * @returns {SubscribeObject}\n * \n * @example\n * import * as fcl from \"@onflow/fcl\"\n * fcl.events(eventName).subscribe((event) => console.log(event))\n */\nexport function events(key) {\n  return {\n    /**\n     * @description - Subscribe to events\n     * @param {Function} callback - The callback function\n     * @returns {SubscriptionCallback}\n     */\n    subscribe: callback => subscriber(key, spawnEvents, callback),\n  }\n}\n","import {invariant} from \"@onflow/util-invariant\"\nimport {LEVELS, log} from \"@onflow/util-logger\"\nimport {isRequired, isString, isObject, isFunc} from \"../../utils/is\"\nimport { CORE_STRATEGIES } from \"../../utils/constants\"\n\nconst stub = () => {\n  throw new Error(`Platform specific Core Strategies are not initialized`)\n}\n\nconst stubCoreStrategies = ({\n  [CORE_STRATEGIES[\"EXT/RPC\"]]: stub,\n  [CORE_STRATEGIES[\"HTTP/POST\"]]: stub,\n  [CORE_STRATEGIES[\"IFRAME/RPC\"]]: stub,\n  [CORE_STRATEGIES[\"POP/RPC\"]]: stub,\n  [CORE_STRATEGIES[\"TAB/RPC\"]]: stub,\n  [CORE_STRATEGIES[\"EXT/RPC\"]]: stub,\n})\n\nconst supportedPlugins = [\"ServicePlugin\"]\nconst supportedServicePlugins = [\"discovery-service\"]\n\nconst validateDiscoveryPlugin = servicePlugin => {\n  const {services, serviceStrategy} = servicePlugin\n  invariant(\n    Array.isArray(services) && services.length,\n    \"Array of Discovery Services is required\"\n  )\n\n  for (const ds of services) {\n    invariant(\n      isRequired(ds.f_type) && ds.f_type === \"Service\",\n      \"Service is required\"\n    )\n    invariant(\n      isRequired(ds.type) && ds.type === \"authn\",\n      `Service must be type authn. Received ${ds.type}`\n    )\n    invariant(\n      ds.method in CORE_STRATEGIES || serviceStrategy.method === ds.method,\n      `Service method ${ds.method} is not supported`\n    )\n  }\n\n  invariant(isRequired(serviceStrategy), \"Service strategy is required\")\n  invariant(\n    isRequired(serviceStrategy.method) && isString(serviceStrategy.method),\n    \"Service strategy method is required\"\n  )\n  invariant(\n    isRequired(serviceStrategy.exec) && isFunc(serviceStrategy.exec),\n    \"Service strategy exec function is required\"\n  )\n\n  return {discoveryServices: services, serviceStrategy}\n}\n\nconst ServiceRegistry = ({coreStrategies}) => {\n  let services = new Set()\n  let strategies = new Map(Object.entries(coreStrategies))\n\n  const add = servicePlugin => {\n    invariant(\n      supportedServicePlugins.includes(servicePlugin.type),\n      `Service Plugin type ${servicePlugin.type} is not supported`\n    )\n    if (servicePlugin.type === \"discovery-service\") {\n      const {discoveryServices, serviceStrategy} =\n        validateDiscoveryPlugin(servicePlugin)\n      setServices(discoveryServices)\n      if (!strategies.has(serviceStrategy.method)) {\n        strategies.set(serviceStrategy.method, serviceStrategy.exec)\n      } else {\n        log({\n          title: `Add Service Plugin`,\n          message: `Service strategy for ${serviceStrategy.method} already exists`,\n          level: LEVELS.warn,\n        })\n      }\n    }\n  }\n\n  const setServices = discoveryServices =>\n    (services = new Set([...discoveryServices]))\n\n  const getServices = () => [...services]\n\n  const getStrategy = method => strategies.get(method)\n\n  const getStrategies = () => [...strategies.keys()]\n\n  return Object.freeze({\n    add,\n    getServices,\n    getStrategy,\n    getStrategies,\n  })\n}\n\nconst validatePlugins = plugins => {\n  let pluginsArray\n  invariant(plugins, \"No plugins supplied\")\n\n  if (!Array.isArray(plugins)) {\n    pluginsArray = [plugins]\n  } else {\n    pluginsArray = [...plugins]\n  }\n  for (const p of pluginsArray) {\n    invariant(isRequired(p.name), \"Plugin name is required\")\n    invariant(isRequired(p.f_type), \"Plugin f_type is required\")\n    invariant(\n      supportedPlugins.includes(p.f_type),\n      `Plugin type ${p.f_type} is not supported`\n    )\n  }\n\n  return pluginsArray\n}\n\nconst PluginRegistry = () => {\n  const pluginsMap = new Map()\n\n  const getPlugins = () => pluginsMap\n\n  const add = plugins => {\n    const pluginsArray = validatePlugins(plugins)\n    for (const p of pluginsArray) {\n      pluginsMap.set(p.name, p)\n      if (p.f_type === \"ServicePlugin\") {\n        serviceRegistry.add(p)\n      }\n    }\n  }\n\n  return Object.freeze({\n    add,\n    getPlugins,\n  })\n}\n\nlet serviceRegistry\nconst getIsServiceRegistryInitialized = () => typeof serviceRegistry !== 'undefined'\n\nexport const initServiceRegistry = ({coreStrategies}) => {\n  if (getIsServiceRegistryInitialized()) {\n    return serviceRegistry\n  }\n  const _serviceRegistry = ServiceRegistry({coreStrategies});\n  serviceRegistry = _serviceRegistry;\n\n  return _serviceRegistry\n}\nexport const getServiceRegistry = () => {\n  if (!getIsServiceRegistryInitialized()) {\n    console.warn(\"Registry is not initalized, it will be initialized with stub core strategies\")\n\n    return initServiceRegistry({coreStrategies: stubCoreStrategies})\n  }\n\n  return serviceRegistry\n}\nexport const pluginRegistry = PluginRegistry()\n","import {config} from \"@onflow/config\"\nimport {invariant} from \"@onflow/util-invariant\"\nimport {getServiceRegistry} from \"../current-user/exec-service/plugins\"\n\nexport const makeDiscoveryServices = async () => {\n  const extensionServices = window?.fcl_extensions || []\n  return [...extensionServices, ...getServiceRegistry().getServices()]\n}\n\nexport async function getDiscoveryService(service) {\n  const discoveryAuthnInclude = await config.get(\"discovery.authn.include\", [])\n  const discoveryFeaturesSuggested = await config.get(\"discovery.features.suggested\", [])\n  const discoveryWalletMethod = await config.first([\n    \"discovery.wallet.method\",\n    \"discovery.wallet.method.default\",\n  ])\n  const method = service?.method ? service.method : discoveryWalletMethod\n  const endpoint =\n    service?.endpoint ??\n    (await config.first([\"discovery.wallet\", \"challenge.handshake\"]))\n\n  invariant(\n    endpoint,\n    `\n    If no service is passed to \"authenticate,\" then \"discovery.wallet\" must be defined in fcl config.\n    See: \"https://docs.onflow.org/fcl/reference/api/#setting-configuration-values\"\n    `\n  )\n\n  return {\n    ...service,\n    type: \"authn\",\n    endpoint,\n    method,\n    discoveryAuthnInclude,\n    discoveryFeaturesSuggested,\n  }\n}\n","import {config} from \"@onflow/config\"\nimport {invariant} from \"@onflow/util-invariant\"\nimport {getServiceRegistry} from \"../current-user/exec-service/plugins\"\nimport {getChainId} from \"../utils\"\nimport {VERSION} from \"../VERSION\"\nimport {makeDiscoveryServices} from \"./utils\"\nimport {URL} from \"../utils/url\"\n\nexport async function getServices({types}) {\n  const endpoint = await config.get(\"discovery.authn.endpoint\")\n  invariant(\n    Boolean(endpoint),\n    `\"discovery.authn.endpoint\" in config must be defined.`\n  )\n\n  const include = await config.get(\"discovery.authn.include\", [])\n  const url = new URL(endpoint)\n\n  return fetch(url, {\n    method: \"POST\",\n    headers: {\n      \"Content-Type\": \"application/json\",\n    },\n    body: JSON.stringify({\n      type: types,\n      fclVersion: VERSION,\n      include,\n      features: {\n        suggested: await config.get(\"discovery.features.suggested\", [])\n      },\n      clientServices: await makeDiscoveryServices(),\n      supportedStrategies: getServiceRegistry().getStrategies(),\n      userAgent: window?.navigator?.userAgent,\n      network: await getChainId(),\n    }),\n  }).then(d => d.json())\n}\n","import {\n  spawn,\n  subscriber,\n  snapshoter,\n  INIT,\n  SUBSCRIBE,\n  UNSUBSCRIBE,\n  send,\n} from \"@onflow/util-actor\"\nimport {getServices} from \"../services\"\nimport {LEVELS, log} from \"@onflow/util-logger\"\n\nexport const SERVICE_ACTOR_KEYS = {\n  AUTHN: \"authn\",\n  RESULTS: \"results\",\n  SNAPSHOT: \"SNAPSHOT\",\n  UPDATED: \"UPDATED\",\n  UPDATE_RESULTS: \"UPDATE_RESULTS\",\n}\n\nconst warn = (fact, msg) => {\n  if (fact) {\n    console.warn(\n      `\n      %cFCL Warning\n      ============================\n      ${msg}\n      For more info, please see the docs: https://docs.onflow.org/fcl/\n      ============================\n      `,\n      \"font-weight:bold;font-family:monospace;\"\n    )\n  }\n}\n\nconst fetchServicesFromDiscovery = async () => {\n  try {\n    const services = await getServices({types: [SERVICE_ACTOR_KEYS.AUTHN]})\n    send(SERVICE_ACTOR_KEYS.AUTHN, SERVICE_ACTOR_KEYS.UPDATE_RESULTS, {\n      results: services,\n    })\n  } catch (error) {\n    log({\n      title: `${error.name} Error fetching Discovery API services.`,\n      message: error.message,\n      level: LEVELS.error,\n    })\n  }\n}\n\nconst HANDLERS = {\n  [INIT]: async ctx => {\n    warn(\n      typeof window === \"undefined\",\n      '\"fcl.discovery\" is only available in the browser.'\n    )\n    // If you call this before the window is loaded extensions will not be set yet\n    if (document.readyState === 'complete') {\n      fetchServicesFromDiscovery()\n    } else {\n      window.onload = async () => {\n        fetchServicesFromDiscovery()\n      }\n    }\n  },\n  [SERVICE_ACTOR_KEYS.UPDATE_RESULTS]: (ctx, _letter, data) => {\n    ctx.merge(data)\n    ctx.broadcast(SERVICE_ACTOR_KEYS.UPDATED, {...ctx.all()})\n  },\n  [SUBSCRIBE]: (ctx, letter) => {\n    ctx.subscribe(letter.from)\n    ctx.send(letter.from, SERVICE_ACTOR_KEYS.UPDATED, {...ctx.all()})\n  },\n  [UNSUBSCRIBE]: (ctx, letter) => ctx.unsubscribe(letter.from),\n  [SERVICE_ACTOR_KEYS.SNAPSHOT]: async (ctx, letter) =>\n    letter.reply({...ctx.all()}),\n}\n\nconst spawnProviders = () => spawn(HANDLERS, SERVICE_ACTOR_KEYS.AUTHN)\n\n/**\n * @typedef {import(\"@onflow/typedefs\").Service} Service\n */\n\n/**\n * @callback SubscriptionCallback\n * @returns {Service[]}\n */\n\n/**\n * @description\n * Discovery methods for interacting with Authn.\n * \n * @typedef {object} Authn\n * @property {Function} subscribe - Subscribe to Discovery authn services\n * @property {Function} snapshot - Get the current Discovery authn services spanshot\n * @property {Function} update - Trigger an update of authn services\n */\nconst authn = {\n  /**\n   * @description - Subscribe to Discovery authn services\n   * @param {Function} cb\n   * @returns {SubscriptionCallback}\n   */\n  subscribe: cb => subscriber(SERVICE_ACTOR_KEYS.AUTHN, spawnProviders, cb),\n  /**\n   * @description - Get the current Discovery authn services spanshot\n   * @returns {Service[]}\n   */\n  snapshot: () => snapshoter(SERVICE_ACTOR_KEYS.AUTHN, spawnProviders),\n  /**\n   * @description - Trigger an update of authn services\n   * @returns {void}\n   */\n  update: () => fetchServicesFromDiscovery(),\n}\n\nexport default authn\n","import authn from \"./services/authn\"\nexport {getDiscoveryService, makeDiscoveryServices} from \"./utils\"\n\nconst discovery = {\n  authn,\n}\n\nexport {discovery}\n","\"use strict\";var copy=function copy(I,i){return function(O,o){var oi=o*2;var ii=i*2;O[oi]=I[ii];O[oi+1]=I[ii+1]}};module.exports=copy;","\"use strict\";Object.defineProperty(exports,\"__esModule\",{value:true});exports[\"default\"]=void 0;var _copy=_interopRequireDefault(require(\"../copy\"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{\"default\":obj}}var chi=function chi(_ref){var A=_ref.A,C=_ref.C;for(var y=0;y<25;y+=5){for(var x=0;x<5;x++){(0,_copy[\"default\"])(A,y+x)(C,x)}for(var _x=0;_x<5;_x++){var xy=(y+_x)*2;var x1=(_x+1)%5*2;var x2=(_x+2)%5*2;A[xy]^=~C[x1]&C[x2];A[xy+1]^=~C[x1+1]&C[x2+1]}}};var _default=chi;exports[\"default\"]=_default;","\"use strict\";Object.defineProperty(exports,\"__esModule\",{value:true});exports[\"default\"]=void 0;var ROUND_CONSTANTS=new Uint32Array([0,1,0,32898,2147483648,32906,2147483648,2147516416,0,32907,0,2147483649,2147483648,2147516545,2147483648,32777,0,138,0,136,0,2147516425,0,2147483658,0,2147516555,2147483648,139,2147483648,32905,2147483648,32771,2147483648,32770,2147483648,128,0,32778,2147483648,2147483658,2147483648,2147516545,2147483648,32896,0,2147483649,2147483648,2147516424]);var _default=ROUND_CONSTANTS;exports[\"default\"]=_default;","\"use strict\";Object.defineProperty(exports,\"__esModule\",{value:true});exports[\"default\"]=void 0;var _roundConstants=_interopRequireDefault(require(\"./round-constants\"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{\"default\":obj}}var iota=function iota(_ref){var A=_ref.A,roundIndex=_ref.roundIndex;var i=roundIndex*2;A[0]^=_roundConstants[\"default\"][i];A[1]^=_roundConstants[\"default\"][i+1]};var _default=iota;exports[\"default\"]=_default;","\"use strict\";Object.defineProperty(exports,\"__esModule\",{value:true});exports[\"default\"]=void 0;var PI_SHUFFLES=[10,7,11,17,18,3,5,16,8,21,24,4,15,23,19,13,12,2,20,14,22,9,6,1];var _default=PI_SHUFFLES;exports[\"default\"]=_default;","\"use strict\";Object.defineProperty(exports,\"__esModule\",{value:true});exports[\"default\"]=void 0;var RHO_OFFSETS=[1,3,6,10,15,21,28,36,45,55,2,14,27,41,56,8,25,43,62,18,39,61,20,44];var _default=RHO_OFFSETS;exports[\"default\"]=_default;","\"use strict\";Object.defineProperty(exports,\"__esModule\",{value:true});exports[\"default\"]=void 0;var _piShuffles=_interopRequireDefault(require(\"./pi-shuffles\"));var _rhoOffsets=_interopRequireDefault(require(\"./rho-offsets\"));var _copy=_interopRequireDefault(require(\"../copy\"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{\"default\":obj}}var rhoPi=function rhoPi(_ref){var A=_ref.A,C=_ref.C,W=_ref.W;(0,_copy[\"default\"])(A,1)(W,0);var H=0;var L=0;var Wi=0;var ri=32;for(var i=0;i<24;i++){var j=_piShuffles[\"default\"][i];var r=_rhoOffsets[\"default\"][i];(0,_copy[\"default\"])(A,j)(C,0);H=W[0];L=W[1];ri=32-r;Wi=r<32?0:1;W[Wi]=H<<r|L>>>ri;W[(Wi+1)%2]=L<<r|H>>>ri;(0,_copy[\"default\"])(W,0)(A,j);(0,_copy[\"default\"])(C,0)(W,0)}};var _default=rhoPi;exports[\"default\"]=_default;","\"use strict\";Object.defineProperty(exports,\"__esModule\",{value:true});exports[\"default\"]=void 0;var _copy=_interopRequireDefault(require(\"../copy\"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{\"default\":obj}}var theta=function theta(_ref){var A=_ref.A,C=_ref.C,D=_ref.D,W=_ref.W;var H=0;var L=0;for(var x=0;x<5;x++){var x20=x*2;var x21=(x+5)*2;var x22=(x+10)*2;var x23=(x+15)*2;var x24=(x+20)*2;C[x20]=A[x20]^A[x21]^A[x22]^A[x23]^A[x24];C[x20+1]=A[x20+1]^A[x21+1]^A[x22+1]^A[x23+1]^A[x24+1]}for(var _x=0;_x<5;_x++){(0,_copy[\"default\"])(C,(_x+1)%5)(W,0);H=W[0];L=W[1];W[0]=H<<1|L>>>31;W[1]=L<<1|H>>>31;D[_x*2]=C[(_x+4)%5*2]^W[0];D[_x*2+1]=C[(_x+4)%5*2+1]^W[1];for(var y=0;y<25;y+=5){A[(y+_x)*2]^=D[_x*2];A[(y+_x)*2+1]^=D[_x*2+1]}}};var _default=theta;exports[\"default\"]=_default;","\"use strict\";Object.defineProperty(exports,\"__esModule\",{value:true});exports[\"default\"]=void 0;var _chi=_interopRequireDefault(require(\"./chi\"));var _iota=_interopRequireDefault(require(\"./iota\"));var _rhoPi=_interopRequireDefault(require(\"./rho-pi\"));var _theta=_interopRequireDefault(require(\"./theta\"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{\"default\":obj}}var permute=function permute(){var C=new Uint32Array(10);var D=new Uint32Array(10);var W=new Uint32Array(2);return function(A){for(var roundIndex=0;roundIndex<24;roundIndex++){(0,_theta[\"default\"])({A:A,C:C,D:D,W:W});(0,_rhoPi[\"default\"])({A:A,C:C,W:W});(0,_chi[\"default\"])({A:A,C:C});(0,_iota[\"default\"])({A:A,roundIndex:roundIndex})}C.fill(0);D.fill(0);W.fill(0)}};var _default=permute;exports[\"default\"]=_default;","\"use strict\";Object.defineProperty(exports,\"__esModule\",{value:true});exports[\"default\"]=void 0;var _buffer=require(\"buffer\");var _permute=_interopRequireDefault(require(\"./permute\"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{\"default\":obj}}var xorWords=function xorWords(I,O){for(var i=0;i<I.length;i+=8){var o=i/4;O[o]^=I[i+7]<<24|I[i+6]<<16|I[i+5]<<8|I[i+4];O[o+1]^=I[i+3]<<24|I[i+2]<<16|I[i+1]<<8|I[i]}return O};var readWords=function readWords(I,O){for(var o=0;o<O.length;o+=8){var i=o/4;O[o]=I[i+1];O[o+1]=I[i+1]>>>8;O[o+2]=I[i+1]>>>16;O[o+3]=I[i+1]>>>24;O[o+4]=I[i];O[o+5]=I[i]>>>8;O[o+6]=I[i]>>>16;O[o+7]=I[i]>>>24}return O};var Sponge=function Sponge(_ref){var _this=this;var capacity=_ref.capacity,padding=_ref.padding;var keccak=(0,_permute[\"default\"])();var stateSize=200;var blockSize=capacity/8;var queueSize=stateSize-capacity/4;var queueOffset=0;var state=new Uint32Array(stateSize/4);var queue=_buffer.Buffer.allocUnsafe(queueSize);this.absorb=function(buffer){for(var i=0;i<buffer.length;i++){queue[queueOffset]=buffer[i];queueOffset+=1;if(queueOffset>=queueSize){xorWords(queue,state);keccak(state);queueOffset=0}}return _this};this.squeeze=function(){var options=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var output={buffer:options.buffer||_buffer.Buffer.allocUnsafe(blockSize),padding:options.padding||padding,queue:_buffer.Buffer.allocUnsafe(queue.length),state:new Uint32Array(state.length)};queue.copy(output.queue);for(var i=0;i<state.length;i++){output.state[i]=state[i]}output.queue.fill(0,queueOffset);output.queue[queueOffset]|=output.padding;output.queue[queueSize-1]|=128;xorWords(output.queue,output.state);for(var offset=0;offset<output.buffer.length;offset+=queueSize){keccak(output.state);readWords(output.state,output.buffer.slice(offset,offset+queueSize))}return output.buffer};this.reset=function(){queue.fill(0);state.fill(0);queueOffset=0;return _this};return this};var _default=Sponge;exports[\"default\"]=_default;","\"use strict\";Object.defineProperty(exports,\"__esModule\",{value:true});exports[\"default\"]=exports.SHAKE=exports.SHA3Hash=exports.SHA3=exports.Keccak=void 0;var _buffer=require(\"buffer\");var _sponge=_interopRequireDefault(require(\"./sponge\"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{\"default\":obj}}var createHash=function createHash(_ref){var allowedSizes=_ref.allowedSizes,defaultSize=_ref.defaultSize,padding=_ref.padding;return function Hash(){var _this=this;var size=arguments.length>0&&arguments[0]!==undefined?arguments[0]:defaultSize;if(!this||this.constructor!==Hash){return new Hash(size)}if(allowedSizes&&!allowedSizes.includes(size)){throw new Error(\"Unsupported hash length\")}var sponge=new _sponge[\"default\"]({capacity:size});this.update=function(input){var encoding=arguments.length>1&&arguments[1]!==undefined?arguments[1]:\"utf8\";if(_buffer.Buffer.isBuffer(input)){sponge.absorb(input);return _this}if(typeof input===\"string\"){return _this.update(_buffer.Buffer.from(input,encoding))}throw new TypeError(\"Not a string or buffer\")};this.digest=function(){var formatOrOptions=arguments.length>0&&arguments[0]!==undefined?arguments[0]:\"binary\";var options=typeof formatOrOptions===\"string\"?{format:formatOrOptions}:formatOrOptions;var buffer=sponge.squeeze({buffer:options.buffer,padding:options.padding||padding});if(options.format&&options.format!==\"binary\"){return buffer.toString(options.format)}return buffer};this.reset=function(){sponge.reset();return _this};return this}};var Keccak=createHash({allowedSizes:[224,256,384,512],defaultSize:512,padding:1});exports.Keccak=Keccak;var SHA3=createHash({allowedSizes:[224,256,384,512],defaultSize:512,padding:6});exports.SHA3=SHA3;var SHAKE=createHash({allowedSizes:[128,256],defaultSize:256,padding:31});exports.SHAKE=SHAKE;var SHA3Hash=Keccak;exports.SHA3Hash=SHA3Hash;SHA3.SHA3Hash=SHA3Hash;var _default=SHA3;exports[\"default\"]=_default;","import {SHA3} from \"sha3\"\nimport {Buffer} from \"@onflow/rlp\"\n\nexport async function genHash(utf8String) {\n  const sha = new SHA3(256)\n  sha.update(Buffer.from(utf8String, \"utf8\"))\n  return sha.digest(\"hex\")\n}\n","import {invariant} from \"@onflow/sdk\"\nimport {encode as rlpEncode} from \"@onflow/rlp\"\nimport {genHash} from \"./utils/hash.js\"\nimport {normalizeInteractionTemplate} from \"../normalizers/interaction-template/interaction-template.js\"\n\n/**\n * @description Generates Interaction Template ID for a given Interaction Template\n *  \n * @param {object} params\n * @param {object} params.template - Interaction Template\n * @returns {Promise<string>} - Interaction Template ID\n */\nexport async function generateTemplateId({template}) {\n  invariant(\n    template != undefined,\n    \"generateTemplateId({ template }) -- template must be defined\"\n  )\n  invariant(\n    typeof template === \"object\",\n    \"generateTemplateId({ template }) -- template must be an object\"\n  )\n  invariant(\n    typeof template.f_type === \"InteractionTemplate\",\n    \"generateTemplateId({ template }) -- template object must be an InteractionTemplate\"\n  )\n\n  template = normalizeInteractionTemplate(template)\n\n  switch (template.f_version) {\n    case \"1.0.0\":\n      const templateData = template.data\n\n      const messages = await Promise.all(\n        Object.keys(templateData.messages).map(async messageKey => [\n          await genHash(messageKey),\n          await Promise.all(\n            Object.keys(templateData.messages?.[messageKey]?.i18n).map(\n              async i18nkeylanguage => [\n                await genHash(i18nkeylanguage),\n                await genHash(\n                  templateData.messages?.[messageKey]?.i18n?.[i18nkeylanguage]\n                ),\n              ]\n            )\n          ),\n        ])\n      )\n\n      const dependencies = await Promise.all(\n        Object.keys(templateData?.dependencies).map(\n          async dependencyAddressPlaceholder => [\n            await genHash(dependencyAddressPlaceholder),\n            await Promise.all(\n              Object.keys(\n                templateData?.dependencies?.[dependencyAddressPlaceholder]\n              ).map(async dependencyContract => [\n                await genHash(dependencyContract),\n                await Promise.all(\n                  Object.keys(\n                    templateData?.dependencies?.[\n                      dependencyAddressPlaceholder\n                    ]?.[dependencyContract]\n                  ).map(async dependencyContractNetwork => [\n                    await genHash(dependencyContractNetwork),\n                    [\n                      await genHash(\n                        templateData?.dependencies?.[\n                          dependencyAddressPlaceholder\n                        ]?.[dependencyContract]?.[dependencyContractNetwork]\n                          .address\n                      ),\n                      await genHash(\n                        templateData?.dependencies?.[\n                          dependencyAddressPlaceholder\n                        ]?.[dependencyContract]?.[dependencyContractNetwork]\n                          .contract\n                      ),\n                      await genHash(\n                        templateData?.dependencies?.[\n                          dependencyAddressPlaceholder\n                        ]?.[dependencyContract]?.[dependencyContractNetwork]\n                          .fq_address\n                      ),\n                      await genHash(\n                        templateData?.dependencies?.[\n                          dependencyAddressPlaceholder\n                        ]?.[dependencyContract]?.[dependencyContractNetwork].pin\n                      ),\n                      await genHash(\n                        String(\n                          templateData?.dependencies?.[\n                            dependencyAddressPlaceholder\n                          ]?.[dependencyContract]?.[dependencyContractNetwork]\n                            .pin_block_height\n                        )\n                      ),\n                    ],\n                  ])\n                ),\n              ])\n            ),\n          ]\n        )\n      )\n\n      const _arguments = await Promise.all(\n        Object.keys(templateData?.[\"arguments\"]).map(async argumentLabel => [\n          await genHash(argumentLabel),\n          [\n            await genHash(\n              String(templateData?.[\"arguments\"]?.[argumentLabel].index)\n            ),\n            await genHash(templateData?.[\"arguments\"]?.[argumentLabel].type),\n            await genHash(\n              templateData?.[\"arguments\"]?.[argumentLabel].balance || \"\"\n            ),\n            await Promise.all(\n              Object.keys(\n                templateData?.[\"arguments\"]?.[argumentLabel].messages\n              ).map(async argumentMessageKey => [\n                await genHash(argumentMessageKey),\n                await Promise.all(\n                  Object.keys(\n                    templateData?.[\"arguments\"]?.[argumentLabel].messages?.[\n                      argumentMessageKey\n                    ].i18n\n                  ).map(async i18nkeylanguage => [\n                    await genHash(i18nkeylanguage),\n                    await genHash(\n                      templateData?.[\"arguments\"]?.[argumentLabel].messages?.[\n                        argumentMessageKey\n                      ].i18n?.[i18nkeylanguage]\n                    ),\n                  ])\n                ),\n              ])\n            ),\n          ],\n        ])\n      )\n\n      const encodedHex = rlpEncode([\n        await genHash(\"InteractionTemplate\"),\n        await genHash(\"1.0.0\"),\n        await genHash(templateData?.type),\n        await genHash(templateData?.interface),\n        messages,\n        await genHash(templateData?.cadence),\n        dependencies,\n        _arguments,\n      ]).toString(\"hex\")\n\n      return genHash(encodedHex)\n\n    default:\n      throw new Error(\"generateTemplateId Error: Unsupported template version\")\n  }\n}\n","import {config, invariant} from \"@onflow/sdk\"\nimport {log, LEVELS} from \"@onflow/util-logger\"\nimport {query} from \"../exec/query.js\"\nimport {generateTemplateId} from \"./generate-template-id.js\"\nimport {normalizeInteractionTemplate} from \"../normalizers/interaction-template/interaction-template.js\"\nimport {getChainId} from \"../utils\"\n\n/**\n * @description Returns whether a set of auditors have audited a given Interaction Template\n *\n * @param {object} params\n * @param {object} params.template - Interaction Template\n * @param {Array<string>} params.auditors - Array of auditors\n * @param {object} opts\n * @param {string} opts.flowInteractionAuditContract - Flow Interaction Template Audit contract address\n * @returns {Promise<object>} - Object of auditor addresses and audit status\n */\nexport async function getInteractionTemplateAudits(\n  {template, auditors},\n  opts = {}\n) {\n  invariant(\n    template != undefined,\n    \"getInteractionTemplateAudits({ template }) -- template must be defined\"\n  )\n\n  template = normalizeInteractionTemplate(template)\n\n  invariant(\n    template.f_type === \"InteractionTemplate\",\n    \"getInteractionTemplateAudits({ template }) -- template must be an InteractionTemplate\"\n  )\n\n  // Recompute ID to be sure it matches\n  let recomputedTemplateID = await generateTemplateId({template})\n\n  if (recomputedTemplateID !== template.id) {\n    log({\n      title: \"getInteractionTemplateAudits Debug Error\",\n      message: `Could not recompute and match template ID\n                computed: ${recomputedTemplateID}\n                template: ${template.id}\n            `,\n      level: LEVELS.debug,\n    })\n    throw new Error(\n      \"getInteractionTemplateAudits Error: Could not recompute and match template ID\"\n    )\n  }\n\n  switch (template.f_version) {\n    case \"1.0.0\":\n      const _auditors = auditors || (await config().get(\"flow.auditors\"))\n\n      invariant(\n        _auditors,\n        \"getInteractionTemplateAudits Error: Required configuration for 'fcl.auditors' is not set\"\n      )\n      invariant(\n        Array.isArray(_auditors),\n        \"getInteractionTemplateAudits Error: Required configuration for 'fcl.auditors' is not an array\"\n      )\n\n      let FlowInteractionAuditContract = opts.flowInteractionAuditContract\n      if (!FlowInteractionAuditContract) {\n        const fclNetwork = await getChainId(opts)\n        invariant(\n          fclNetwork === \"mainnet\" || fclNetwork === \"testnet\",\n          \"getInteractionTemplateAudits Error: Unable to determine address for FlowInteractionTemplateAudit contract. Set configuration for 'fcl.network' to 'mainnet' or 'testnet'\"\n        )\n        if (fclNetwork === \"mainnet\") {\n          FlowInteractionAuditContract = \"0xfd100e39d50a13e6\"\n        } else {\n          FlowInteractionAuditContract = \"0xf78bfc12d0a786dc\"\n        }\n      }\n\n      const audits = await query({\n        cadence: `\n        import FlowInteractionTemplateAudit from ${FlowInteractionAuditContract}\n        pub fun main(templateId: String, auditors: [Address]): {Address:Bool} {\n          return FlowInteractionTemplateAudit.getHasTemplateBeenAuditedByAuditors(templateId: templateId, auditors: auditors)\n        }\n        `,\n        args: (arg, t) => [\n          arg(recomputedTemplateID, t.String),\n          arg(_auditors, t.Array(t.Address)),\n        ],\n      })\n\n      return audits\n\n    default:\n      throw new Error(\n        \"getInteractionTemplateAudits Error: Unsupported template version\"\n      )\n  }\n}\n","export function generateImport({contractName, address}) {\n  return {contractName, address, contract: \"\"}\n}\n","import {generateImport} from \"./generate-import.js\"\n\nexport function findImports(cadence) {\n  let imports = []\n\n  let importsReg = /import ((\\w|,| )+)* from 0x\\w+/g\n  let fileImports = cadence.match(importsReg) || []\n\n  for (const fileImport of fileImports) {\n    const importLineReg = /import ((\\w+|, |)*) from (0x\\w+)/g\n    const importLine = importLineReg.exec(fileImport)\n\n    const contractsReg = /((?:\\w+)+),?/g\n    const contracts = importLine[1].match(contractsReg) || []\n\n    for (const contract of contracts) {\n      imports.push(\n        generateImport({\n          address: importLine[3],\n          contractName: contract.replace(/,/g, \"\"),\n        })\n      )\n    }\n  }\n\n  return imports\n}\n","import {\n  invariant,\n  block,\n  send,\n  getAccount,\n  atBlockHeight,\n  config,\n  decode,\n} from \"@onflow/sdk\"\nimport {genHash} from \"./utils/hash.js\"\nimport {findImports} from \"./utils/find-imports.js\"\nimport {generateImport} from \"./utils/generate-import.js\"\n\n/**\n * @description Produces a dependency pin for a contract at a given block height\n * @param {object} params\n * @param {string} params.address - The address of the account containing the contract\n * @param {string} params.contractName - The name of the contract\n * @param {number} params.blockHeight - The block height to produce the dependency pin for\n * @param {object} opts - Options to pass to the interaction\n * @returns {Promise<string>} - The dependency pin\n */\nexport async function generateDependencyPin(\n  {address, contractName, blockHeight},\n  opts = {}\n) {\n  invariant(\n    address != undefined,\n    \"generateDependencyPin({ address }) -- address must be defined\"\n  )\n  invariant(\n    contractName != undefined,\n    \"generateDependencyPin({ contractName }) -- contractName must be defined\"\n  )\n  invariant(\n    blockHeight != undefined,\n    \"generateDependencyPin({ blockHeight }) -- blockHeight must be defined\"\n  )\n  invariant(\n    typeof address === \"string\",\n    \"generateDependencyPin({ address }) -- address must be a string\"\n  )\n  invariant(\n    typeof contractName === \"string\",\n    \"generateDependencyPin({ contractName }) -- contractName must be a string\"\n  )\n  invariant(\n    typeof blockHeight === \"number\",\n    \"generateDependencyPin({ blockHeight }) -- blockHeight must be a number\"\n  )\n\n  let horizon = [generateImport({contractName, address})]\n\n  for (const horizonImport of horizon) {\n    let account = await send(\n      [\n        getAccount(\n          await config().get(horizonImport.address, horizonImport.address)\n        ),\n        atBlockHeight(blockHeight),\n      ],\n      opts\n    ).then(decode)\n\n    horizonImport.contract = account.contracts?.[horizonImport.contractName]\n\n    if (!horizonImport.contract) {\n      console.error(\"Did not find expected contract\", horizonImport, account)\n      throw new Error(\"Did not find expected contract\")\n    }\n\n    let contractImports = findImports(horizonImport.contract)\n\n    horizon.push(...contractImports)\n  }\n\n  let contractHashes = horizon.map(iport => genHash(iport.contract))\n\n  let contractHashesJoined = contractHashes.join(\"\")\n\n  return genHash(contractHashesJoined)\n}\n\n/**\n * @description Produces a dependency pin for a contract at latest sealed block\n * @param {object} params\n * @param {string} params.address - The address of the account containing the contract\n * @param {string} params.contractName - The name of the contract\n * @param {object} opts - Options to pass to the interaction\n * @returns {Promise<string>} - The dependency pin\n */\nexport async function generateDependencyPinAtLatestSealedBlock(\n  {address, contractName},\n  opts = {}\n) {\n  let latestSealedBlock = await block({sealed: true}, opts)\n  let latestSealedBlockHeight = latestSealedBlock?.height\n\n  return generateDependencyPin(\n    {address, contractName, blockHeight: latestSealedBlockHeight},\n    opts\n  )\n}\n","export function normalizeInteractionTemplateInterface(templateInterface) {\n  if (templateInterface == null) return null\n\n  switch (templateInterface[\"f_version\"]) {\n    case \"1.0.0\":\n      return templateInterface\n\n    default:\n      throw new Error(\n        \"normalizeInteractionTemplateInterface Error: Invalid InteractionTemplateInterface\"\n      )\n  }\n}\n","import {invariant} from \"@onflow/sdk\"\nimport {encode as rlpEncode} from \"@onflow/rlp\"\nimport {genHash} from \"./utils/hash.js\"\nimport {normalizeInteractionTemplateInterface} from \"../normalizers/interaction-template/interaction-template-interface.js\"\n\n/**\n * @description Generates Interaction Template Interface ID for a given Interaction Template Interface\n * \n * @param {object} params\n * @param {object} params.templateInterface - Interaction Template Interface\n * @returns {Promise<string>} - Interaction Template Interface ID\n */\nexport async function generateTemplateInterfaceId({templateInterface}) {\n  invariant(\n    templateInterface != undefined,\n    \"generateTemplateInterfaceId({ templateInterface }) -- templateInterface must be defined\"\n  )\n  invariant(\n    typeof templateInterface === \"object\",\n    \"generateTemplateInterfaceId({ templateInterface }) -- templateInterface must be an object\"\n  )\n  invariant(\n    typeof templateInterface.f_type === \"InteractionTemplateInterface\",\n    \"generateTemplateInterfaceId({ templateInterface }) -- templateInterface object must be an InteractionTemplate\"\n  )\n\n  templateInterface = normalizeInteractionTemplateInterface(templateInterface)\n\n  switch (templateInterface.f_version) {\n    case \"1.0.0\":\n      const interfaceData = templateInterface.data\n\n      const encodedHex = rlpEncode([\n        await genHash(\"InteractionTemplateInterface\"),\n        await genHash(\"1.0.0\"),\n        await genHash(interfaceData.flip),\n        await Promise.all(\n          Object.keys(interfaceData.arguments).map(async argumentLabel => [\n            await genHash(argumentLabel),\n            await genHash(String(interfaceData.arguments[argumentLabel].index)),\n            await genHash(interfaceData.arguments[argumentLabel].type),\n          ])\n        ),\n      ]).toString(\"hex\")\n\n      return genHash(encodedHex)\n\n    default:\n      throw new Error(\n        \"generateTemplateInterfaceId Error: Unsupported templateInterface version\"\n      )\n  }\n}\n","import {generateDependencyPin} from \"./generate-dependency-pin.js\"\nimport {invariant, block} from \"@onflow/sdk\"\nimport {log, LEVELS} from \"@onflow/util-logger\"\nimport {normalizeInteractionTemplate} from \"../normalizers/interaction-template/interaction-template.js\"\n\n/**\n * @description Checks if an Interaction Template's pins match those generated at a block height\n * \n * @param {object} params\n * @param {object} params.template - Interaction Template to check pins for\n * @param {number} params.blockHeight - Block height to check pins at\n * @param {string} params.network - Network to check pins on\n * @param {object} opts\n * @returns {Promise<boolean>} - Whether or not the pins match\n */\nexport async function verifyDependencyPinsSame(\n  {template, blockHeight, network},\n  opts = {}\n) {\n  invariant(\n    template != undefined,\n    \"generateDependencyPin({ template }) -- template must be defined\"\n  )\n  invariant(\n    typeof template === \"object\",\n    \"generateDependencyPin({ template }) -- template must be an object\"\n  )\n  invariant(\n    template.f_type === \"InteractionTemplate\",\n    \"generateDependencyPin({ template }) -- template must be an InteractionTemplate\"\n  )\n\n  template = normalizeInteractionTemplate(template)\n\n  invariant(\n    network != undefined,\n    \"generateDependencyPin({ network }) network must be defined\"\n  )\n  invariant(\n    blockHeight != undefined,\n    \"generateDependencyPin({ blockHeight }) blockHeight must be defined\"\n  )\n  invariant(\n    typeof blockHeight === \"number\",\n    \"generateDependencyPin({ blockHeight }) blockHeight must be a number\"\n  )\n\n  switch (template.f_version) {\n    case \"1.0.0\":\n      let templateDependenciesPlaceholderKeys = Object.keys(\n        template.data.dependencies\n      )\n\n      for (let templateDependencyPlaceholderKey of templateDependenciesPlaceholderKeys) {\n        let templateDependencyPlaceholder =\n          template.data.dependencies[templateDependencyPlaceholderKey]\n\n        let templateDependencyPlaceholderContractNames = Object.keys(\n          templateDependencyPlaceholder\n        )\n\n        for (let templateDependencyPlaceholderContractName of templateDependencyPlaceholderContractNames) {\n          let templateDependencyPlaceholderContractNetworks =\n            template.data.dependencies[templateDependencyPlaceholderKey][\n              templateDependencyPlaceholderContractName\n            ]\n\n          let templateDependency =\n            templateDependencyPlaceholderContractNetworks[network]\n          if (typeof templateDependency === \"undefined\") continue\n\n          let pin = await generateDependencyPin(\n            {\n              address: templateDependency.address,\n              contractName: templateDependency.contract,\n              blockHeight,\n            },\n            opts\n          )\n\n          if (pin !== templateDependency.pin) {\n            log({\n              title: \"verifyDependencyPinsSame Debug Error\",\n              message: `Could not recompute and match dependency pin.\n                                address: ${templateDependency.address} | contract: ${templateDependency.contract}\n                                computed: ${pin}\n                                template: ${templateDependency.pin}\n                            `,\n              level: LEVELS.debug,\n            })\n            return false\n          }\n        }\n      }\n\n      return true\n\n    default:\n      throw new Error(\n        \"verifyDependencyPinsSame Error: Unsupported template version\"\n      )\n  }\n}\n\n/**\n * @description Checks if an Interaction Template's pins match those generated at the latest block height\n * \n * @param {object} params\n * @param {object} params.template - Interaction Template to check pins for\n * @param {string} params.network - Network to check pins on\n * @param {object} opts\n * @returns {Promise<boolean>} - Whether or not the pins match\n */\nexport async function verifyDependencyPinsSameAtLatestSealedBlock(\n  {template, network},\n  opts = {}\n) {\n  let latestSealedBlock = await block({sealed: true})\n  let latestSealedBlockHeight = latestSealedBlock?.height\n\n  return verifyDependencyPinsSame(\n    {template, network, blockHeight: latestSealedBlockHeight},\n    opts\n  )\n}\n","import {invariant} from \"@onflow/sdk\"\n\n/**\n * @description Get Interaction Template argument message\n * \n * @param {object} params\n * @param {string} params.localization [localization=\"en-US\"] - Localization code\n * @param {string} params.messageKey - Message key\n * @param {object} params.template - Interaction Template\n * @returns {string} - Message\n */\nexport function getTemplateMessage({\n  localization = \"en-US\",\n  messageKey,\n  template,\n}) {\n  invariant(\n    messageKey,\n    \"getTemplateMessage({ messageKey }) -- messageKey must be defined\"\n  )\n  invariant(\n    typeof messageKey === \"string\",\n    \"getTemplateMessage({ messageKey }) -- messageKey must be a string\"\n  )\n\n  invariant(\n    localization,\n    \"getTemplateMessage({ localization }) -- localization must be defined\"\n  )\n  invariant(\n    typeof localization === \"string\",\n    \"getTemplateMessage({ localization }) -- localization must be a string\"\n  )\n\n  invariant(\n    template != undefined,\n    \"getTemplateMessage({ template }) -- template must be defined\"\n  )\n  invariant(\n    typeof template === \"object\",\n    \"getTemplateMessage({ template }) -- template must be an object\"\n  )\n  invariant(\n    typeof template.f_type === \"InteractionTemplate\",\n    \"getTemplateMessage({ template }) -- template object must be an InteractionTemplate\"\n  )\n\n  const messages = template?.data?.messages\n\n  return messages?.[messageKey]?.i18n?.[localization]\n}\n","import {invariant} from \"@onflow/sdk\"\n\n/**\n * @description Gets Interaction Template argument message by message key, argument label, and localization\n * \n * @param {object} opts\n * @param {string} opts.localization [localization=\"en-US\"] - Localization to get message for\n * @param {string} opts.argumentLabel - Argument label to get message for\n * @param {string} opts.messageKey - Message key to get message for\n * @param {object} opts.template - Interaction Template to get message from\n * @returns {string} - Message\n */\nexport function getTemplateArgumentMessage({\n  localization = \"en-US\",\n  argumentLabel,\n  messageKey,\n  template,\n}) {\n  invariant(\n    messageKey,\n    \"getTemplateArgumentMessage({ messageKey }) -- messageKey must be defined\"\n  )\n  invariant(\n    typeof messageKey === \"string\",\n    \"getTemplateArgumentMessage({ messageKey }) -- messageKey must be a string\"\n  )\n\n  invariant(\n    argumentLabel,\n    \"getTemplateArgumentMessage({ argumentLabel }) -- argumentLabel must be defined\"\n  )\n  invariant(\n    typeof messageKey === \"string\",\n    \"getTemplateArgumentMessage({ argumentLabel }) -- argumentLabel must be a string\"\n  )\n\n  invariant(\n    localization,\n    \"getTemplateArgumentMessage({ localization }) -- localization must be defined\"\n  )\n  invariant(\n    typeof localization === \"string\",\n    \"getTemplateArgumentMessage({ localization }) -- localization must be a string\"\n  )\n\n  invariant(\n    template != undefined,\n    \"getTemplateArgumentMessage({ template }) -- template must be defined\"\n  )\n  invariant(\n    typeof template === \"object\",\n    \"getTemplateArgumentMessage({ template }) -- template must be an object\"\n  )\n  invariant(\n    typeof template.f_type === \"InteractionTemplate\",\n    \"getTemplateArgumentMessage({ template }) -- template object must be an InteractionTemplate\"\n  )\n\n  const args = template?.data?.arguments\n\n  return args?.[argumentLabel]?.messages?.[messageKey]?.i18n?.[localization]\n}\n","export {VERSION} from \"./VERSION\"\nexport {query} from \"./exec/query\"\nexport {verifyUserSignatures} from \"./exec/verify\"\nexport {serialize} from \"./serialize\"\nexport {transaction as tx} from \"./transaction\"\nexport {events} from \"./events\"\nexport {pluginRegistry} from \"./current-user/exec-service/plugins\"\n\nimport {discovery} from \"./discovery\"\nexport {discovery}\n\nimport * as types from \"@onflow/types\"\n/**\n * @type {Types}\n */\nexport const t = types\n\nimport * as WalletUtils from \"./wallet-utils\"\nexport {WalletUtils}\n\nimport * as AppUtils from \"./app-utils\"\nexport {AppUtils}\n\nimport * as InteractionTemplateUtils from \"./interaction-template-utils\"\nexport {InteractionTemplateUtils}\n\nexport {getChainId} from \"./utils\"\n\nexport {TestUtils} from \"@onflow/sdk\"\n\nimport {config} from \"@onflow/config\"\nexport {config}\n\nexport {send} from \"@onflow/sdk\"\nexport {decode} from \"@onflow/sdk\"\nexport {account} from \"@onflow/sdk\"\nexport {block} from \"@onflow/sdk\"\nexport {isOk, isBad, why, pipe, build} from \"@onflow/sdk\"\nexport {withPrefix, sansPrefix, display} from \"@onflow/util-address\"\nexport {template as cadence} from \"@onflow/util-template\"\nexport {template as cdc} from \"@onflow/util-template\"\nexport {createSignableVoucher} from \"@onflow/sdk\"\nexport {voucherIntercept} from \"@onflow/sdk\"\nexport {voucherToTxId} from \"@onflow/sdk\"\n\n// builders\nexport {transaction} from \"@onflow/sdk\"\nexport {script} from \"@onflow/sdk\"\nexport {ping} from \"@onflow/sdk\"\nexport {atBlockHeight} from \"@onflow/sdk\"\nexport {atBlockId} from \"@onflow/sdk\"\nexport {getAccount} from \"@onflow/sdk\"\nexport {getEvents} from \"@onflow/sdk\"\nexport {getEventsAtBlockHeightRange} from \"@onflow/sdk\"\nexport {getEventsAtBlockIds} from \"@onflow/sdk\"\nexport {getBlock} from \"@onflow/sdk\"\nexport {getBlockHeader} from \"@onflow/sdk\"\nexport {getCollection} from \"@onflow/sdk\"\nexport {getTransactionStatus} from \"@onflow/sdk\"\nexport {getTransaction} from \"@onflow/sdk\"\nexport {getNetworkParameters} from \"@onflow/sdk\"\nexport {authorizations, authorization} from \"@onflow/sdk\"\nexport {args, arg} from \"@onflow/sdk\"\nexport {proposer} from \"@onflow/sdk\"\nexport {payer} from \"@onflow/sdk\"\nexport {limit} from \"@onflow/sdk\"\nexport {ref} from \"@onflow/sdk\"\nexport {params, param} from \"@onflow/sdk\"\nexport {validator} from \"@onflow/sdk\"\nexport {invariant} from \"@onflow/sdk\"\n\n/**\n * @typedef {object} Types\n * @property {any} Identity - Represents the Identity type.\n * @property {any} UInt - Represents the UInt type.\n * @property {any} Int - Represents the Int type.\n * @property {any} UInt8 - Represents the UInt8 type.\n * @property {any} Int8 - Represents the Int8 type.\n * @property {any} UInt16 - Represents the UInt16 type.\n * @property {any} Int16 - Represents the Int16 type.\n * @property {any} UInt32 - Represents the UInt32 type.\n * @property {any} Int32 - Represents the Int32 type.\n * @property {any} UInt64 - Represents the UInt64 type.\n * @property {any} Int64 - Represents the Int64 type.\n * @property {any} UInt128 - Represents the UInt128 type.\n * @property {any} Int128 - Represents the Int128 type.\n * @property {any} UInt256 - Represents the UInt256 type.\n * @property {any} Int256 - Represents the Int256 type.\n * @property {any} Word8 - Represents the Word8 type.\n * @property {any} Word16 - Represents the Word16 type.\n * @property {any} Word32 - Represents the Word32 type.\n * @property {any} Word64 - Represents the Word64 type.\n * @property {any} UFix64 - Represents the UFix64 type.\n * @property {any} Fix64 - Represents the Fix64 type.\n * @property {any} String - Represents the String type.\n * @property {any} Character - Represents the Character type.\n * @property {any} Bool - Represents the Bool type.\n * @property {any} Address - Represents the Address type.\n * @property {any} Void - Represents the Void type.\n * @property {any} Optional - Represents the Optional type.\n * @property {any} Reference - Represents the Reference type.\n * @property {any} Array - Represents the Array type.\n * @property {any} Dictionary - Represents the Dictionary type.\n * @property {any} Event - Represents the Event type.\n * @property {any} Resource - Represents the Resource type.\n * @property {any} Struct - Represents the Struct type.\n * @property {any} Enum - Represents the Enum type.\n * @property {any} Path - Represents the Path type.\n */\n\n/**\n * @callback ArgsFn\n * @param {ArgFn} arg - Argument function to define a single argument\n * @param {Types} t - Cadence Types object used to define the type\n * @returns {any[]}\n */\n\n/**\n * @callback ArgFn\n * @param {any} value - the value of the argument\n * @param {any} type - the cadence type of the value\n * @returns {any}\n */\n\nimport {watchForChainIdChanges} from \"./utils\"\n\n// Set chain id default on access node change\nwatchForChainIdChanges()\n","import {URL} from \"../utils/url\"\n\nexport async function fetchServices(servicesURL, code) {\n  if (servicesURL == null || code == null) return []\n\n  const url = new URL(servicesURL)\n  url.searchParams.append(\"code\", code)\n\n  const resp = await fetch(url, {\n    method: \"GET\",\n    headers: {\n      \"Content-Type\": \"application/json\",\n    },\n  }).then(d => d.json())\n\n  if (Array.isArray(resp)) return resp\n\n  // Backwards compatibility for First-Gen Wallet Providers\n  const services = []\n\n  // Convert authorizations into authz services\n  if (Array.isArray(resp.authorizations)) {\n    for (let service of resp.authorizations) {\n      services.push({\n        type: \"authz\",\n        keyId: resp.keyId,\n        ...service,\n      })\n    }\n  }\n\n  // Convert Provider info into an authn service\n  if (resp.provider != null) {\n    services.push({\n      type: \"authn\",\n      id: \"wallet-provider#authn\",\n      ...resp.provider,\n    })\n  }\n\n  return services\n}\n","export function mergeServices(sx1 = [], sx2 = []) {\n  // TODO: Make this smarter\n  return [...sx1, ...sx2]\n}\n","import {withPrefix} from \"@onflow/util-address\"\nimport {SERVICE_PRAGMA} from \"./__vsn\"\n\n// {\n//   \"f_type\": \"Service\",\n//   \"f_vsn\": \"1.0.0\",\n//   \"type\": \"authn\",\n//   \"uid\": \"uniqueDedupeKey\",\n//   \"endpoint\": \"https://rawr\",\n//   \"id\": \"xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx\", // wallets internal id for the user\n//   \"identity\": {\n//     \"address\": \"0x____\"\n//   },\n//   \"provider\": {\n//     \"address\": \"0x____\",\n//     \"name\": \"Best Wallet\",\n//     \"description\": \"The Best Wallet\"\n//     \"icon\": \"https://\",\n//   }\n// }\nexport function normalizeAuthn(service) {\n  if (service == null) return null\n\n  if (!service[\"f_vsn\"]) {\n    return {\n      ...SERVICE_PRAGMA,\n      type: service.type,\n      uid: service.id,\n      endpoint: service.authn,\n      id: service.pid,\n      provider: {\n        address: withPrefix(service.addr),\n        name: service.name,\n        icon: service.icon,\n      },\n    }\n  }\n\n  switch (service[\"f_vsn\"]) {\n    case \"1.0.0\":\n      return service\n\n    default:\n      return null\n  }\n}\n","import {withPrefix} from \"@onflow/util-address\"\nimport {SERVICE_PRAGMA, IDENTITY_PRAGMA} from \"./__vsn\"\n\n// {\n//   \"f_type\": \"service\",\n//   \"f_vsn\": \"1.0.0\",\n//   \"type\": \"authz\",\n//   \"uid\": \"uniqueDedupeKey\",\n//   \"endpoint\": \"https://rawr\",\n//   \"method\": \"HTTP/POST\", // HTTP/POST | IFRAME/RPC | HTTP/RPC\n//   \"identity\": {\n//      \"address\": \"0x______\",\n//      \"keyId\": 0,\n//   },\n//   \"data\": {}, // included in body of authz request\n//   \"params\": {}, // included as query params on endpoint url\n// }\nexport function normalizeAuthz(service) {\n  if (service == null) return null\n\n  if (!service[\"f_vsn\"]) {\n    return {\n      ...SERVICE_PRAGMA,\n      type: service.type,\n      uid: service.id,\n      endpoint: service.endpoint,\n      method: service.method,\n      identity: {\n        ...IDENTITY_PRAGMA,\n        address: withPrefix(service.addr),\n        keyId: service.keyId,\n      },\n      params: service.params,\n      data: service.data,\n    }\n  }\n\n  switch (service[\"f_vsn\"]) {\n    case \"1.0.0\":\n      return service\n\n    default:\n      return null\n  }\n}\n","import {withPrefix} from \"@onflow/util-address\"\nimport {SERVICE_PRAGMA, IDENTITY_PRAGMA} from \"./__vsn\"\n\n// {\n//   \"f_type\": \"service\",\n//   \"f_vsn\": \"1.0.0\",\n//   \"type\": \"pre-authz\",\n//   \"uid\": \"uniqueDedupeKey\",\n//   \"endpoint\": \"https://rawr\",\n//   \"method\": \"HTTP/POST\", // HTTP/POST | IFRAME/RPC | HTTP/RPC\n//   \"identity\": {\n//      \"address\": \"0x______\",\n//      \"keyId\": 0,\n//   },\n//   \"data\": {}, // included in body of pre-authz request\n//   \"params\": {}, // included as query params on endpoint url\n// }\nexport function normalizePreAuthz(service) {\n  if (service == null) return null\n\n  if (!service[\"f_vsn\"]) {\n    return {\n      ...SERVICE_PRAGMA,\n      type: service.type,\n      uid: service.id,\n      endpoint: service.endpoint,\n      method: service.method,\n      identity: {\n        ...IDENTITY_PRAGMA,\n        address: withPrefix(service.addr),\n        keyId: service.keyId,\n      },\n      params: service.params,\n      data: service.data,\n    }\n  }\n\n  switch (service[\"f_vsn\"]) {\n    case \"1.0.0\":\n      return service\n\n    default:\n      return null\n  }\n}\n","import {SERVICE_PRAGMA} from \"./__vsn\"\n\n// {\n//    \"f_type\": \"Service\",\n//    \"f_vsn\": \"1.0.0\",\n//    \"type\": \"frame\",\n//    \"endpoint\": \"https://rawr\",\n//    \"data\": {},   // Sent to frame when ready\n//    \"params\": {}, // include in query params on frame\n// }\nexport function normalizeFrame(service) {\n  if (service == null) return null\n\n  if (!service[\"f_vsn\"]) {\n    return {\n      old: service,\n      ...SERVICE_PRAGMA,\n      type: \"frame\",\n      endpoint: service.endpoint,\n      params: service.params || {},\n      data: service.data || {},\n    }\n  }\n\n  switch (service[\"f_vsn\"]) {\n    case \"1.0.0\":\n      return service\n\n    default:\n      return null\n  }\n}\n","import {SERVICE_PRAGMA} from \"./__vsn\"\n\n// {\n//    \"f_type\": \"Service\",\n//    \"f_vsn\": \"1.0.0\",\n//    \"type\": \"back-channel-rpc\",\n//    \"endpoint\": \"https://rawr\",\n//    \"method\": \"HTTP/GET\", // HTTP/GET | HTTP/POST\n//    \"data\": {},           // included in body of rpc\n//    \"params\": {},         // included as query params on endpoint url\n// }\nexport function normalizeBackChannelRpc(service) {\n  if (service == null) return null\n\n  if (!service[\"f_vsn\"]) {\n    return {\n      ...SERVICE_PRAGMA,\n      type: \"back-channel-rpc\",\n      endpoint: service.endpoint,\n      method: service.method,\n      params: service.params || {},\n      data: service.data || {},\n    }\n  }\n\n  switch (service[\"f_vsn\"]) {\n    case \"1.0.0\":\n      return service\n\n    default:\n      return null\n  }\n}\n","import {SERVICE_PRAGMA, OPEN_ID_PRAGMA} from \"./__vsn\"\n\n// {\n//   \"f_type\": \"Service\",\n//   \"f_vsn\": \"1.0.0\",\n//   \"type\": \"open-id\",\n//   \"uid\": \"uniqueDedupeKey\",\n//   \"method: \"data\",\n//   \"data\": {\n//      \"profile\": {\n//        \"name\": \"Bob\",\n//        \"family_name\": \"Builder\",\n//        \"given_name\": \"Robert\",\n//        \"middle_name\": \"the\",\n//        \"nickname\": \"Bob the Builder\",\n//        \"perferred_username\": \"bob\",\n//        \"profile\": \"https://www.bobthebuilder.com/\",\n//        \"picture\": \"https://avatars.onflow.org/avatar/bob\",\n//        \"gender\": \"...\",\n//        \"birthday\": \"2001-01-18\",\n//        \"zoneinfo\": \"America/Vancouver\",\n//        \"locale\": \"en-us\",\n//        \"updated_at\": \"1614970797388\"\n//      },\n//      \"email\": {\n//        \"email\": \"bob@bob.bob\",\n//        \"email_verified\": true\n//      },\n//      \"address\": {\n//        \"address\": \"One Apple Park Way, Cupertino, CA 95014, USA\"\n//      },\n//      \"phone\": {\n//        \"phone_number\": \"+1 (xxx) yyy-zzzz\",\n//        \"phone_number_verified\": true\n//      },\n//      \"social\": {\n//        \"twitter\": \"@_qvvg\",\n//        \"twitter_verified\": true\n//      },\n//   }\n// }\nexport function normalizeOpenId(service) {\n  if (service == null) return null\n\n  switch (service[\"f_vsn\"]) {\n    case \"1.0.0\":\n      return service\n\n    default:\n      return null\n  }\n}\n","// {\n//   \"f_type\": \"Service\",\n//   \"f_vsn\": \"1.0.0\",\n//   \"type\": \"user-signature\",\n//   \"uid\": \"uniqueDedupeKey\",\n//   \"endpoint\": \"https://rawr\",\n//   \"method\": \"IFRAME/RPC\", // HTTP/POST | IFRAME/RPC | HTTP/RPC\n//   \"id\": \"xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx\", // wallets internal id for the user\n//   \"data\": {}, // included in body of user-signature request\n//   \"params\": {}, // included as query params on endpoint url\n// }\nexport function normalizeUserSignature(service) {\n  if (service == null) return null\n\n  if (!service[\"f_vsn\"]) {\n    throw new Error(\"Invalid user-signature service\")\n  }\n\n  switch (service[\"f_vsn\"]) {\n    case \"1.0.0\":\n      return service\n\n    default:\n      return null\n  }\n}\n","import {SERVICE_PRAGMA} from \"./__vsn\"\n\n// {\n//    \"f_type\": \"Service\",\n//    \"f_vsn\": \"1.0.0\",\n//    type: \"local-view\",\n//    method: \"VIEW/IFRAME\",\n//    endpoint: \"https://woot.org/authz/local\",\n//    data: {},\n//    params: {},\n// }\nexport function normalizeLocalView(resp) {\n  if (resp == null) return null\n  if (resp.method == null) {\n    resp = {...resp, type: \"local-view\", method: \"VIEW/IFRAME\"}\n  }\n\n  if (!resp[\"f_vsn\"]) {\n    return {\n      ...SERVICE_PRAGMA,\n      type: resp.type || \"local-view\",\n      method: resp.method,\n      endpoint: resp.endpoint,\n      data: resp.data || {},\n      params: resp.params || {},\n    }\n  }\n\n  switch (resp[\"f_vsn\"]) {\n    case \"1.0.0\":\n      return resp\n\n    default:\n      return null\n  }\n}\n","// {\n//   \"f_type\": \"Service\",                    // Its a service!\n//   \"f_vsn\": \"1.0.0\",                       // Follows the v1.0.0 spec for the service\n//   \"type\": \"account-proof\",                // the type of service it is\n//   \"method\": \"DATA\",                       // Its data!\n//   \"uid\": \"awesome-wallet#account-proof\",  // A unique identifier for the service\n//   \"data\": {\n//     \"f_type\": \"account-proof\",\n//     \"f_vsn\": \"1.0.0\",\n//     \"nonce\": \"0A1BC2FF\",                  // Nonce signed by the current account-proof (minimum 32 bytes in total, i.e 64 hex characters)\n//     \"address\": \"0xUSER\",                  // The user's address (8 bytes, i.e 16 hex characters)\n//     \"signature\": CompositeSignature,      // address (sans-prefix), keyId, signature (hex)\n// }\n\nexport function normalizeAccountProof(service) {\n  if (service == null) return null\n\n  if (!service[\"f_vsn\"]) {\n    throw new Error(`FCL Normalizer Error: Invalid account-proof service`)\n  }\n\n  switch (service[\"f_vsn\"]) {\n    case \"1.0.0\":\n      return service\n\n    default:\n      return null\n  }\n}\n","// {\n//   \"f_type\": \"Service\",\n//   \"f_vsn\": \"1.0.0\",\n//   \"type\": \"authn-refresh\",\n//   \"uid\": \"uniqueDedupeKey\",\n//   \"endpoint\": \"https://rawr\",\n//   \"method\": \"HTTP/POST\",  // \"HTTP/POST\", // HTTP/POST | IFRAME/RPC | HTTP/RPC\n//   \"id\": \"xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx\", // wallets internal id for the user\n//   \"data\": {}, // included in body of request\n//   \"params\": {}, // included as query params on endpoint url\n// }\nexport function normalizeAuthnRefresh(service) {\n  if (service == null) return null\n\n  if (!service[\"f_vsn\"]) {\n    throw new Error(\"Invalid authn-refresh service\")\n  }\n\n  switch (service[\"f_vsn\"]) {\n    case \"1.0.0\":\n      return service\n\n    default:\n      return null\n  }\n}\n","import {normalizeAuthn} from \"./authn\"\nimport {normalizeAuthz} from \"./authz\"\nimport {normalizePreAuthz} from \"./pre-authz\"\nimport {normalizeFrame} from \"./frame\"\nimport {normalizeBackChannelRpc} from \"./back-channel-rpc\"\nimport {normalizeOpenId} from \"./open-id\"\nimport {normalizeUserSignature} from \"./user-signature\"\nimport {normalizeLocalView} from \"./local-view\"\nimport {normalizeAccountProof} from \"./account-proof\"\nimport {normalizeAuthnRefresh} from \"./authn-refresh\"\n\nexport function normalizeServices(services, data) {\n  return services\n    .map(service => normalizeService(service, data))\n    .filter(Boolean)\n}\n\nconst serviceNormalizers = {\n  \"back-channel-rpc\": normalizeBackChannelRpc,\n  \"pre-authz\": normalizePreAuthz,\n  authz: normalizeAuthz,\n  authn: normalizeAuthn,\n  frame: normalizeFrame,\n  \"open-id\": normalizeOpenId,\n  \"user-signature\": normalizeUserSignature,\n  \"local-view\": normalizeLocalView,\n  \"account-proof\": normalizeAccountProof,\n  \"authn-refresh\": normalizeAuthnRefresh,\n}\n\nexport function normalizeService(service, data) {\n  try {\n    var normalized = serviceNormalizers[service.type](service, data)\n    return normalized\n  } catch (error) {\n    console.error(\n      `Unrecognized FCL Service Type [${service.type}]`,\n      service,\n      error\n    )\n    return service\n  }\n}\n","import * as semver from \"@onflow/util-semver\"\n\nexport function serviceOfType(services = [], type) {\n  // Find the greatest version of the service type\n  return services.reduce(\n    (mostRecent, service) =>\n      service.type === type\n        ? !mostRecent || semver.compare(service.f_vsn, mostRecent.f_vsn) > 0\n          ? service\n          : mostRecent\n        : mostRecent,\n    null\n  )\n}\n","import {withPrefix} from \"@onflow/util-address\"\nimport * as rlp from \"@onflow/rlp\"\nimport {fetchServices} from \"./fetch-services\"\nimport {mergeServices} from \"./merge-services\"\nimport {USER_PRAGMA} from \"../normalizers/service/__vsn\"\nimport {\n  normalizeService,\n  normalizeServices,\n} from \"../normalizers/service/service\"\nimport {serviceOfType} from \"./service-of-type\"\n\nfunction deriveCompositeId(authn) {\n  return rlp\n    .encode([\n      authn.provider.address || authn.provider.name || \"UNSPECIFIED\",\n      authn.id,\n    ])\n    .toString(\"hex\")\n}\n\nfunction normalizeData(data) {\n  data.addr = data.addr ? withPrefix(data.addr) : null\n  data.paddr = data.paddr ? withPrefix(data.paddr) : null\n  return data\n}\n\nexport async function buildUser(data) {\n  data = normalizeData(data)\n\n  var services = normalizeServices(\n    mergeServices(data.services || [], await fetchServices(data.hks, data.code))\n  )\n\n  const authn = serviceOfType(services, \"authn\")\n\n  return {\n    ...USER_PRAGMA,\n    addr: withPrefix(data.addr),\n    cid: deriveCompositeId(authn),\n    loggedIn: true,\n    services: services,\n    expiresAt: data.expires,\n  }\n}\n","import {invariant} from \"@onflow/util-invariant\"\nimport {log, LEVELS} from \"@onflow/util-logger\"\nimport {getServiceRegistry} from \"./plugins\"\nimport {getChainId} from \"../../utils\"\nimport {VERSION} from \"../../VERSION\"\nimport {configLens} from \"../../default-config\"\nconst execStrategy = async ({service, body, config, opts}) => {\n  const strategy = getServiceRegistry().getStrategy(service.method)\n  return strategy({service, body, config, opts})\n}\n\nexport async function execService({service, msg = {}, config = {}, opts = {}, platform}) {\n  msg.data = service.data\n  const execConfig = {\n    services: await configLens(/^service\\./),\n    app: await configLens(/^app\\.detail\\./),\n    client: {\n      ...config.client,\n      platform,\n      fclVersion: VERSION,\n      fclLibrary: \"https://github.com/onflow/fcl-js\",\n      hostname: window?.location?.hostname ?? null,\n      network: await getChainId(opts),\n    },\n  }\n\n  try {\n    const res = await execStrategy({\n      service,\n      body: msg,\n      config: execConfig,\n      opts,\n    })\n    if (res.status === \"REDIRECT\") {\n      invariant(\n        service.type === res.data.type,\n        \"Cannot shift recursive service type in execService\"\n      )\n      return await execService({\n        service: res.data,\n        msg,\n        config: execConfig,\n        opts,\n      })\n    } else {\n      return res\n    }\n  } catch (error) {\n    log({\n      title: `Error on execService ${service?.type}`,\n      message: error,\n      level: LEVELS.error,\n    })\n    throw error\n  }\n}\n","import {COMPOSITE_SIGNATURE_PRAGMA} from \"./__vsn\"\nimport {sansPrefix} from \"@onflow/util-address\"\n\n// {\n//    \"f_type\": \"CompositeSignature\",\n//    \"f_vsn\": \"1.0.0\",\n//    \"addr\": \"_____\",         // sans-prefix\n//    \"signature\": \"adfe1234\", // hex\n//    \"keyId\": 3,\n// }\nexport function normalizeCompositeSignature(resp) {\n  if (resp == null) return null\n\n  if (!resp[\"f_vsn\"]) {\n    return {\n      ...COMPOSITE_SIGNATURE_PRAGMA,\n      addr: sansPrefix(resp.addr || resp.address),\n      signature: resp.signature || resp.sig,\n      keyId: resp.keyId,\n    }\n  }\n\n  switch (resp[\"f_vsn\"]) {\n    case \"1.0.0\":\n      return resp\n\n    default:\n      return null\n  }\n}\n","import \"../default-config\"\nimport * as t from \"@onflow/types\"\nimport {account, arg} from \"@onflow/sdk\"\nimport {config} from \"@onflow/config\"\nimport {spawn, send, INIT, SUBSCRIBE, UNSUBSCRIBE} from \"@onflow/util-actor\"\nimport {withPrefix, sansPrefix} from \"@onflow/util-address\"\nimport {invariant} from \"@onflow/util-invariant\"\nimport {log, LEVELS} from \"@onflow/util-logger\"\nimport {buildUser} from \"./build-user\"\nimport {serviceOfType} from \"./service-of-type\"\nimport {execService} from \"./exec-service\"\nimport {normalizeCompositeSignature} from \"../normalizers/service/composite-signature\"\nimport {getDiscoveryService, makeDiscoveryServices} from \"../discovery\"\nimport {getServiceRegistry} from \"./exec-service/plugins\"\nimport {isMobile} from \"../utils\"\n\n/**\n * @typedef {import(\"@onflow/typedefs\").CurrentUser} CurrentUser\n * @typedef {import(\"@onflow/typedefs\").CompositeSignature} CompositeSignature\n */\n\nexport const isFn = d => typeof d === \"function\"\n\nconst NAME = \"CURRENT_USER\"\nconst UPDATED = \"CURRENT_USER/UPDATED\"\nconst SNAPSHOT = \"SNAPSHOT\"\nconst SET_CURRENT_USER = \"SET_CURRENT_USER\"\nconst DEL_CURRENT_USER = \"DEL_CURRENT_USER\"\n\nconst DATA = `{\n  \"f_type\": \"User\",\n  \"f_vsn\": \"1.0.0\",\n  \"addr\":null,\n  \"cid\":null,\n  \"loggedIn\":null,\n  \"expiresAt\":null,\n  \"services\":[]\n}`\n\nconst getStoredUser = async storage => {\n  const fallback = JSON.parse(DATA)\n  const stored = await storage.get(NAME)\n  if (stored != null && fallback[\"f_vsn\"] !== stored[\"f_vsn\"]) {\n    storage.removeItem(NAME)\n    return fallback\n  }\n  return stored || fallback\n}\n\nconst HANDLERS = {\n  [INIT]: async ctx => {\n    if (typeof window === \"undefined\") {\n      console.warn(\n        `\n        %cFCL Warning\n        ============================\n        \"currentUser\" is only available in the browser.\n        For more info, please see the docs: https://docs.onflow.org/fcl/\n        ============================\n        `,\n        \"font-weight:bold;font-family:monospace;\"\n      )\n    }\n\n    ctx.merge(JSON.parse(DATA))\n    const storage = await config.first([\"fcl.storage\", \"fcl.storage.default\"])\n    if (storage.can) {\n      const user = await getStoredUser(storage)\n      if (notExpired(user)) ctx.merge(user)\n    }\n  },\n  [SUBSCRIBE]: (ctx, letter) => {\n    ctx.subscribe(letter.from)\n    ctx.send(letter.from, UPDATED, {...ctx.all()})\n  },\n  [UNSUBSCRIBE]: (ctx, letter) => {\n    ctx.unsubscribe(letter.from)\n  },\n  [SNAPSHOT]: async (ctx, letter) => {\n    letter.reply({...ctx.all()})\n  },\n  [SET_CURRENT_USER]: async (ctx, letter, data) => {\n    ctx.merge(data)\n    const storage = await config.first([\"fcl.storage\", \"fcl.storage.default\"])\n    if (storage.can) storage.put(NAME, ctx.all())\n    ctx.broadcast(UPDATED, {...ctx.all()})\n  },\n  [DEL_CURRENT_USER]: async (ctx, letter) => {\n    ctx.merge(JSON.parse(DATA))\n    const storage = await config.first([\"fcl.storage\", \"fcl.storage.default\"])\n    if (storage.can) storage.put(NAME, ctx.all())\n    ctx.broadcast(UPDATED, {...ctx.all()})\n  },\n}\n\nconst spawnCurrentUser = () => spawn(HANDLERS, NAME)\n\nfunction notExpired(user) {\n  return (\n    user.expiresAt == null ||\n    user.expiresAt === 0 ||\n    user.expiresAt > Date.now()\n  )\n}\n\nasync function getAccountProofData() {\n  let accountProofDataResolver = await config.get(\"fcl.accountProof.resolver\")\n  if (accountProofDataResolver == null) return\n  if (!isFn(accountProofDataResolver)) {\n    log({\n      title: \"Account Proof Data Resolver must be a function\",\n      message: `Check fcl.accountProof.resolver configuration.\n                Expected: fcl.accountProof.resolver: async () => { ... }\n                Received: fcl.accountProof.resolver: ${typeof accountProofDataResolver}\n                `,\n      level: LEVELS.warn,\n    })\n    return\n  }\n\n  const accountProofData = await accountProofDataResolver()\n  if (accountProofData == null) return\n\n  invariant(\n    typeof accountProofData.appIdentifier === \"string\",\n    \"appIdentifier must be a string\"\n  )\n  invariant(\n    /^[0-9a-f]+$/i.test(accountProofData.nonce),\n    \"Nonce must be a hex string\"\n  )\n\n  return accountProofData\n}\n\nconst makeConfig = async ({discoveryAuthnInclude, discoveryFeaturesSuggested}) => {\n  return {\n    client: {\n      discoveryAuthnInclude,\n      discoveryFeaturesSuggested,\n      clientServices: await makeDiscoveryServices(),\n      supportedStrategies: getServiceRegistry().getStrategies(),\n    },\n  }\n}\n\n/**\n * @description - Authenticate a user\n * @param {object} [opts] - Options\n * @param {object} [opts.platform] - platform that runs the function\n * @param {object} [opts.service] - Optional service to use for authentication\n * @param {boolean} [opts.redir=false] - Optional flag to allow window to stay open after authentication\n * @returns {function(*)Promise<CurrentUser>} - User object\n */\nconst getAuthenticate =\n  ({platform}) =>\n  async ({service, redir = false} = {}) => {\n    if (\n      service &&\n      !service?.provider?.is_installed &&\n      service?.provider?.requires_install\n    ) {\n      window.location.href = service?.provider?.install_link\n      return\n    }\n\n    return new Promise(async (resolve, reject) => {\n      spawnCurrentUser()\n      const opts = {redir}\n      const user = await snapshot()\n      const discoveryService = await getDiscoveryService(service)\n      const refreshService = serviceOfType(user.services, \"authn-refresh\")\n      let accountProofData\n\n      if (user.loggedIn) {\n        if (refreshService) {\n          try {\n            const response = await execService({\n              service: refreshService,\n              msg: accountProofData,\n              opts,\n              platform,\n            })\n            send(NAME, SET_CURRENT_USER, await buildUser(response))\n          } catch (error) {\n            log({\n              title: `${error.name} Could not refresh wallet authentication.`,\n              message: error.message,\n              level: LEVELS.error,\n            })\n          } finally {\n            return resolve(await snapshot())\n          }\n        } else {\n          return resolve(user)\n        }\n      }\n\n      try {\n        accountProofData = await getAccountProofData()\n      } catch (error) {\n        log({\n          title: `${error.name} On Authentication: Could not resolve account proof data.`,\n          message: error.message,\n          level: LEVELS.error,\n        })\n        return reject(error)\n      }\n\n      try {\n        const response = await execService({\n          service: discoveryService,\n          msg: accountProofData,\n          config: await makeConfig(discoveryService),\n          opts,\n          platform,\n        })\n        send(NAME, SET_CURRENT_USER, await buildUser(response))\n      } catch (error) {\n        log({\n          title: `${error} On Authentication`,\n          message: error,\n          level: LEVELS.error,\n        })\n      } finally {\n        resolve(await snapshot())\n      }\n    })\n  }\n\n/**\n * @description - Unauthenticate a user\n * @returns {void}\n */\nfunction unauthenticate() {\n  spawnCurrentUser()\n  send(NAME, DEL_CURRENT_USER)\n}\n\nconst normalizePreAuthzResponse = authz => ({\n  f_type: \"PreAuthzResponse\",\n  f_vsn: \"1.0.0\",\n  proposer: (authz || {}).proposer,\n  payer: (authz || {}).payer || [],\n  authorization: (authz || {}).authorization || [],\n})\n\nconst getResolvePreAuthz =\n  ({platform}) =>\n  authz => {\n    const resp = normalizePreAuthzResponse(authz)\n    const axs = []\n\n    if (resp.proposer != null) axs.push([\"PROPOSER\", resp.proposer])\n    for (let az of resp.payer || []) axs.push([\"PAYER\", az])\n    for (let az of resp.authorization || []) axs.push([\"AUTHORIZER\", az])\n\n    var result = axs.map(([role, az]) => ({\n      tempId: [az.identity.address, az.identity.keyId].join(\"|\"),\n      addr: az.identity.address,\n      keyId: az.identity.keyId,\n      signingFunction(signable) {\n        return execService({service: az, msg: signable, platform})\n      },\n      role: {\n        proposer: role === \"PROPOSER\",\n        payer: role === \"PAYER\",\n        authorizer: role === \"AUTHORIZER\",\n      },\n    }))\n    return result\n  }\n\n/**\n * @description\n * Produces the needed authorization details for the current user to submit transactions to Flow\n * It defines a signing function that connects to a user's wallet provider to produce signatures to submit transactions.\n *\n * @param {object} ops - running options\n * @param {string} ops.platform - platform that runs the function\n * @param {object} account - Account object\n * @returns {Promise<object>} - Account object with signing function\n */\nconst getAuthorization =\n  ({platform}) =>\n  async account => {\n    spawnCurrentUser()\n\n    return {\n      ...account,\n      tempId: \"CURRENT_USER\",\n      async resolve(account, preSignable) {\n        const user = await getAuthenticate({platform})({redir: true})\n        const authz = serviceOfType(user.services, \"authz\")\n        const preAuthz = serviceOfType(user.services, \"pre-authz\")\n\n        if (preAuthz)\n          return getResolvePreAuthz({platform})(\n            await execService({\n              service: preAuthz,\n              msg: preSignable,\n              platform,\n            })\n          )\n        if (authz) {\n          let windowRef\n          if (isMobile() && authz.method === \"WC/RPC\") {\n            windowRef = window.open(\"\", \"_blank\")\n          }\n          return {\n            ...account,\n            tempId: \"CURRENT_USER\",\n            resolve: null,\n            addr: sansPrefix(authz.identity.address),\n            keyId: authz.identity.keyId,\n            sequenceNum: null,\n            signature: null,\n            async signingFunction(signable) {\n              return normalizeCompositeSignature(\n                await execService({\n                  service: authz,\n                  msg: signable,\n                  opts: {\n                    includeOlderJsonRpcCall: true,\n                    windowRef,\n                  },\n                  platform,\n                })\n              )\n            },\n          }\n        }\n        throw new Error(\n          \"No Authz or PreAuthz Service configured for CURRENT_USER\"\n        )\n      },\n    }\n  }\n\n/**\n * @description\n * The callback passed to subscribe will be called when the user authenticates and un-authenticates, making it easy to update the UI accordingly.\n *\n * @param {Function} callback - Callback function\n * @returns {Function} - Unsubscribe function\n */\nfunction subscribe(callback) {\n  spawnCurrentUser()\n  const EXIT = \"@EXIT\"\n  const self = spawn(async ctx => {\n    ctx.send(NAME, SUBSCRIBE)\n    while (1) {\n      const letter = await ctx.receive()\n      if (letter.tag === EXIT) {\n        ctx.send(NAME, UNSUBSCRIBE)\n        return\n      }\n      callback(letter.data)\n    }\n  })\n  return () => send(self, EXIT)\n}\n\n/**\n * @description - Gets the current user\n * @returns {Promise<CurrentUser>} - User object\n */\nfunction snapshot() {\n  spawnCurrentUser()\n  return send(NAME, SNAPSHOT, null, {expectReply: true, timeout: 0})\n}\n\nasync function info() {\n  spawnCurrentUser()\n  const {addr} = await snapshot()\n  if (addr == null) throw new Error(\"No Flow Address for Current User\")\n  return account(addr)\n}\n\n/**\n * @description - Resolves the current user as an argument\n *\n * @param {object} ops - running options\n * @param {string} ops.platform - platform that runs the function\n * @returns {Promise<Function>}\n */\nconst getResolveArgument =\n  ({platform}) =>\n  async () => {\n    const {addr} = await getAuthenticate({platform})()\n    return arg(withPrefix(addr), t.Address)\n  }\n\nconst makeSignable = msg => {\n  invariant(/^[0-9a-f]+$/i.test(msg), \"Message must be a hex string\")\n\n  return {\n    message: msg,\n  }\n}\n\n/**\n * @description - A method to use allowing the user to personally sign data via FCL Compatible Wallets/Services.\n * @param {string} msg - Message to sign\n * @returns {Promise<CompositeSignature[]>} - Array of CompositeSignatures\n */\nconst getSignUserMessage =\n  ({platform}) =>\n  async msg => {\n    spawnCurrentUser()\n    const user = await getAuthenticate({platform})({redir: true})\n\n    const signingService = serviceOfType(user.services, \"user-signature\")\n\n    invariant(\n      signingService,\n      \"Current user must have authorized a signing service.\"\n    )\n\n    try {\n      const response = await execService({\n        service: signingService,\n        msg: makeSignable(msg),\n        platform,\n      })\n      if (Array.isArray(response)) {\n        return response.map(compSigs => normalizeCompositeSignature(compSigs))\n      } else {\n        return [normalizeCompositeSignature(response)]\n      }\n    } catch (error) {\n      return error\n    }\n  }\n\nconst getCurrentUser = ({platform}) => {\n  let currentUser = () => {\n    return {\n      authenticate: getAuthenticate({platform}),\n      unauthenticate,\n      authorization: getAuthorization({platform}),\n      signUserMessage: getSignUserMessage({platform}),\n      subscribe,\n      snapshot,\n      resolveArgument: getResolveArgument({platform}),\n    }\n  }\n\n  currentUser.authenticate = getAuthenticate({platform})\n  currentUser.unauthenticate = unauthenticate\n  currentUser.authorization = getAuthorization({platform})\n  currentUser.signUserMessage = getSignUserMessage({platform})\n  currentUser.subscribe = subscribe\n  currentUser.snapshot = snapshot\n  currentUser.resolveArgument = getResolveArgument({platform})\n\n  return currentUser\n}\n\nexport {getCurrentUser}\n","import * as sdk from \"@onflow/sdk\"\nimport {normalizeArgs} from \"./utils/normalize-args\"\nimport {getCurrentUser} from \"../current-user\"\nimport {prepTemplateOpts} from \"./utils/prep-template-opts.js\"\nimport {preMutate} from \"./utils/pre.js\"\nimport {isNumber} from \"../utils/is\"\n\nexport const getMutate = ({platform}) => {\n  /**\n   * @description\n   * Allows you to submit transactions to the blockchain to potentially mutate the state.\n   *\n   * @param {object} [opts] - Mutation Options and configuration\n   * @param {string} [opts.cadence] - Cadence Transaction used to mutate Flow\n   * @param {import(\"../shared-exports\").ArgsFn} [opts.args] - Arguments passed to cadence transaction\n   * @param {object | string} [opts.template] - Interaction Template for a transaction\n   * @param {number} [opts.limit] - Compute Limit for transaction\n   * @param {Function} [opts.authz] - Authorization function for transaction\n   * @param {Function} [opts.proposer] - Proposer Authorization function for transaction\n   * @param {Function} [opts.payer] - Payer Authorization function for transaction\n   * @param {Array<Function>} [opts.authorizations] - Authorizations function for transaction\n   * @returns {Promise<string>} Transaction Id\n   *\n   * @example\n   * fcl.mutate({\n   *   cadence: `\n   *     transaction(a: Int, b: Int, c: Address) {\n   *       prepare(acct: AuthAccount) {\n   *         log(acct)\n   *         log(a)\n   *         log(b)\n   *         log(c)\n   *       }\n   *     }\n   *   `,\n   *   args: (arg, t) => [\n   *     arg(6, t.Int),\n   *     arg(7, t.Int),\n   *     arg(\"0xba1132bc08f82fe2\", t.Address),\n   *   ],\n   * })\n   *\n   *\n   * Options:\n   * type Options = {\n   *   template: InteractionTemplate | String // InteractionTemplate or url to one\n   *   cadence: String!,\n   *   args: (arg, t) => Array<Arg>,\n   *   limit: Number,\n   *   authz: AuthzFn, // will overload the trinity of signatory roles\n   *   proposer: AuthzFn, // will overload the proposer signatory role\n   *   payer: AuthzFn, // will overload the payer signatory role\n   *   authorizations: [AuthzFn], // an array of authorization functions used as authorizations signatory roles\n   * }\n   */\n  const mutate = async (opts = {}) => {\n    var txid\n    try {\n      await preMutate(opts)\n      opts = await prepTemplateOpts(opts)\n      const currentUser = getCurrentUser({platform})\n      // Allow for a config to overwrite the authorization function.\n      // prettier-ignore\n      const authz = await sdk.config().get(\"fcl.authz\", currentUser().authorization)\n\n      txid = sdk.config().overload(opts.dependencies || {}, async () =>\n        // prettier-ignore\n        sdk.send([\n        sdk.transaction(opts.cadence),\n\n        sdk.args(normalizeArgs(opts.args || [])),\n\n        opts.limit && isNumber(opts.limit) && sdk.limit(opts.limit),\n\n        // opts.proposer > opts.authz > authz\n        sdk.proposer(opts.proposer || opts.authz || authz),\n\n        // opts.payer > opts.authz > authz\n        sdk.payer(opts.payer || opts.authz || authz),\n\n        // opts.authorizations > [opts.authz > authz]\n        sdk.authorizations(opts.authorizations || [opts.authz || authz]),\n      ]).then(sdk.decode)\n      )\n\n      return txid\n    } catch (error) {\n      throw error\n    }\n  }\n\n  return mutate\n}\n","import {invariant} from \"@onflow/util-invariant\"\n\nconst FRAME = \"FCL_IFRAME\"\n\nconst FRAME_STYLES = `\n  position:fixed;\n  top: 0px;\n  right: 0px;\n  bottom: 0px;\n  left: 0px;\n  height: 100%;\n  width: 100vw;\n  display:block;\n  background:rgba(0,0,0,0.25);\n  z-index: 2147483647;\n  box-sizing: border-box;\n  color-scheme: light;\n`\n\nexport function renderFrame(src) {\n  invariant(\n    !document.getElementById(FRAME),\n    \"Attempt at triggering multiple Frames\",\n    {src}\n  )\n\n  const $frame = document.createElement(\"iframe\")\n  $frame.src = src\n  $frame.id = FRAME\n  $frame.allow = \"usb *; hid *\"\n  $frame.frameBorder = \"0\"\n  $frame.style.cssText = FRAME_STYLES\n  document.body.append($frame)\n\n  const unmount = () => {\n    if (document.getElementById(FRAME)) {\n      document.getElementById(FRAME).remove()\n    }\n  }\n\n  return [$frame.contentWindow, unmount]\n}\n","const POP = \"FCL_POP\"\n\nlet popup = null\nlet previousUrl = null\n\nfunction popupWindow(url, windowName, win, w, h) {\n  const y = win.top.outerHeight / 2 + win.top.screenY - h / 2\n  const x = win.top.outerWidth / 2 + win.top.screenX - w / 2\n  const popup = win.open(\n    url,\n    windowName,\n    `toolbar=no, location=no, directories=no, status=no, menubar=no, scrollbars=no, resizable=no, copyhistory=no, width=${w}, height=${h}, top=${y}, left=${x}`\n  )\n  if (!popup)\n    throw new Error(\"Popup failed to open (was it blocked by a popup blocker?)\")\n  return popup\n}\n\nexport function renderPop(src) {\n  if (popup == null || popup?.closed) {\n    popup = popupWindow(src, POP, window, 640, 770)\n  } else if (previousUrl !== src) {\n    popup.location.replace(src)\n    popup.focus()\n  } else {\n    popup.focus()\n  }\n\n  previousUrl = src\n\n  const unmount = () => {\n    if (popup && !popup.closed) {\n      popup.close()\n    }\n    popup = null\n  }\n\n  return [popup, unmount]\n}\n","const TAB = \"FCL_TAB\"\n\nlet tab = null\nlet previousUrl = null\n\nexport function renderTab(src) {\n  if (tab == null || tab?.closed) {\n    tab = window.open(src, \"_blank\")\n    if (!tab)\n      throw new Error(\"Tab failed to open (was it blocked by the browser?)\")\n  } else if (previousUrl !== src) {\n    tab.location.replace(src)\n    tab.focus()\n  } else {\n    tab.focus()\n  }\n\n  previousUrl = src\n\n  const unmount = () => {\n    if (tab && !tab.closed) {\n      tab.close()\n    }\n    tab = null\n  }\n\n  return [tab, unmount]\n}\n","const isServerSide = () => typeof window === \"undefined\"\n\nconst getSessionStorage = () => {\n  try {\n    const SESSION_STORAGE = {\n      can: !isServerSide(),\n      get: async key => JSON.parse(sessionStorage.getItem(key)),\n      put: async (key, value) => sessionStorage.setItem(key, JSON.stringify(value)),\n    }\n    return SESSION_STORAGE\n  } catch (error) {\n    return null\n  }\n}\n\nexport const getDefaultConfig = () => {\n  return {\n    \"discovery.wallet.method.default\": \"IFRAME/RPC\",\n    \"fcl.storage.default\": getSessionStorage(),\n  }\n}\n","import {URL} from \"../../../../utils/url\"\n\nexport function serviceEndpoint(service) {\n  const url = new URL(service.endpoint)\n  if (window?.location?.origin) {\n    url.searchParams.append(\"l6n\", window.location.origin)\n  }\n  if (service.params != null) {\n    for (let [key, value] of Object.entries(service.params || {})) {\n      url.searchParams.append(key, value)\n    }\n  }\n  return url\n}\n","import {serviceEndpoint} from \"./service-endpoint\"\n\nexport function fetchService(service, opts = {}) {\n  const method = opts.method || \"POST\"\n  const body =\n    method === \"GET\"\n      ? undefined\n      : JSON.stringify(opts.data || service.data || {})\n\n  return fetch(serviceEndpoint(service), {\n    method: method,\n    headers: {\n      ...(service.headers || {}),\n      ...(opts.headers || {}),\n      \"Content-Type\": \"application/json\",\n    },\n    body: body,\n  }).then(d => d.json())\n}\n","import {POLLING_RESPONSE_PRAGMA} from \"./__vsn\"\nimport {normalizeBackChannelRpc} from \"./back-channel-rpc\"\nimport {normalizeFrame} from \"./frame\"\n\n// {\n//    \"f_type\": \"PollingResponse\",\n//    \"f_vsn\": \"1.0.0\",\n//    \"status\": \"PENDING\", // PENDING | APPROVED | DECLINED | REDIRECT\n//    \"reason\": null,      // Reason for Declining Transaction\n//    \"data\": null,        // Return value for APPROVED\n//    \"updates\": BackChannelRpc,\n//    \"local\": Frame,\n// }\nexport function normalizePollingResponse(resp) {\n  if (resp == null) return null\n\n  if (!resp[\"f_vsn\"]) {\n    return {\n      ...POLLING_RESPONSE_PRAGMA,\n      status: resp.status ?? \"APPROVED\",\n      reason: resp.reason ?? null,\n      data: resp.compositeSignature || resp.data || {...resp} || {},\n      updates: normalizeBackChannelRpc(resp.authorizationUpdates),\n      local: normalizeFrame((resp.local || [])[0]),\n    }\n  }\n\n  switch (resp[\"f_vsn\"]) {\n    case \"1.0.0\":\n      return resp\n\n    default:\n      return null\n  }\n}\n","import {normalizePollingResponse} from \"../../../../normalizers/service/polling-response\"\nimport {invariant} from \"@onflow/util-invariant\"\nimport {fetchService} from \"./fetch-service\"\n\nconst OPTIONS = {\n  \"HTTP/GET\": \"GET\",\n  \"HTTP/POST\": \"POST\",\n}\n\nconst serviceMethod = service => {\n  invariant(\n    OPTIONS[service.method],\n    \"Invalid Service Method for type back-channel-rpc\",\n    {service}\n  )\n  return OPTIONS[service.method]\n}\n\nconst serviceBody = service => {\n  if (service.method === \"HTTP/GET\") return undefined\n  if (service.method === \"HTTP/POST\" && service.data != null)\n    return JSON.stringify(service.data)\n  return undefined\n}\n\nexport async function poll(service, checkCanContinue = () => true) {\n  invariant(service, \"Missing Polling Service\", {service})\n  const canContinue = checkCanContinue()\n  if (!canContinue) throw new Error(\"Externally Halted\")\n\n  let resp\n  try {\n    if (\n      typeof document !== \"undefined\" &&\n      document.visibilityState === \"hidden\"\n    ) {\n      await new Promise(r => setTimeout(r, 500))\n      return poll(service, checkCanContinue)\n    }\n\n    resp = await fetchService(service, {\n      method: serviceMethod(service),\n    }).then(normalizePollingResponse)\n  } catch (error) {\n    throw error\n  }\n\n  switch (resp.status) {\n    case \"APPROVED\":\n      return resp.data\n    case \"DECLINED\":\n      throw new Error(`Declined: ${resp.reason || \"No reason supplied.\"}`)\n    default:\n      await new Promise(r => setTimeout(r, 500))\n      return poll(resp.updates, checkCanContinue)\n  }\n}\n","import {fetchService} from \"./utils/fetch-service\"\nimport {normalizePollingResponse} from \"../../../normalizers/service/polling-response\"\nimport {normalizeLocalView} from \"../../../normalizers/service/local-view\"\nimport {poll} from \"./utils/poll\"\nimport {VERSION} from \"../../../VERSION\"\nimport {serviceEndpoint} from \"../strategies/utils/service-endpoint\"\n\nexport const getExecHttpPost = (execLocal) => async({service, body, config, opts}) => {\n  const resp = await fetchService(service, {\n    data: {\n      fclVersion: VERSION,\n      service: {\n        params: service.params,\n        data: service.data,\n        type: service.type,\n      },\n      config,\n      ...body,\n    },\n  }).then(normalizePollingResponse)\n\n  if (resp.status === \"APPROVED\") {\n    return resp.data\n  } else if (resp.status === \"DECLINED\") {\n    throw new Error(`Declined: ${resp.reason || \"No reason supplied.\"}`)\n  } else if (resp.status === \"REDIRECT\") {\n    return resp\n  } else if (resp.status === \"PENDING\") {\n\n    // these two flags are required to run polling one more time before it stops\n    var canContinue = true\n    var shouldContinue = true\n\n    const [_, unmount] = await execLocal(\n      normalizeLocalView(resp.local),\n      {\n        serviceEndpoint,\n        onClose: () => (shouldContinue = false)\n      }\n    )\n\n    const close = () => {\n      try {\n        unmount()\n        shouldContinue = false\n      } catch (error) {\n        console.error(\"Frame Close Error\", error)\n      }\n    }\n    /**\n     * this function is run once per poll call.\n     * Offsetting canContinue flag to make sure that\n     * the polling is performed one extra time after canContinue flag is set to false\n     * to prevent halting on Android when a browser calls window.close\n     * before FCL receives a successful result from polling\n     *\n     * @returns {boolean} \n     */ \n    const checkCanContinue = () => {\n      const offsetCanContinue = canContinue\n      canContinue = shouldContinue\n\n      return offsetCanContinue\n    }\n\n    return poll(resp.updates, checkCanContinue)\n      .then(serviceResponse => {\n        close()\n        return serviceResponse\n      })\n      .catch(error => {\n        console.error(error)\n        close()\n        throw error\n      })\n  } else {\n    console.error(`Auto Decline: Invalid Response`, {service, resp})\n    throw new Error(`Auto Decline: Invalid Response`)\n  }\n}\n","const CLOSE_EVENT = \"FCL:VIEW:CLOSE\"\nconst READY_EVENT = \"FCL:VIEW:READY\"\nconst RESPONSE_EVENT = \"FCL:VIEW:RESPONSE\"\n\nconst _ = e => typeof e === \"string\" && e.toLowerCase()\n\nconst IGNORE = new Set([\n  \"monetizationstart\",\n  \"monetizationpending\",\n  \"monetizationprogress\",\n  \"monetizationstop\",\n])\n\nconst deprecate = (was, want) =>\n  console.warn(\n    \"DEPRECATION NOTICE\",\n    `Received ${was}, please use ${want} for this and future versions of FCL`\n  )\n\nexport const buildMessageHandler =\n  ({close, send, onReady, onResponse, onMessage}) =>\n  e => {\n    try {\n      if (typeof e.data !== \"object\") return\n      if (IGNORE.has(e.data.type)) return\n      if (_(e.data.type) === _(CLOSE_EVENT)) close()\n      if (_(e.data.type) === _(READY_EVENT)) onReady(e, {send, close})\n      if (_(e.data.type) === _(RESPONSE_EVENT)) onResponse(e, {send, close})\n      onMessage(e, {send, close})\n\n      // Backwards Compatible\n      if (_(e.data.type) === _(\"FCL:FRAME:READY\")) {\n        deprecate(e.data.type, READY_EVENT)\n        onReady(e, {send, close})\n      }\n      if (_(e.data.type) === _(\"FCL:FRAME:RESPONSE\")) {\n        deprecate(e.data.type, RESPONSE_EVENT)\n        onResponse(e, {send, close})\n      }\n      if (_(e.data.type) === _(\"FCL:FRAME:CLOSE\")) {\n        deprecate(e.data.type, CLOSE_EVENT)\n        close()\n      }\n      //\n      if (_(e.data.type) === _(\"FCL::CHALLENGE::RESPONSE\")) {\n        deprecate(e.data.type, RESPONSE_EVENT)\n        onResponse(e, {send, close})\n      }\n      if (_(e.data.type) === _(\"FCL::AUTHZ_READY\")) {\n        deprecate(e.data.type, READY_EVENT)\n        onReady(e, {send, close})\n      }\n      if (_(e.data.type) === _(\"FCL::CHALLENGE::CANCEL\")) {\n        deprecate(e.data.type, CLOSE_EVENT)\n        close()\n      }\n      if (_(e.data.type) === _(\"FCL::CANCEL\")) {\n        deprecate(e.data.type, CLOSE_EVENT)\n        close()\n      }\n    } catch (error) {\n      console.error(\"Frame Callback Error\", error)\n      close()\n    }\n  }\n","import {renderFrame} from \"../../render-frame\"\nimport { serviceEndpoint } from \"../../../../current-user/exec-service/strategies/utils/service-endpoint\"\nimport { buildMessageHandler } from \"../../../../current-user/exec-service/strategies/utils/buildMessageHandler\"\n\nconst noop = () => {}\n\nexport function frame(service, opts = {}) {\n  if (service == null) return {send: noop, close: noop}\n\n  const onClose = opts.onClose || noop\n  const onMessage = opts.onMessage || noop\n  const onReady = opts.onReady || noop\n  const onResponse = opts.onResponse || noop\n\n  const handler = buildMessageHandler({\n    close,\n    send,\n    onReady,\n    onResponse,\n    onMessage,\n  })\n  window.addEventListener(\"message\", handler)\n\n  const [$frame, unmount] = renderFrame(serviceEndpoint(service))\n  return {send, close}\n\n  function close() {\n    try {\n      window.removeEventListener(\"message\", handler)\n      unmount()\n      onClose()\n    } catch (error) {\n      console.error(\"Frame Close Error\", error)\n    }\n  }\n\n  function send(msg) {\n    try {\n      $frame.postMessage(JSON.parse(JSON.stringify(msg || {})), \"*\")\n    } catch (error) {\n      console.error(\"Frame Send Error\", msg, error)\n    }\n  }\n}\n","import {uid} from \"@onflow/util-uid\"\nimport {frame} from \"./utils/frame\"\nimport {normalizePollingResponse} from \"../../../normalizers/service/polling-response\"\nimport {VERSION} from \"../../../VERSION\"\n\nexport function execIframeRPC({service, body, config, opts}) {\n  return new Promise((resolve, reject) => {\n    const id = uid()\n    const includeOlderJsonRpcCall = opts.includeOlderJsonRpcCall\n\n    frame(service, {\n      async onReady(_, {send}) {\n        try {\n          send({\n            type: \"FCL:VIEW:READY:RESPONSE\",\n            fclVersion: VERSION,\n            body,\n            service: {\n              params: service.params,\n              data: service.data,\n              type: service.type,\n            },\n            config,\n          })\n          send({\n            fclVersion: VERSION,\n            type: \"FCL:FRAME:READY:RESPONSE\",\n            body,\n            service: {\n              params: service.params,\n              data: service.data,\n              type: service.type,\n            },\n            config,\n            deprecated: {\n              message:\n                \"FCL:FRAME:READY:RESPONSE is deprecated and replaced with type: FCL:VIEW:READY:RESPONSE\",\n            },\n          })\n          if (includeOlderJsonRpcCall) {\n            send({\n              jsonrpc: \"2.0\",\n              id: id,\n              method: \"fcl:sign\",\n              params: [body, service.params],\n              deprecated: {\n                message:\n                  \"jsonrpc is deprecated and replaced with type: FCL:VIEW:READY:RESPONSE\",\n              },\n            })\n          }\n        } catch (error) {\n          throw error\n        }\n      },\n\n      onResponse(e, {close}) {\n        try {\n          if (typeof e.data !== \"object\") return\n          const resp = normalizePollingResponse(e.data)\n\n          switch (resp.status) {\n            case \"APPROVED\":\n              resolve(resp.data)\n              close()\n              break\n\n            case \"DECLINED\":\n              reject(`Declined: ${resp.reason || \"No reason supplied\"}`)\n              close()\n              break\n\n            case \"REDIRECT\":\n              resolve(resp)\n              close()\n              break\n\n            default:\n              reject(`Declined: No reason supplied`)\n              close()\n              break\n          }\n        } catch (error) {\n          console.error(\"execIframeRPC onResponse error\", error)\n          throw error\n        }\n      },\n\n      onMessage(e, {close}) {\n        try {\n          if (typeof e.data !== \"object\") return\n          if (e.data.jsonrpc !== \"2.0\") return\n          if (e.data.id !== id) return\n          const resp = normalizePollingResponse(e.data.result)\n\n          switch (resp.status) {\n            case \"APPROVED\":\n              resolve(resp.data)\n              close()\n              break\n\n            case \"DECLINED\":\n              reject(`Declined: ${resp.reason || \"No reason supplied\"}`)\n              close()\n              break\n\n            case \"REDIRECT\":\n              resolve(resp)\n              close()\n              break\n\n            default:\n              reject(`Declined: No reason supplied`)\n              close()\n              break\n          }\n        } catch (error) {\n          console.error(\"execIframeRPC onMessage error\", error)\n          throw error\n        }\n      },\n\n      onClose() {\n        reject(`Declined: Externally Halted`)\n      },\n    })\n  })\n}\n","import {renderPop} from \"../../render-pop\"\nimport { serviceEndpoint } from \"../../../../current-user/exec-service/strategies/utils/service-endpoint\"\nimport { buildMessageHandler } from \"../../../../current-user/exec-service/strategies/utils/buildMessageHandler\"\n\nconst noop = () => {}\n\nexport function pop(service, opts = {}) {\n  if (service == null) return {send: noop, close: noop}\n\n  const onClose = opts.onClose || noop\n  const onMessage = opts.onMessage || noop\n  const onReady = opts.onReady || noop\n  const onResponse = opts.onResponse || noop\n\n  const handler = buildMessageHandler({\n    close,\n    send,\n    onReady,\n    onResponse,\n    onMessage,\n  })\n  window.addEventListener(\"message\", handler)\n\n  const [$pop, unmount] = renderPop(serviceEndpoint(service))\n\n  const timer = setInterval(function () {\n    if ($pop && $pop.closed) {\n      close()\n    }\n  }, 500)\n\n  return {send, close}\n\n  function close() {\n    try {\n      window.removeEventListener(\"message\", handler)\n      clearInterval(timer)\n      unmount()\n      onClose()\n    } catch (error) {\n      console.error(\"Popup Close Error\", error)\n    }\n  }\n\n  function send(msg) {\n    try {\n      $pop.postMessage(JSON.parse(JSON.stringify(msg || {})), \"*\")\n    } catch (error) {\n      console.error(\"Popup Send Error\", msg, error)\n    }\n  }\n}\n","import {uid} from \"@onflow/util-uid\"\nimport {pop} from \"./utils/pop\"\nimport {normalizePollingResponse} from \"../../../normalizers/service/polling-response\"\nimport {VERSION} from \"../../../VERSION\"\n\nexport function execPopRPC({service, body, config, opts}) {\n  return new Promise((resolve, reject) => {\n    const id = uid()\n    const {redir, includeOlderJsonRpcCall} = opts\n\n    pop(service, {\n      async onReady(_, {send}) {\n        try {\n          send({\n            fclVersion: VERSION,\n            type: \"FCL:VIEW:READY:RESPONSE\",\n            body,\n            service: {\n              params: service.params,\n              data: service.data,\n              type: service.type,\n            },\n            config,\n          })\n          send({\n            fclVersion: VERSION,\n            type: \"FCL:FRAME:READY:RESPONSE\",\n            body,\n            service: {\n              params: service.params,\n              data: service.data,\n              type: service.type,\n            },\n            config,\n            deprecated: {\n              message:\n                \"FCL:FRAME:READY:RESPONSE is deprecated and replaced with type: FCL:VIEW:READY:RESPONSE\",\n            },\n          })\n          if (includeOlderJsonRpcCall) {\n            send({\n              jsonrpc: \"2.0\",\n              id: id,\n              method: \"fcl:sign\",\n              params: [body, service.params],\n            })\n          }\n        } catch (error) {\n          throw error\n        }\n      },\n\n      onResponse(e, {close}) {\n        try {\n          if (typeof e.data !== \"object\") return\n          const resp = normalizePollingResponse(e.data)\n\n          switch (resp.status) {\n            case \"APPROVED\":\n              resolve(resp.data)\n              !redir && close()\n              break\n\n            case \"DECLINED\":\n              reject(`Declined: ${resp.reason || \"No reason supplied\"}`)\n              close()\n              break\n\n            case \"REDIRECT\":\n              resolve(resp)\n              close()\n              break\n\n            default:\n              reject(`Declined: No reason supplied`)\n              close()\n              break\n          }\n        } catch (error) {\n          console.error(\"execPopRPC onResponse error\", error)\n          throw error\n        }\n      },\n\n      onMessage(e, {close}) {\n        try {\n          if (typeof e.data !== \"object\") return\n          if (e.data.jsonrpc !== \"2.0\") return\n          if (e.data.id !== id) return\n          const resp = normalizePollingResponse(e.data.result)\n\n          switch (resp.status) {\n            case \"APPROVED\":\n              resolve(resp.data)\n              !redir && close()\n              break\n\n            case \"DECLINED\":\n              reject(`Declined: ${resp.reason || \"No reason supplied\"}`)\n              close()\n              break\n\n            case \"REDIRECT\":\n              resolve(resp)\n              close()\n              break\n\n            default:\n              reject(`Declined: No reason supplied`)\n              close()\n              break\n          }\n        } catch (error) {\n          console.error(\"execPopRPC onMessage error\", error)\n          throw error\n        }\n      },\n\n      onClose() {\n        reject(`Declined: Externally Halted`)\n      },\n    })\n  })\n}\n","import {renderTab} from \"../../render-tab\"\nimport { serviceEndpoint } from \"../../../../current-user/exec-service/strategies/utils/service-endpoint\"\nimport { buildMessageHandler } from \"../../../../current-user/exec-service/strategies/utils/buildMessageHandler\"\n\nconst noop = () => {}\n\nexport function tab(service, opts = {}) {\n  if (service == null) return {send: noop, close: noop}\n\n  const onClose = opts.onClose || noop\n  const onMessage = opts.onMessage || noop\n  const onReady = opts.onReady || noop\n  const onResponse = opts.onResponse || noop\n\n  const handler = buildMessageHandler({\n    close,\n    send,\n    onReady,\n    onResponse,\n    onMessage,\n  })\n  window.addEventListener(\"message\", handler)\n\n  const [$tab, unmount] = renderTab(serviceEndpoint(service))\n  const timer = setInterval(function () {\n    if ($tab && $tab.closed) {\n      close()\n    }\n  }, 500)\n\n  return {send, close}\n\n  function close() {\n    try {\n      window.removeEventListener(\"message\", handler)\n      clearInterval(timer)\n      unmount()\n      onClose()\n    } catch (error) {\n      console.error(\"Tab Close Error\", error)\n    }\n  }\n\n  function send(msg) {\n    try {\n      $tab.postMessage(JSON.parse(JSON.stringify(msg || {})), \"*\")\n    } catch (error) {\n      console.error(\"Tab Send Error\", msg, error)\n    }\n  }\n}\n","import {uid} from \"@onflow/util-uid\"\nimport {tab} from \"./utils/tab\"\nimport {normalizePollingResponse} from \"../../../normalizers/service/polling-response\"\nimport {VERSION} from \"../../../VERSION\"\n\nexport function execTabRPC({service, body, config, opts}) {\n  return new Promise((resolve, reject) => {\n    const id = uid()\n    const {redir, includeOlderJsonRpcCall} = opts\n\n    tab(service, {\n      async onReady(_, {send}) {\n        try {\n          send({\n            fclVersion: VERSION,\n            type: \"FCL:VIEW:READY:RESPONSE\",\n            body,\n            service: {\n              params: service.params,\n              data: service.data,\n              type: service.type,\n            },\n            config,\n          })\n          send({\n            fclVersion: VERSION,\n            type: \"FCL:FRAME:READY:RESPONSE\",\n            body,\n            service: {\n              params: service.params,\n              data: service.data,\n              type: service.type,\n            },\n            config,\n            deprecated: {\n              message:\n                \"FCL:FRAME:READY:RESPONSE is deprecated and replaced with type: FCL:VIEW:READY:RESPONSE\",\n            },\n          })\n          if (includeOlderJsonRpcCall) {\n            send({\n              jsonrpc: \"2.0\",\n              id: id,\n              method: \"fcl:sign\",\n              params: [body, service.params],\n            })\n          }\n        } catch (error) {\n          throw error\n        }\n      },\n\n      onResponse(e, {close}) {\n        try {\n          if (typeof e.data !== \"object\") return\n          const resp = normalizePollingResponse(e.data)\n\n          switch (resp.status) {\n            case \"APPROVED\":\n              resolve(resp.data)\n              !redir && close()\n              break\n\n            case \"DECLINED\":\n              reject(`Declined: ${resp.reason || \"No reason supplied\"}`)\n              close()\n              break\n\n            case \"REDIRECT\":\n              resolve(resp)\n              close()\n              break\n\n            default:\n              reject(`Declined: No reason supplied`)\n              close()\n              break\n          }\n        } catch (error) {\n          console.error(\"execPopRPC onResponse error\", error)\n          throw error\n        }\n      },\n\n      onMessage(e, {close}) {\n        try {\n          if (typeof e.data !== \"object\") return\n          if (e.data.jsonrpc !== \"2.0\") return\n          if (e.data.id !== id) return\n          const resp = normalizePollingResponse(e.data.result)\n\n          switch (resp.status) {\n            case \"APPROVED\":\n              resolve(resp.data)\n              !redir && close()\n              break\n\n            case \"DECLINED\":\n              reject(`Declined: ${resp.reason || \"No reason supplied\"}`)\n              close()\n              break\n\n            case \"REDIRECT\":\n              resolve(resp)\n              close()\n              break\n\n            default:\n              reject(`Declined: No reason supplied`)\n              close()\n              break\n          }\n        } catch (error) {\n          console.error(\"execPopRPC onMessage error\", error)\n          throw error\n        }\n      },\n\n      onClose() {\n        reject(`Declined: Externally Halted`)\n      },\n    })\n  })\n}\n","import { buildMessageHandler } from \"../../../../current-user/exec-service/strategies/utils/buildMessageHandler\"\n\nconst noop = () => {}\n\nexport function extension(service, opts = {}) {\n  if (service == null) return {send: noop, close: noop}\n\n  const onClose = opts.onClose || noop\n  const onMessage = opts.onMessage || noop\n  const onReady = opts.onReady || noop\n  const onResponse = opts.onResponse || noop\n\n  const handler = buildMessageHandler({\n    close,\n    send,\n    onReady,\n    onResponse,\n    onMessage,\n  })\n  window.addEventListener(\"message\", handler)\n\n  send({service})\n\n  return {send, close}\n\n  function close() {\n    try {\n      window.removeEventListener(\"message\", handler)\n      onClose()\n    } catch (error) {\n      console.error(\"Ext Close Error\", error)\n    }\n  }\n\n  function send(msg) {\n    try {\n      window && window.postMessage(JSON.parse(JSON.stringify(msg || {})), \"*\")\n    } catch (error) {\n      console.error(\"Ext Send Error\", msg, error)\n    }\n  }\n}\n","import {invariant} from \"@onflow/util-invariant\"\nimport {extension} from \"./utils/extension\"\nimport {normalizePollingResponse} from \"../../../normalizers/service/polling-response\"\nimport {VERSION} from \"../../../VERSION\"\n\nexport function execExtRPC({service, body, config, opts}) {\n  return new Promise((resolve, reject) => {\n    extension(service, {\n      async onReady(_, {send}) {\n        try {\n          send({\n            fclVersion: VERSION,\n            type: \"FCL:VIEW:READY:RESPONSE\",\n            body,\n            service: {\n              params: service.params,\n              data: service.data,\n              type: service.type,\n            },\n            config,\n          })\n        } catch (error) {\n          throw error\n        }\n      },\n\n      onResponse(e, {close}) {\n        try {\n          if (typeof e.data !== \"object\") return\n          const resp = normalizePollingResponse(e.data)\n\n          switch (resp.status) {\n            case \"APPROVED\":\n              resolve(resp.data)\n              close()\n              break\n\n            case \"DECLINED\":\n              reject(`Declined: ${resp.reason || \"No reason supplied\"}`)\n              close()\n              break\n\n            case \"REDIRECT\":\n              resolve(resp)\n              close()\n              break\n\n            default:\n              reject(`Declined: No reason supplied`)\n              close()\n              break\n          }\n        } catch (error) {\n          console.error(\"execExtRPC onResponse error\", error)\n          throw error\n        }\n      },\n\n      onClose() {\n        reject(`Declined: Externally Halted`)\n      },\n    })\n  })\n}\n","import {renderFrame} from \"./render-frame\"\nimport {renderPop} from \"./render-pop\"\nimport {renderTab} from \"./render-tab\"\n\nconst NOT_IMPLEMENTED = () => {\n  throw new Error(\"Strategy util has not been implemented on this platform\")\n}\n\nconst VIEWS = {\n  \"VIEW/IFRAME\": renderFrame,\n  \"VIEW/POP\": renderPop,\n  \"VIEW/TAB\": renderTab,\n  \"VIEW/MOBILE_BROWSER\": NOT_IMPLEMENTED,\n  \"VIEW/DEEPLINK\": NOT_IMPLEMENTED,\n}\n\nexport async function execLocal(service, opts = {serviceEndpoint: () => {}}) {\n  const {serviceEndpoint} = opts\n  try {\n    return VIEWS[service.method](serviceEndpoint(service), opts)\n  } catch (error) {\n    console.error(\"execLocal({service, opts = {}})\", error, {service, opts})\n    throw error\n  }\n}\n","import { CORE_STRATEGIES } from \"../constants\"\nimport {getExecHttpPost} from \"../../current-user/exec-service/strategies/http-post\"\nimport {execIframeRPC} from \"./strategies/iframe-rpc\"\nimport {execPopRPC} from \"./strategies/pop-rpc\"\nimport {execTabRPC} from \"./strategies/tab-rpc\"\nimport {execExtRPC} from \"./strategies/ext-rpc\"\nimport {execLocal} from \"./exec-local\"\n\nexport const coreStrategies = ({\n  [CORE_STRATEGIES[\"HTTP/RPC\"]]: getExecHttpPost(execLocal),\n  [CORE_STRATEGIES[\"HTTP/POST\"]]: getExecHttpPost(execLocal),\n  [CORE_STRATEGIES[\"IFRAME/RPC\"]]: execIframeRPC,\n  [CORE_STRATEGIES[\"POP/RPC\"]]: execPopRPC,\n  [CORE_STRATEGIES[\"TAB/RPC\"]]: execTabRPC,\n  [CORE_STRATEGIES[\"EXT/RPC\"]]: execExtRPC,\n})\n","export * from \"./shared-exports\"\n\nimport {getMutate} from \"./exec/mutate\"\n\nexport const mutate = getMutate({platform: \"web\"})\n\nimport {getCurrentUser} from \"./current-user\"\nconst currentUser = getCurrentUser({platform: \"web\"})\n\nexport {currentUser}\n\nexport const authenticate = (opts = {}) => currentUser().authenticate(opts)\nexport const unauthenticate = () => currentUser().unauthenticate()\nexport const reauthenticate = (opts = {}) => {\n  currentUser().unauthenticate()\n  return currentUser().authenticate(opts)\n}\nexport const signUp = (opts = {}) => currentUser().authenticate(opts)\nexport const logIn = (opts = {}) => currentUser().authenticate(opts)\n\nexport const authz = currentUser().authorization\n\nimport {config} from \"@onflow/config\"\nimport {getDefaultConfig, coreStrategies} from \"./utils/web\"\nimport {initServiceRegistry} from \"./current-user/exec-service/plugins\"\n\nconfig(getDefaultConfig())\n\ninitServiceRegistry({coreStrategies})\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}