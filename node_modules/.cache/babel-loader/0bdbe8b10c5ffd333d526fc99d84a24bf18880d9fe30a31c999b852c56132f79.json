{"ast":null,"code":"import { namehash } from 'ethers/lib/utils';\nimport { useMemo } from 'react';\nimport { useSingleCallResult } from '../state/multicall/hooks';\nimport { isAddress } from '../utils';\nimport isZero from '../utils/isZero';\nimport { useENSRegistrarContract, useENSResolverContract } from './useContract';\nimport useDebounce from './useDebounce';\n\n/**\n * 对地址执行反向查找以查找其名称。\n * 注意，这与查找ENS名称以查找地址不同。\n */\nexport default function useENSName(address) {\n  var _resolverAddress$resu, _name$result$, _name$result;\n  const debouncedAddress = useDebounce(address, 200);\n  const ensNodeArgument = useMemo(() => {\n    if (!debouncedAddress || !isAddress(debouncedAddress)) return [undefined];\n    try {\n      return debouncedAddress ? [namehash(\"\".concat(debouncedAddress.toLowerCase().substr(2), \".addr.reverse\"))] : [undefined];\n    } catch (error) {\n      return [undefined];\n    }\n  }, [debouncedAddress]);\n  const registrarContract = useENSRegistrarContract(false);\n  // console.log('ensNodeArgument', ensNodeArgument)\n  const resolverAddress = useSingleCallResult(registrarContract, 'resolver', ensNodeArgument);\n  const resolverAddressResult = (_resolverAddress$resu = resolverAddress.result) === null || _resolverAddress$resu === void 0 ? void 0 : _resolverAddress$resu[0];\n  // console.log('resolverAddressResult',resolverAddressResult)\n  const resolverContract = useENSResolverContract(resolverAddressResult && !isZero(resolverAddressResult) ? resolverAddressResult : undefined, false);\n  const name = useSingleCallResult(resolverContract, 'name', ensNodeArgument);\n  // console.log('name',name)\n  const changed = debouncedAddress !== address;\n  return {\n    ENSName: changed ? null : (_name$result$ = (_name$result = name.result) === null || _name$result === void 0 ? void 0 : _name$result[0]) !== null && _name$result$ !== void 0 ? _name$result$ : null,\n    loading: changed || resolverAddress.loading || name.loading\n  };\n}","map":{"version":3,"names":["namehash","useMemo","useSingleCallResult","isAddress","isZero","useENSRegistrarContract","useENSResolverContract","useDebounce","useENSName","address","_resolverAddress$resu","_name$result$","_name$result","debouncedAddress","ensNodeArgument","undefined","concat","toLowerCase","substr","error","registrarContract","resolverAddress","resolverAddressResult","result","resolverContract","name","changed","ENSName","loading"],"sources":["/workspace/Planq-Dapps/vesting-portal/src/hooks/useENSName.ts"],"sourcesContent":["import { namehash } from 'ethers/lib/utils'\nimport { useMemo } from 'react'\nimport { useSingleCallResult } from '../state/multicall/hooks'\nimport { isAddress } from '../utils'\nimport isZero from '../utils/isZero'\nimport { useENSRegistrarContract, useENSResolverContract } from './useContract'\nimport useDebounce from './useDebounce'\n\n/**\n * 对地址执行反向查找以查找其名称。\n * 注意，这与查找ENS名称以查找地址不同。\n */\nexport default function useENSName(address?: string): { ENSName: string | null; loading: boolean } {\n  const debouncedAddress = useDebounce(address, 200)\n  const ensNodeArgument = useMemo(() => {\n    if (!debouncedAddress || !isAddress(debouncedAddress)) return [undefined]\n    try {\n      return debouncedAddress ? [namehash(`${debouncedAddress.toLowerCase().substr(2)}.addr.reverse`)] : [undefined]\n    } catch (error) {\n      return [undefined]\n    }\n  }, [debouncedAddress])\n  const registrarContract = useENSRegistrarContract(false)\n  // console.log('ensNodeArgument', ensNodeArgument)\n  const resolverAddress = useSingleCallResult(registrarContract, 'resolver', ensNodeArgument)\n  const resolverAddressResult = resolverAddress.result?.[0]\n  // console.log('resolverAddressResult',resolverAddressResult)\n  const resolverContract = useENSResolverContract(\n    resolverAddressResult && !isZero(resolverAddressResult) ? resolverAddressResult : undefined,\n    false\n  )\n  const name = useSingleCallResult(resolverContract, 'name', ensNodeArgument)\n    // console.log('name',name)\n  const changed = debouncedAddress !== address\n  return {\n    ENSName: changed ? null : name.result?.[0] ?? null,\n    loading: changed || resolverAddress.loading || name.loading\n  }\n}\n"],"mappings":"AAAA,SAASA,QAAQ,QAAQ,kBAAkB;AAC3C,SAASC,OAAO,QAAQ,OAAO;AAC/B,SAASC,mBAAmB,QAAQ,0BAA0B;AAC9D,SAASC,SAAS,QAAQ,UAAU;AACpC,OAAOC,MAAM,MAAM,iBAAiB;AACpC,SAASC,uBAAuB,EAAEC,sBAAsB,QAAQ,eAAe;AAC/E,OAAOC,WAAW,MAAM,eAAe;;AAEvC;AACA;AACA;AACA;AACA,eAAe,SAASC,UAAUA,CAACC,OAAgB,EAAgD;EAAA,IAAAC,qBAAA,EAAAC,aAAA,EAAAC,YAAA;EACjG,MAAMC,gBAAgB,GAAGN,WAAW,CAACE,OAAO,EAAE,GAAG,CAAC;EAClD,MAAMK,eAAe,GAAGb,OAAO,CAAC,MAAM;IACpC,IAAI,CAACY,gBAAgB,IAAI,CAACV,SAAS,CAACU,gBAAgB,CAAC,EAAE,OAAO,CAACE,SAAS,CAAC;IACzE,IAAI;MACF,OAAOF,gBAAgB,GAAG,CAACb,QAAQ,IAAAgB,MAAA,CAAIH,gBAAgB,CAACI,WAAW,CAAC,CAAC,CAACC,MAAM,CAAC,CAAC,CAAC,kBAAe,CAAC,CAAC,GAAG,CAACH,SAAS,CAAC;IAChH,CAAC,CAAC,OAAOI,KAAK,EAAE;MACd,OAAO,CAACJ,SAAS,CAAC;IACpB;EACF,CAAC,EAAE,CAACF,gBAAgB,CAAC,CAAC;EACtB,MAAMO,iBAAiB,GAAGf,uBAAuB,CAAC,KAAK,CAAC;EACxD;EACA,MAAMgB,eAAe,GAAGnB,mBAAmB,CAACkB,iBAAiB,EAAE,UAAU,EAAEN,eAAe,CAAC;EAC3F,MAAMQ,qBAAqB,IAAAZ,qBAAA,GAAGW,eAAe,CAACE,MAAM,cAAAb,qBAAA,uBAAtBA,qBAAA,CAAyB,CAAC,CAAC;EACzD;EACA,MAAMc,gBAAgB,GAAGlB,sBAAsB,CAC7CgB,qBAAqB,IAAI,CAAClB,MAAM,CAACkB,qBAAqB,CAAC,GAAGA,qBAAqB,GAAGP,SAAS,EAC3F,KACF,CAAC;EACD,MAAMU,IAAI,GAAGvB,mBAAmB,CAACsB,gBAAgB,EAAE,MAAM,EAAEV,eAAe,CAAC;EACzE;EACF,MAAMY,OAAO,GAAGb,gBAAgB,KAAKJ,OAAO;EAC5C,OAAO;IACLkB,OAAO,EAAED,OAAO,GAAG,IAAI,IAAAf,aAAA,IAAAC,YAAA,GAAGa,IAAI,CAACF,MAAM,cAAAX,YAAA,uBAAXA,YAAA,CAAc,CAAC,CAAC,cAAAD,aAAA,cAAAA,aAAA,GAAI,IAAI;IAClDiB,OAAO,EAAEF,OAAO,IAAIL,eAAe,CAACO,OAAO,IAAIH,IAAI,CAACG;EACtD,CAAC;AACH"},"metadata":{},"sourceType":"module","externalDependencies":[]}