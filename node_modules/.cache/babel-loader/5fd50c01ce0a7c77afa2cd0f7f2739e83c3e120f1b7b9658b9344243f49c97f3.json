{"ast":null,"code":"\"use strict\";\n\nvar Buffer = require('safe-buffer').Buffer;\nvar Base58 = require('bs58');\nvar cryptoUtils = require('./utils/crypto-utils.js');\nvar utils = require('./utils/utils.js');\nvar AddressLength = 26;\nvar AddressPrefix = 25;\nvar NormalType = 87;\nvar ContractType = 88;\nvar KeyVersion3 = 3;\nvar KeyCurrentVersion = 4;\n\n/**\n * @typedef {Object} KeyOptions\n * @property {Buffer} salt\n * @property {Buffer} iv\n * @property {String} kdf\n * @property {Number} dklen\n * @property {Number} c\n * @property {Number} n\n * @property {Number} r\n * @property {Number} p\n * @property {String} cipher\n * @property {Buffer} uuid\n * @global\n */\n\n/**\n * Key Object.\n * @typedef {Object} Key\n * @property {Number} version\n * @property {Buffer} id\n * @property {HexString} address\n * @property {Object} crypto\n * @global\n */\n\n/**\n * Account constructor.\n * Class encapsulate main operation with account entity.\n * @constructor\n *\n * @param {Hash} priv Account private key.\n * @param {String} path\n *\n * @example var account = new Account(new Buffer(\"ac3773e06ae74c0fa566b0e421d4e391333f31aef90b383f0c0e83e4873609d6\", \"hex\") );\n *\n */\nvar Account = function (priv, path) {\n  priv = priv || cryptoUtils.crypto.randomBytes(32);\n  this.setPrivateKey(priv);\n  this.path = path;\n};\n\n/**\n * Account factory method.\n * Create random account.\n * @static\n *\n * @return {Account} Instance of Account constructor.\n *\n * @example var account = Account.NewAccount();\n */\nAccount.NewAccount = function () {\n  return new Account(cryptoUtils.crypto.randomBytes(32));\n};\n\n/**\n * Address validation method.\n *\n * @static\n * @param {String/Hash} addr - Account address.\n * @param {Number} type - NormalType / ContractType\n *\n * @return {Boolean} Is address has correct format.\n *\n * @example\n * if ( Account.isValidAddress(\"n1QZMXSZtW7BUerroSms4axNfyBGyFGkrh5\") ) {\n *     // some code\n * };\n */\nAccount.isValidAddress = function (addr, type) {\n  /*jshint maxcomplexity:10 */\n\n  if (utils.isString(addr)) {\n    try {\n      addr = Base58.decode(addr);\n    } catch (e) {\n      console.log(\"invalid address.\");\n      // if address can't be base58 decode, return false.\n      return false;\n    }\n  } else if (!Buffer.isBuffer(addr)) {\n    return false;\n  }\n  // address not equal to 26\n  if (addr.length !== AddressLength) {\n    return false;\n  }\n\n  // check if address start with AddressPrefix\n  var buff = Buffer.from(addr);\n  if (buff.readUIntBE(0, 1) !== AddressPrefix) {\n    return false;\n  }\n\n  // check if address type is NormalType or ContractType\n  var t = buff.readUIntBE(1, 1);\n  if (utils.isNumber(type) && (type === NormalType || type === ContractType)) {\n    if (t !== type) {\n      return false;\n    }\n  } else if (t !== NormalType && t !== ContractType) {\n    return false;\n  }\n  var content = addr.slice(0, 22);\n  var checksum = addr.slice(-4);\n  return Buffer.compare(cryptoUtils.sha3(content).slice(0, 4), checksum) === 0;\n};\n\n/**\n * Restore account from address.\n * Receive addr or Account instance.\n * If addr is Account instance return new Account instance with same PrivateKey.\n *\n * @static\n * @param {(Hash|Object)} - Client address or Account instance.\n *\n * @return {Account} Instance of Account restored from address.\n *\n * @example var account = Account.fromAddress(\"n1QZMXSZtW7BUerroSms4axNfyBGyFGkrh5\");\n */\nAccount.fromAddress = function (addr) {\n  var acc = new Account();\n  if (addr instanceof Account) {\n    acc.setPrivateKey(addr.getPrivateKey());\n    return acc;\n  }\n  if (utils.isString(addr) && this.isValidAddress(addr)) {\n    acc.address = Base58.decode(addr);\n    return acc;\n  }\n  var buf = cryptoUtils.toBuffer(addr);\n  if (this.isValidAddress(buf)) {\n    acc.address = buf;\n    return acc;\n  }\n  throw new Error(\"invalid address\");\n};\n\n/**\n * Restore account from public key.\n *\n * @static\n * @param {(String/Hash)} - Public key.\n *\n * @return {Account} Instance of Account restored from address.\n *\n * @example var account = Account.fromPubKey(\"f18ec04019dd131bbcfada4020b001d547244d768f144ef947577ce53a13ad690eb43e4b02a8daa3c168045cd122c0685f083e1656756ba7982721322ebe4da7\");\n */\nAccount.fromPubKey = function (publicKey) {\n  var acc = new Account();\n  acc.pubKey = cryptoUtils.toBuffer(publicKey);\n  return acc;\n};\nAccount.getNormalType = function () {\n  return NormalType;\n};\nAccount.getContractType = function () {\n  return ContractType;\n};\nAccount.prototype = {\n  /**\n   * Private Key setter.\n   *\n   * @param {Hash} priv - Account private key.\n   *\n   * @example account.setPrivateKey(\"ac3773e06ae74c0fa566b0e421d4e391333f31aef90b383f0c0e83e4873609d6\");\n   */\n  setPrivateKey: function (priv) {\n    if (utils.isString(priv) || Buffer.isBuffer(priv)) {\n      this.privKey = priv.length === 32 ? priv : Buffer(priv, 'hex');\n      this.pubKey = null;\n      this.address = null;\n    }\n  },\n  /**\n   * Private Key getter.\n   *\n   * @return {Buffer} Account private key.\n   *\n   * @example var privKey = account.getPrivateKey();\n   * //<Buffer 5b ed 67 f9 9c b3 31 9e 0c 6f 6a 03 54 8b e3 c8 c5 2a 83 64 46 4f 88 6f> 24\n   */\n  getPrivateKey: function () {\n    return this.privKey;\n  },\n  /**\n   * Get Private Key in hex string format.\n   *\n   * @return {HexString} Account private key in String format.\n   *\n   * @example var privKey = account.getPrivateKeyString();\n   * //\"ac3773e06ae74c0fa566b0e421d4e391333f31aef90b383f0c0e83e4873609d6\"\n   */\n  getPrivateKeyString: function () {\n    return this.getPrivateKey().toString('hex');\n  },\n  /**\n   * Public Key getter.\n   *\n   * @return {Buffer} Account public key.\n   *\n   * @example var publicKey = account.getPublicKey();\n   * //<Buffer c0 96 aa 4e 66 c7 4a 9a c7 18 31 f1 24 72 2a c1 3e b5 df 7f 97 1b 13 1d 46 a2 8a e6 81 c6 1d 96 f7 07 d0 aa e9 a7 67 436b 68 af a8 f0 96 65 17 24 29 ... >\n   */\n  getPublicKey: function () {\n    if (utils.isNull(this.pubKey)) {\n      this.pubKey = cryptoUtils.privateToPublic(this.privKey);\n    }\n    return this.pubKey;\n  },\n  /**\n   * Get Public Key in hex string format.\n   *\n   * @return {HexString} Account public key in String format.\n   *\n   * @example var publicKey = account.getPublicKey();\n   * //\"f18ec04019dd131bbcfada4020b001d547244d768f144ef947577ce53a13ad690eb43e4b02a8daa3c168045cd122c0685f083e1656756ba7982721322ebe4da7\"\n   */\n  getPublicKeyString: function () {\n    return this.getPublicKey().toString('hex');\n  },\n  /**\n   * Accaunt address getter.\n   *\n   * @return {Buffer} Account address.\n   *\n   * @example var publicKey = account.getAddress();\n   * //<Buffer 7f 87 83 58 46 96 12 7d 1a c0 57 1a 42 87 c6 25 36 08 ff 32 61 36 51 7c>\n   */\n  getAddress: function () {\n    if (utils.isNull(this.address)) {\n      var pubKey = this.getPublicKey();\n      if (pubKey.length !== 64) {\n        pubKey = cryptoUtils.secp256k1.publicKeyConvert(pubKey, false).slice(1);\n      }\n\n      // The uncompressed form consists of a 0x04 (in analogy to the DER OCTET STRING tag) plus\n      // the concatenation of the binary representation of the X coordinate plus the binary\n      // representation of the y coordinate of the public point.\n      pubKey = Buffer.concat([cryptoUtils.toBuffer(4), pubKey]);\n\n      // Only take the lower 160bits of the hash\n      var content = cryptoUtils.sha3(pubKey);\n      content = cryptoUtils.ripemd160(content);\n      // content = AddressPrefix + NormalType + content(local address only use normal type)\n      content = Buffer.concat([cryptoUtils.toBuffer(AddressPrefix), cryptoUtils.toBuffer(NormalType), content]);\n      var checksum = cryptoUtils.sha3(content).slice(0, 4);\n      this.address = Buffer.concat([content, checksum]);\n    }\n    return this.address;\n  },\n  /**\n   * Get account address in hex string format.\n   *\n   * @return {HexString} Account address in String format.\n   *\n   * @example var publicKey = account.getAddressString();\n   * //\"802d529bf55d6693b3ac72c59b4a7d159da53cae5a7bf99c\"\n   */\n  getAddressString: function () {\n    var addr = this.getAddress();\n    return Base58.encode(addr);\n  },\n  /**\n   * Generate key buy passphrase and options.\n   *\n   * @param {Password} password - Provided password.\n   * @param {KeyOptions} opts - Key options.\n   *\n   * @return {Key} Key Object.\n   *\n   * @example var key = account.toKey(\"passphrase\");\n   */\n  toKey: function (password, opts) {\n    /*jshint maxcomplexity:17 */\n\n    opts = opts || {};\n    var salt = opts.salt || cryptoUtils.crypto.randomBytes(32);\n    var iv = opts.iv || cryptoUtils.crypto.randomBytes(16);\n    var derivedKey;\n    var kdf = opts.kdf || 'scrypt';\n    var kdfparams = {\n      dklen: opts.dklen || 32,\n      salt: salt.toString('hex')\n    };\n    if (kdf === 'pbkdf2') {\n      kdfparams.c = opts.c || 262144;\n      kdfparams.prf = 'hmac-sha256';\n      derivedKey = cryptoUtils.crypto.pbkdf2Sync(new Buffer(password), salt, kdfparams.c, kdfparams.dklen, 'sha256');\n    } else if (kdf === 'scrypt') {\n      kdfparams.n = opts.n || 4096;\n      kdfparams.r = opts.r || 8;\n      kdfparams.p = opts.p || 1;\n      derivedKey = cryptoUtils.scrypt(new Buffer(password), salt, kdfparams.n, kdfparams.r, kdfparams.p, kdfparams.dklen);\n    } else {\n      throw new Error('Unsupported kdf');\n    }\n    var cipher = cryptoUtils.crypto.createCipheriv(opts.cipher || 'aes-128-ctr', derivedKey.slice(0, 16), iv);\n    if (!cipher) {\n      throw new Error('Unsupported cipher');\n    }\n    var ciphertext = Buffer.concat([cipher.update(this.privKey), cipher.final()]);\n    // var mac = cryptoUtils.sha3(Buffer.concat([derivedKey.slice(16, 32), new Buffer(ciphertext, 'hex')]));   // KeyVersion3 deprecated\n    var mac = cryptoUtils.sha3(Buffer.concat([derivedKey.slice(16, 32), new Buffer(ciphertext, 'hex'), iv, new Buffer(opts.cipher || 'aes-128-ctr')]));\n    return {\n      version: KeyCurrentVersion,\n      id: cryptoUtils.uuid.v4({\n        random: opts.uuid || cryptoUtils.crypto.randomBytes(16)\n      }),\n      address: this.getAddressString(),\n      crypto: {\n        ciphertext: ciphertext.toString('hex'),\n        cipherparams: {\n          iv: iv.toString('hex')\n        },\n        cipher: opts.cipher || 'aes-128-ctr',\n        kdf: kdf,\n        kdfparams: kdfparams,\n        mac: mac.toString('hex'),\n        machash: \"sha3256\"\n      }\n    };\n  },\n  /**\n   * Generate key buy passphrase and options.\n   * Return in JSON format.\n   *\n   * @param {Password} password - Provided password.\n   * @param {KeyOptions} opts - Key options.\n   *\n   * @return {String} JSON stringify Key.\n   *\n   * @example var key = account.toKeyString(\"passphrase\");\n   */\n  toKeyString: function (password, opts) {\n    return JSON.stringify(this.toKey(password, opts));\n  },\n  /**\n   * Restore account from key and passphrase.\n   *\n   * @param {Key} input - Key Object.\n   * @param {Password} password - Provided password.\n   * @param {Boolean} nonStrict - Strict сase sensitivity flag.\n   *\n   * @return {@link Account} - Instance of Account restored from key and passphrase.\n   */\n  fromKey: function (input, password, nonStrict) {\n    /*jshint maxcomplexity:10 */\n\n    var json = typeof input === 'object' ? input : JSON.parse(nonStrict ? input.toLowerCase() : input);\n    if (json.version !== KeyVersion3 && json.version !== KeyCurrentVersion) {\n      throw new Error('Not supported wallet version');\n    }\n    var derivedKey;\n    var kdfparams;\n    if (json.crypto.kdf === 'scrypt') {\n      kdfparams = json.crypto.kdfparams;\n      derivedKey = cryptoUtils.scrypt(new Buffer(password), new Buffer(kdfparams.salt, 'hex'), kdfparams.n, kdfparams.r, kdfparams.p, kdfparams.dklen);\n    } else if (json.crypto.kdf === 'pbkdf2') {\n      kdfparams = json.crypto.kdfparams;\n      if (kdfparams.prf !== 'hmac-sha256') {\n        throw new Error('Unsupported parameters to PBKDF2');\n      }\n      derivedKey = cryptoUtils.crypto.pbkdf2Sync(new Buffer(password), new Buffer(kdfparams.salt, 'hex'), kdfparams.c, kdfparams.dklen, 'sha256');\n    } else {\n      throw new Error('Unsupported key derivation scheme');\n    }\n    var ciphertext = new Buffer(json.crypto.ciphertext, 'hex');\n    var mac;\n    if (json.version === KeyCurrentVersion) {\n      mac = cryptoUtils.sha3(Buffer.concat([derivedKey.slice(16, 32), ciphertext, new Buffer(json.crypto.cipherparams.iv, 'hex'), new Buffer(json.crypto.cipher)]));\n    } else {\n      // KeyVersion3\n      mac = cryptoUtils.sha3(Buffer.concat([derivedKey.slice(16, 32), ciphertext]));\n    }\n    if (mac.toString('hex') !== json.crypto.mac) {\n      throw new Error('Key derivation failed - possibly wrong passphrase');\n    }\n    var decipher = cryptoUtils.crypto.createDecipheriv(json.crypto.cipher, derivedKey.slice(0, 16), new Buffer(json.crypto.cipherparams.iv, 'hex'));\n    var seed = Buffer.concat([decipher.update(ciphertext), decipher.final()]);\n    while (seed.length < 32) {\n      var nullBuff = new Buffer([0x00]);\n      seed = Buffer.concat([nullBuff, seed]);\n    }\n    this.setPrivateKey(seed);\n    return this;\n  }\n};\nmodule.exports = Account;","map":{"version":3,"names":["Buffer","require","Base58","cryptoUtils","utils","AddressLength","AddressPrefix","NormalType","ContractType","KeyVersion3","KeyCurrentVersion","Account","priv","path","crypto","randomBytes","setPrivateKey","NewAccount","isValidAddress","addr","type","isString","decode","e","console","log","isBuffer","length","buff","from","readUIntBE","t","isNumber","content","slice","checksum","compare","sha3","fromAddress","acc","getPrivateKey","address","buf","toBuffer","Error","fromPubKey","publicKey","pubKey","getNormalType","getContractType","prototype","privKey","getPrivateKeyString","toString","getPublicKey","isNull","privateToPublic","getPublicKeyString","getAddress","secp256k1","publicKeyConvert","concat","ripemd160","getAddressString","encode","toKey","password","opts","salt","iv","derivedKey","kdf","kdfparams","dklen","c","prf","pbkdf2Sync","n","r","p","scrypt","cipher","createCipheriv","ciphertext","update","final","mac","version","id","uuid","v4","random","cipherparams","machash","toKeyString","JSON","stringify","fromKey","input","nonStrict","json","parse","toLowerCase","decipher","createDecipheriv","seed","nullBuff","module","exports"],"sources":["/workspace/Planq-Dapps/vesting-portal/node_modules/nebulas/lib/account.js"],"sourcesContent":["\"use strict\";\n\nvar Buffer = require('safe-buffer').Buffer;\nvar Base58 = require('bs58');\nvar cryptoUtils = require('./utils/crypto-utils.js');\nvar utils = require('./utils/utils.js');\n\nvar AddressLength = 26;\nvar AddressPrefix = 25;\nvar NormalType = 87;\nvar ContractType = 88;\n\nvar KeyVersion3 = 3;\nvar KeyCurrentVersion = 4;\n\n/**\n * @typedef {Object} KeyOptions\n * @property {Buffer} salt\n * @property {Buffer} iv\n * @property {String} kdf\n * @property {Number} dklen\n * @property {Number} c\n * @property {Number} n\n * @property {Number} r\n * @property {Number} p\n * @property {String} cipher\n * @property {Buffer} uuid\n * @global\n */\n\n/**\n * Key Object.\n * @typedef {Object} Key\n * @property {Number} version\n * @property {Buffer} id\n * @property {HexString} address\n * @property {Object} crypto\n * @global\n */\n\n/**\n * Account constructor.\n * Class encapsulate main operation with account entity.\n * @constructor\n *\n * @param {Hash} priv Account private key.\n * @param {String} path\n *\n * @example var account = new Account(new Buffer(\"ac3773e06ae74c0fa566b0e421d4e391333f31aef90b383f0c0e83e4873609d6\", \"hex\") );\n *\n */\nvar Account = function (priv, path) {\n    priv = priv || cryptoUtils.crypto.randomBytes(32);\n    this.setPrivateKey(priv);\n    this.path = path;\n};\n\n/**\n * Account factory method.\n * Create random account.\n * @static\n *\n * @return {Account} Instance of Account constructor.\n *\n * @example var account = Account.NewAccount();\n */\nAccount.NewAccount = function () {\n    return new Account(cryptoUtils.crypto.randomBytes(32));\n};\n\n/**\n * Address validation method.\n *\n * @static\n * @param {String/Hash} addr - Account address.\n * @param {Number} type - NormalType / ContractType\n *\n * @return {Boolean} Is address has correct format.\n *\n * @example\n * if ( Account.isValidAddress(\"n1QZMXSZtW7BUerroSms4axNfyBGyFGkrh5\") ) {\n *     // some code\n * };\n */\nAccount.isValidAddress = function (addr, type) {\n    /*jshint maxcomplexity:10 */\n\n    if (utils.isString(addr)) {\n        try {\n            addr = Base58.decode(addr);\n        } catch (e) {\n            console.log(\"invalid address.\");\n            // if address can't be base58 decode, return false.\n            return false;\n        }\n    } else if (!Buffer.isBuffer(addr)) {\n        return false;\n    }\n    // address not equal to 26\n    if (addr.length !== AddressLength) {\n        return false;\n    }\n\n    // check if address start with AddressPrefix\n    var buff = Buffer.from(addr);\n    if (buff.readUIntBE(0, 1) !== AddressPrefix) {\n        return false;\n    }\n\n    // check if address type is NormalType or ContractType\n    var t = buff.readUIntBE(1, 1);\n    if (utils.isNumber(type) && (type === NormalType || type === ContractType)) {\n        if (t !== type) {\n            return false;\n        }\n    } else if (t !== NormalType && t !== ContractType) {\n        return false;\n    }\n    var content = addr.slice(0, 22);\n    var checksum = addr.slice(-4);\n    return Buffer.compare(cryptoUtils.sha3(content).slice(0, 4), checksum) === 0;\n};\n\n/**\n * Restore account from address.\n * Receive addr or Account instance.\n * If addr is Account instance return new Account instance with same PrivateKey.\n *\n * @static\n * @param {(Hash|Object)} - Client address or Account instance.\n *\n * @return {Account} Instance of Account restored from address.\n *\n * @example var account = Account.fromAddress(\"n1QZMXSZtW7BUerroSms4axNfyBGyFGkrh5\");\n */\nAccount.fromAddress = function (addr) {\n    var acc = new Account();\n    if (addr instanceof Account) {\n        acc.setPrivateKey(addr.getPrivateKey());\n        return acc;\n    }\n    if (utils.isString(addr) && this.isValidAddress(addr)) {\n        acc.address = Base58.decode(addr);\n        return acc;\n    }\n\n    var buf = cryptoUtils.toBuffer(addr);\n    if (this.isValidAddress(buf)) {\n        acc.address = buf;\n        return acc;\n    }\n    throw new Error(\"invalid address\");\n};\n\n/**\n * Restore account from public key.\n *\n * @static\n * @param {(String/Hash)} - Public key.\n *\n * @return {Account} Instance of Account restored from address.\n *\n * @example var account = Account.fromPubKey(\"f18ec04019dd131bbcfada4020b001d547244d768f144ef947577ce53a13ad690eb43e4b02a8daa3c168045cd122c0685f083e1656756ba7982721322ebe4da7\");\n */\nAccount.fromPubKey = function (publicKey) {\n    var acc = new Account();\n    acc.pubKey = cryptoUtils.toBuffer(publicKey);\n    return acc;\n};\n\n\nAccount.getNormalType = function () {\n    return NormalType;\n};\n\nAccount.getContractType = function () {\n    return ContractType;\n};\n\nAccount.prototype = {\n    /**\n     * Private Key setter.\n     *\n     * @param {Hash} priv - Account private key.\n     *\n     * @example account.setPrivateKey(\"ac3773e06ae74c0fa566b0e421d4e391333f31aef90b383f0c0e83e4873609d6\");\n     */\n    setPrivateKey: function (priv) {\n        if (utils.isString(priv) || Buffer.isBuffer(priv)) {\n            this.privKey = priv.length === 32 ? priv : Buffer(priv, 'hex');\n            this.pubKey = null;\n            this.address = null;\n        }\n    },\n    /**\n     * Private Key getter.\n     *\n     * @return {Buffer} Account private key.\n     *\n     * @example var privKey = account.getPrivateKey();\n     * //<Buffer 5b ed 67 f9 9c b3 31 9e 0c 6f 6a 03 54 8b e3 c8 c5 2a 83 64 46 4f 88 6f> 24\n     */\n    getPrivateKey: function () {\n        return this.privKey;\n    },\n    /**\n     * Get Private Key in hex string format.\n     *\n     * @return {HexString} Account private key in String format.\n     *\n     * @example var privKey = account.getPrivateKeyString();\n     * //\"ac3773e06ae74c0fa566b0e421d4e391333f31aef90b383f0c0e83e4873609d6\"\n     */\n    getPrivateKeyString: function () {\n        return this.getPrivateKey().toString('hex');\n    },\n    /**\n     * Public Key getter.\n     *\n     * @return {Buffer} Account public key.\n     *\n     * @example var publicKey = account.getPublicKey();\n     * //<Buffer c0 96 aa 4e 66 c7 4a 9a c7 18 31 f1 24 72 2a c1 3e b5 df 7f 97 1b 13 1d 46 a2 8a e6 81 c6 1d 96 f7 07 d0 aa e9 a7 67 436b 68 af a8 f0 96 65 17 24 29 ... >\n     */\n    getPublicKey: function () {\n        if (utils.isNull(this.pubKey)) {\n            this.pubKey = cryptoUtils.privateToPublic(this.privKey);\n        }\n        return this.pubKey;\n    },\n    /**\n     * Get Public Key in hex string format.\n     *\n     * @return {HexString} Account public key in String format.\n     *\n     * @example var publicKey = account.getPublicKey();\n     * //\"f18ec04019dd131bbcfada4020b001d547244d768f144ef947577ce53a13ad690eb43e4b02a8daa3c168045cd122c0685f083e1656756ba7982721322ebe4da7\"\n     */\n    getPublicKeyString: function () {\n        return this.getPublicKey().toString('hex');\n    },\n    /**\n     * Accaunt address getter.\n     *\n     * @return {Buffer} Account address.\n     *\n     * @example var publicKey = account.getAddress();\n     * //<Buffer 7f 87 83 58 46 96 12 7d 1a c0 57 1a 42 87 c6 25 36 08 ff 32 61 36 51 7c>\n     */\n    getAddress: function () {\n        if (utils.isNull(this.address)) {\n\n            var pubKey = this.getPublicKey();\n            if (pubKey.length !== 64) {\n                pubKey = cryptoUtils.secp256k1.publicKeyConvert(pubKey, false).slice(1);\n            }\n\n            // The uncompressed form consists of a 0x04 (in analogy to the DER OCTET STRING tag) plus\n            // the concatenation of the binary representation of the X coordinate plus the binary\n            // representation of the y coordinate of the public point.\n            pubKey = Buffer.concat([cryptoUtils.toBuffer(4), pubKey]);\n\n            // Only take the lower 160bits of the hash\n            var content = cryptoUtils.sha3(pubKey);\n            content = cryptoUtils.ripemd160(content);\n            // content = AddressPrefix + NormalType + content(local address only use normal type)\n            content = Buffer.concat([cryptoUtils.toBuffer(AddressPrefix), cryptoUtils.toBuffer(NormalType), content]);\n            var checksum = cryptoUtils.sha3(content).slice(0, 4);\n            this.address = Buffer.concat([content, checksum]);\n        }\n        return this.address;\n    },\n    /**\n     * Get account address in hex string format.\n     *\n     * @return {HexString} Account address in String format.\n     *\n     * @example var publicKey = account.getAddressString();\n     * //\"802d529bf55d6693b3ac72c59b4a7d159da53cae5a7bf99c\"\n     */\n    getAddressString: function () {\n        var addr = this.getAddress();\n        return Base58.encode(addr);\n    },\n    /**\n     * Generate key buy passphrase and options.\n     *\n     * @param {Password} password - Provided password.\n     * @param {KeyOptions} opts - Key options.\n     *\n     * @return {Key} Key Object.\n     *\n     * @example var key = account.toKey(\"passphrase\");\n     */\n    toKey: function (password, opts) {\n        /*jshint maxcomplexity:17 */\n\n        opts = opts || {};\n        var salt = opts.salt || cryptoUtils.crypto.randomBytes(32);\n        var iv = opts.iv || cryptoUtils.crypto.randomBytes(16);\n        var derivedKey;\n        var kdf = opts.kdf || 'scrypt';\n        var kdfparams = {\n            dklen: opts.dklen || 32,\n            salt: salt.toString('hex')\n        };\n        if (kdf === 'pbkdf2') {\n            kdfparams.c = opts.c || 262144;\n            kdfparams.prf = 'hmac-sha256';\n            derivedKey = cryptoUtils.crypto.pbkdf2Sync(new Buffer(password), salt, kdfparams.c, kdfparams.dklen, 'sha256');\n        } else if (kdf === 'scrypt') {\n            kdfparams.n = opts.n || 4096;\n            kdfparams.r = opts.r || 8;\n            kdfparams.p = opts.p || 1;\n            derivedKey = cryptoUtils.scrypt(new Buffer(password), salt, kdfparams.n, kdfparams.r, kdfparams.p, kdfparams.dklen);\n        } else {\n            throw new Error('Unsupported kdf');\n        }\n        var cipher = cryptoUtils.crypto.createCipheriv(opts.cipher || 'aes-128-ctr', derivedKey.slice(0, 16), iv);\n        if (!cipher) {\n            throw new Error('Unsupported cipher');\n        }\n        var ciphertext = Buffer.concat([cipher.update(this.privKey), cipher.final()]);\n        // var mac = cryptoUtils.sha3(Buffer.concat([derivedKey.slice(16, 32), new Buffer(ciphertext, 'hex')]));   // KeyVersion3 deprecated\n        var mac = cryptoUtils.sha3(Buffer.concat([derivedKey.slice(16, 32), new Buffer(ciphertext, 'hex'), iv, new Buffer(opts.cipher || 'aes-128-ctr')]));\n        return {\n            version: KeyCurrentVersion,\n            id: cryptoUtils.uuid.v4({\n                random: opts.uuid || cryptoUtils.crypto.randomBytes(16)\n            }),\n            address: this.getAddressString(),\n            crypto: {\n                ciphertext: ciphertext.toString('hex'),\n                cipherparams: {\n                    iv: iv.toString('hex')\n                },\n                cipher: opts.cipher || 'aes-128-ctr',\n                kdf: kdf,\n                kdfparams: kdfparams,\n                mac: mac.toString('hex'),\n                machash: \"sha3256\"\n            }\n        };\n    },\n    /**\n     * Generate key buy passphrase and options.\n     * Return in JSON format.\n     *\n     * @param {Password} password - Provided password.\n     * @param {KeyOptions} opts - Key options.\n     *\n     * @return {String} JSON stringify Key.\n     *\n     * @example var key = account.toKeyString(\"passphrase\");\n     */\n    toKeyString: function (password, opts) {\n        return JSON.stringify(this.toKey(password, opts));\n    },\n    /**\n     * Restore account from key and passphrase.\n     *\n     * @param {Key} input - Key Object.\n     * @param {Password} password - Provided password.\n     * @param {Boolean} nonStrict - Strict сase sensitivity flag.\n     *\n     * @return {@link Account} - Instance of Account restored from key and passphrase.\n     */\n    fromKey: function (input, password, nonStrict) {\n        /*jshint maxcomplexity:10 */\n\n        var json = (typeof input === 'object') ? input : JSON.parse(nonStrict ? input.toLowerCase() : input);\n        if (json.version !== KeyVersion3 && json.version !== KeyCurrentVersion) {\n            throw new Error('Not supported wallet version');\n        }\n        var derivedKey;\n        var kdfparams;\n        if (json.crypto.kdf === 'scrypt') {\n            kdfparams = json.crypto.kdfparams;\n            derivedKey = cryptoUtils.scrypt(new Buffer(password), new Buffer(kdfparams.salt, 'hex'), kdfparams.n, kdfparams.r, kdfparams.p, kdfparams.dklen);\n        } else if (json.crypto.kdf === 'pbkdf2') {\n            kdfparams = json.crypto.kdfparams;\n            if (kdfparams.prf !== 'hmac-sha256') {\n                throw new Error('Unsupported parameters to PBKDF2');\n            }\n            derivedKey = cryptoUtils.crypto.pbkdf2Sync(new Buffer(password), new Buffer(kdfparams.salt, 'hex'), kdfparams.c, kdfparams.dklen, 'sha256');\n        } else {\n            throw new Error('Unsupported key derivation scheme');\n        }\n        var ciphertext = new Buffer(json.crypto.ciphertext, 'hex');\n        var mac;\n\n        if (json.version === KeyCurrentVersion) {\n            mac = cryptoUtils.sha3(Buffer.concat([derivedKey.slice(16, 32), ciphertext,\n                new Buffer(json.crypto.cipherparams.iv, 'hex'), new Buffer(json.crypto.cipher)]));\n        } else {\n            // KeyVersion3\n            mac = cryptoUtils.sha3(Buffer.concat([derivedKey.slice(16, 32), ciphertext]));\n        }\n\n        if (mac.toString('hex') !== json.crypto.mac) {\n            throw new Error('Key derivation failed - possibly wrong passphrase');\n        }\n        var decipher = cryptoUtils.crypto.createDecipheriv(json.crypto.cipher, derivedKey.slice(0, 16), new Buffer(json.crypto.cipherparams.iv, 'hex'));\n        var seed = Buffer.concat([decipher.update(ciphertext), decipher.final()]);\n        while (seed.length < 32) {\n            var nullBuff = new Buffer([0x00]);\n            seed = Buffer.concat([nullBuff, seed]);\n        }\n        this.setPrivateKey(seed);\n        return this;\n    }\n\n};\n\n\nmodule.exports = Account;\n"],"mappings":"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"},"metadata":{},"sourceType":"script","externalDependencies":[]}