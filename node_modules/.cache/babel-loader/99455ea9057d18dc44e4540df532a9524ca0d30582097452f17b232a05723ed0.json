{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.sha1 = void 0;\nconst _sha2_js_1 = require(\"./_sha2.js\");\nconst utils_js_1 = require(\"./utils.js\");\n// SHA1 was cryptographically broken.\n// It is still widely used in legacy apps. Don't use it for a new protocol.\n// RFC 3174\nconst rotl = (word, shift) => word << shift | word >>> 32 - shift >>> 0;\n// Choice: a ? b : c\nconst Chi = (a, b, c) => a & b ^ ~a & c;\n// Majority function, true if any two inpust is true\nconst Maj = (a, b, c) => a & b ^ a & c ^ b & c;\n// Initial state\nconst IV = /* @__PURE__ */new Uint32Array([0x67452301, 0xefcdab89, 0x98badcfe, 0x10325476, 0xc3d2e1f0]);\n// Temporary buffer, not used to store anything between runs\n// Named this way because it matches specification.\nconst SHA1_W = /* @__PURE__ */new Uint32Array(80);\nclass SHA1 extends _sha2_js_1.SHA2 {\n  constructor() {\n    super(64, 20, 8, false);\n    this.A = IV[0] | 0;\n    this.B = IV[1] | 0;\n    this.C = IV[2] | 0;\n    this.D = IV[3] | 0;\n    this.E = IV[4] | 0;\n  }\n  get() {\n    const {\n      A,\n      B,\n      C,\n      D,\n      E\n    } = this;\n    return [A, B, C, D, E];\n  }\n  set(A, B, C, D, E) {\n    this.A = A | 0;\n    this.B = B | 0;\n    this.C = C | 0;\n    this.D = D | 0;\n    this.E = E | 0;\n  }\n  process(view, offset) {\n    for (let i = 0; i < 16; i++, offset += 4) SHA1_W[i] = view.getUint32(offset, false);\n    for (let i = 16; i < 80; i++) SHA1_W[i] = rotl(SHA1_W[i - 3] ^ SHA1_W[i - 8] ^ SHA1_W[i - 14] ^ SHA1_W[i - 16], 1);\n    // Compression function main loop, 80 rounds\n    let {\n      A,\n      B,\n      C,\n      D,\n      E\n    } = this;\n    for (let i = 0; i < 80; i++) {\n      let F, K;\n      if (i < 20) {\n        F = Chi(B, C, D);\n        K = 0x5a827999;\n      } else if (i < 40) {\n        F = B ^ C ^ D;\n        K = 0x6ed9eba1;\n      } else if (i < 60) {\n        F = Maj(B, C, D);\n        K = 0x8f1bbcdc;\n      } else {\n        F = B ^ C ^ D;\n        K = 0xca62c1d6;\n      }\n      const T = rotl(A, 5) + F + E + K + SHA1_W[i] | 0;\n      E = D;\n      D = C;\n      C = rotl(B, 30);\n      B = A;\n      A = T;\n    }\n    // Add the compressed chunk to the current hash value\n    A = A + this.A | 0;\n    B = B + this.B | 0;\n    C = C + this.C | 0;\n    D = D + this.D | 0;\n    E = E + this.E | 0;\n    this.set(A, B, C, D, E);\n  }\n  roundClean() {\n    SHA1_W.fill(0);\n  }\n  destroy() {\n    this.set(0, 0, 0, 0, 0);\n    this.buffer.fill(0);\n  }\n}\nexports.sha1 = (0, utils_js_1.wrapConstructor)(() => new SHA1());","map":{"version":3,"names":["_sha2_js_1","require","utils_js_1","rotl","word","shift","Chi","a","b","c","Maj","IV","Uint32Array","SHA1_W","SHA1","SHA2","constructor","A","B","C","D","E","get","set","process","view","offset","i","getUint32","F","K","T","roundClean","fill","destroy","buffer","exports","sha1","wrapConstructor"],"sources":["src/sha1.ts"],"sourcesContent":[null],"mappings":"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"},"metadata":{},"sourceType":"script","externalDependencies":[]}