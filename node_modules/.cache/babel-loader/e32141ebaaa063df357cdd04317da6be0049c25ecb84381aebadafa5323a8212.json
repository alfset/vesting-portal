{"ast":null,"code":"'use strict';\n\nObject.defineProperty(exports, '__esModule', {\n  value: true\n});\nconst typeFields_1 = require('../../typeFields');\nfunction decode(keyVal) {\n  if (keyVal.key[0] !== typeFields_1.InputTypes.TAP_SCRIPT_SIG) {\n    throw new Error('Decode Error: could not decode tapScriptSig with key 0x' + keyVal.key.toString('hex'));\n  }\n  if (keyVal.key.length !== 65) {\n    throw new Error('Decode Error: tapScriptSig has invalid key 0x' + keyVal.key.toString('hex'));\n  }\n  if (keyVal.value.length !== 64 && keyVal.value.length !== 65) {\n    throw new Error('Decode Error: tapScriptSig has invalid signature in key 0x' + keyVal.key.toString('hex'));\n  }\n  const pubkey = keyVal.key.slice(1, 33);\n  const leafHash = keyVal.key.slice(33);\n  return {\n    pubkey,\n    leafHash,\n    signature: keyVal.value\n  };\n}\nexports.decode = decode;\nfunction encode(tSig) {\n  const head = Buffer.from([typeFields_1.InputTypes.TAP_SCRIPT_SIG]);\n  return {\n    key: Buffer.concat([head, tSig.pubkey, tSig.leafHash]),\n    value: tSig.signature\n  };\n}\nexports.encode = encode;\nexports.expected = '{ pubkey: Buffer; leafHash: Buffer; signature: Buffer; }';\nfunction check(data) {\n  return Buffer.isBuffer(data.pubkey) && Buffer.isBuffer(data.leafHash) && Buffer.isBuffer(data.signature) && data.pubkey.length === 32 && data.leafHash.length === 32 && (data.signature.length === 64 || data.signature.length === 65);\n}\nexports.check = check;\nfunction canAddToArray(array, item, dupeSet) {\n  const dupeString = item.pubkey.toString('hex') + item.leafHash.toString('hex');\n  if (dupeSet.has(dupeString)) return false;\n  dupeSet.add(dupeString);\n  return array.filter(v => v.pubkey.equals(item.pubkey) && v.leafHash.equals(item.leafHash)).length === 0;\n}\nexports.canAddToArray = canAddToArray;","map":{"version":3,"names":["Object","defineProperty","exports","value","typeFields_1","require","decode","keyVal","key","InputTypes","TAP_SCRIPT_SIG","Error","toString","length","pubkey","slice","leafHash","signature","encode","tSig","head","Buffer","from","concat","expected","check","data","isBuffer","canAddToArray","array","item","dupeSet","dupeString","has","add","filter","v","equals"],"sources":["/workspace/Planq-Dapps/vesting-portal/node_modules/bip174/src/lib/converter/input/tapScriptSig.js"],"sourcesContent":["'use strict';\nObject.defineProperty(exports, '__esModule', { value: true });\nconst typeFields_1 = require('../../typeFields');\nfunction decode(keyVal) {\n  if (keyVal.key[0] !== typeFields_1.InputTypes.TAP_SCRIPT_SIG) {\n    throw new Error(\n      'Decode Error: could not decode tapScriptSig with key 0x' +\n        keyVal.key.toString('hex'),\n    );\n  }\n  if (keyVal.key.length !== 65) {\n    throw new Error(\n      'Decode Error: tapScriptSig has invalid key 0x' +\n        keyVal.key.toString('hex'),\n    );\n  }\n  if (keyVal.value.length !== 64 && keyVal.value.length !== 65) {\n    throw new Error(\n      'Decode Error: tapScriptSig has invalid signature in key 0x' +\n        keyVal.key.toString('hex'),\n    );\n  }\n  const pubkey = keyVal.key.slice(1, 33);\n  const leafHash = keyVal.key.slice(33);\n  return {\n    pubkey,\n    leafHash,\n    signature: keyVal.value,\n  };\n}\nexports.decode = decode;\nfunction encode(tSig) {\n  const head = Buffer.from([typeFields_1.InputTypes.TAP_SCRIPT_SIG]);\n  return {\n    key: Buffer.concat([head, tSig.pubkey, tSig.leafHash]),\n    value: tSig.signature,\n  };\n}\nexports.encode = encode;\nexports.expected = '{ pubkey: Buffer; leafHash: Buffer; signature: Buffer; }';\nfunction check(data) {\n  return (\n    Buffer.isBuffer(data.pubkey) &&\n    Buffer.isBuffer(data.leafHash) &&\n    Buffer.isBuffer(data.signature) &&\n    data.pubkey.length === 32 &&\n    data.leafHash.length === 32 &&\n    (data.signature.length === 64 || data.signature.length === 65)\n  );\n}\nexports.check = check;\nfunction canAddToArray(array, item, dupeSet) {\n  const dupeString =\n    item.pubkey.toString('hex') + item.leafHash.toString('hex');\n  if (dupeSet.has(dupeString)) return false;\n  dupeSet.add(dupeString);\n  return (\n    array.filter(\n      v => v.pubkey.equals(item.pubkey) && v.leafHash.equals(item.leafHash),\n    ).length === 0\n  );\n}\nexports.canAddToArray = canAddToArray;\n"],"mappings":"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"},"metadata":{},"sourceType":"script","externalDependencies":[]}