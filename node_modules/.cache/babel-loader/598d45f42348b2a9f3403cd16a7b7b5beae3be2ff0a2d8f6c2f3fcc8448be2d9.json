{"ast":null,"code":"\"use strict\";\n\nvar __createBinding = this && this.__createBinding || (Object.create ? function (o, m, k, k2) {\n  if (k2 === undefined) k2 = k;\n  var desc = Object.getOwnPropertyDescriptor(m, k);\n  if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n    desc = {\n      enumerable: true,\n      get: function () {\n        return m[k];\n      }\n    };\n  }\n  Object.defineProperty(o, k2, desc);\n} : function (o, m, k, k2) {\n  if (k2 === undefined) k2 = k;\n  o[k2] = m[k];\n});\nvar __setModuleDefault = this && this.__setModuleDefault || (Object.create ? function (o, v) {\n  Object.defineProperty(o, \"default\", {\n    enumerable: true,\n    value: v\n  });\n} : function (o, v) {\n  o[\"default\"] = v;\n});\nvar __importStar = this && this.__importStar || function (mod) {\n  if (mod && mod.__esModule) return mod;\n  var result = {};\n  if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\n  __setModuleDefault(result, mod);\n  return result;\n};\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.pbkdf2Sha512 = exports.pbkdf2Sha512Noble = exports.pbkdf2Sha512Crypto = exports.pbkdf2Sha512Subtle = exports.getSubtle = exports.getCryptoModule = void 0;\nconst utils_1 = require(\"@cosmjs/utils\");\nconst pbkdf2_1 = require(\"@noble/hashes/pbkdf2\");\nconst sha512_1 = require(\"@noble/hashes/sha512\");\n/**\n * Returns the Node.js crypto module when available and `undefined`\n * otherwise.\n *\n * Detects an unimplemented fallback module from Webpack 5 and returns\n * `undefined` in that case.\n */\nasync function getCryptoModule() {\n  try {\n    const crypto = await Promise.resolve().then(() => __importStar(require(\"crypto\")));\n    // We get `Object{default: Object{}}` as a fallback when using\n    // `crypto: false` in Webpack 5, which we interprete as unavailable.\n    if (typeof crypto === \"object\" && Object.keys(crypto).length <= 1) {\n      return undefined;\n    }\n    return crypto;\n  } catch (_a) {\n    return undefined;\n  }\n}\nexports.getCryptoModule = getCryptoModule;\nasync function getSubtle() {\n  // From Node.js 15 onwards, webcrypto is available in globalThis.\n  // In version 15 and 16 this was stored under the webcrypto key.\n  // With Node.js 17 it was moved to the same locations where browsers\n  // make it available.\n  // Loading `require(\"crypto\")` here seems unnecessary since it only\n  // causes issues with bundlers and does not increase compatibility.\n  var _a, _b, _c;\n  // Browsers and Node.js 17+\n  let subtle = (_a = globalThis === null || globalThis === void 0 ? void 0 : globalThis.crypto) === null || _a === void 0 ? void 0 : _a.subtle;\n  // Node.js 15+\n  if (!subtle) subtle = (_c = (_b = globalThis === null || globalThis === void 0 ? void 0 : globalThis.crypto) === null || _b === void 0 ? void 0 : _b.webcrypto) === null || _c === void 0 ? void 0 : _c.subtle;\n  return subtle;\n}\nexports.getSubtle = getSubtle;\nasync function pbkdf2Sha512Subtle(\n// eslint-disable-next-line @typescript-eslint/explicit-module-boundary-types\nsubtle, secret, salt, iterations, keylen) {\n  (0, utils_1.assert)(subtle, \"Argument subtle is falsy\");\n  (0, utils_1.assert)(typeof subtle === \"object\", \"Argument subtle is not of type object\");\n  (0, utils_1.assert)(typeof subtle.importKey === \"function\", \"subtle.importKey is not a function\");\n  (0, utils_1.assert)(typeof subtle.deriveBits === \"function\", \"subtle.deriveBits is not a function\");\n  return subtle.importKey(\"raw\", secret, {\n    name: \"PBKDF2\"\n  }, false, [\"deriveBits\"]).then(key => subtle.deriveBits({\n    name: \"PBKDF2\",\n    salt: salt,\n    iterations: iterations,\n    hash: {\n      name: \"SHA-512\"\n    }\n  }, key, keylen * 8).then(buffer => new Uint8Array(buffer)));\n}\nexports.pbkdf2Sha512Subtle = pbkdf2Sha512Subtle;\nasync function pbkdf2Sha512Crypto(\n// eslint-disable-next-line @typescript-eslint/explicit-module-boundary-types\ncrypto, secret, salt, iterations, keylen) {\n  (0, utils_1.assert)(crypto, \"Argument crypto is falsy\");\n  (0, utils_1.assert)(typeof crypto === \"object\", \"Argument crypto is not of type object\");\n  (0, utils_1.assert)(typeof crypto.pbkdf2 === \"function\", \"crypto.pbkdf2 is not a function\");\n  return new Promise((resolve, reject) => {\n    crypto.pbkdf2(secret, salt, iterations, keylen, \"sha512\", (error, result) => {\n      if (error) {\n        reject(error);\n      } else {\n        resolve(Uint8Array.from(result));\n      }\n    });\n  });\n}\nexports.pbkdf2Sha512Crypto = pbkdf2Sha512Crypto;\nasync function pbkdf2Sha512Noble(secret, salt, iterations, keylen) {\n  return (0, pbkdf2_1.pbkdf2Async)(sha512_1.sha512, secret, salt, {\n    c: iterations,\n    dkLen: keylen\n  });\n}\nexports.pbkdf2Sha512Noble = pbkdf2Sha512Noble;\n/**\n * A pbkdf2 implementation for BIP39. This is not exported at package level and thus a private API.\n */\nasync function pbkdf2Sha512(secret, salt, iterations, keylen) {\n  const subtle = await getSubtle();\n  if (subtle) {\n    return pbkdf2Sha512Subtle(subtle, secret, salt, iterations, keylen);\n  } else {\n    const crypto = await getCryptoModule();\n    if (crypto) {\n      return pbkdf2Sha512Crypto(crypto, secret, salt, iterations, keylen);\n    } else {\n      return pbkdf2Sha512Noble(secret, salt, iterations, keylen);\n    }\n  }\n}\nexports.pbkdf2Sha512 = pbkdf2Sha512;","map":{"version":3,"names":["utils_1","require","pbkdf2_1","sha512_1","getCryptoModule","crypto","Promise","resolve","then","__importStar","Object","keys","length","undefined","_a","exports","getSubtle","subtle","globalThis","_c","_b","webcrypto","pbkdf2Sha512Subtle","secret","salt","iterations","keylen","assert","importKey","deriveBits","name","key","hash","buffer","Uint8Array","pbkdf2Sha512Crypto","pbkdf2","reject","error","result","from","pbkdf2Sha512Noble","pbkdf2Async","sha512","c","dkLen","pbkdf2Sha512"],"sources":["../src/pbkdf2.ts"],"sourcesContent":[null],"mappings":"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"},"metadata":{},"sourceType":"script","externalDependencies":[]}