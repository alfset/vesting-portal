{"ast":null,"code":"'use strict';\n\nObject.defineProperty(exports, '__esModule', {\n  value: true\n});\nexports.p2data = void 0;\nconst networks_1 = require('../networks');\nconst bscript = require('../script');\nconst types_1 = require('../types');\nconst lazy = require('./lazy');\nconst OPS = bscript.OPS;\nfunction stacksEqual(a, b) {\n  if (a.length !== b.length) return false;\n  return a.every((x, i) => {\n    return x.equals(b[i]);\n  });\n}\n// output: OP_RETURN ...\nfunction p2data(a, opts) {\n  if (!a.data && !a.output) throw new TypeError('Not enough data');\n  opts = Object.assign({\n    validate: true\n  }, opts || {});\n  (0, types_1.typeforce)({\n    network: types_1.typeforce.maybe(types_1.typeforce.Object),\n    output: types_1.typeforce.maybe(types_1.typeforce.Buffer),\n    data: types_1.typeforce.maybe(types_1.typeforce.arrayOf(types_1.typeforce.Buffer))\n  }, a);\n  const network = a.network || networks_1.bitcoin;\n  const o = {\n    name: 'embed',\n    network\n  };\n  lazy.prop(o, 'output', () => {\n    if (!a.data) return;\n    return bscript.compile([OPS.OP_RETURN].concat(a.data));\n  });\n  lazy.prop(o, 'data', () => {\n    if (!a.output) return;\n    return bscript.decompile(a.output).slice(1);\n  });\n  // extended validation\n  if (opts.validate) {\n    if (a.output) {\n      const chunks = bscript.decompile(a.output);\n      if (chunks[0] !== OPS.OP_RETURN) throw new TypeError('Output is invalid');\n      if (!chunks.slice(1).every(types_1.typeforce.Buffer)) throw new TypeError('Output is invalid');\n      if (a.data && !stacksEqual(a.data, o.data)) throw new TypeError('Data mismatch');\n    }\n  }\n  return Object.assign(o, a);\n}\nexports.p2data = p2data;","map":{"version":3,"names":["Object","defineProperty","exports","value","p2data","networks_1","require","bscript","types_1","lazy","OPS","stacksEqual","a","b","length","every","x","i","equals","opts","data","output","TypeError","assign","validate","typeforce","network","maybe","Buffer","arrayOf","bitcoin","o","name","prop","compile","OP_RETURN","concat","decompile","slice","chunks"],"sources":["/workspace/Planq-Dapps/vesting-portal/node_modules/bitcoinjs-lib/src/payments/embed.js"],"sourcesContent":["'use strict';\nObject.defineProperty(exports, '__esModule', { value: true });\nexports.p2data = void 0;\nconst networks_1 = require('../networks');\nconst bscript = require('../script');\nconst types_1 = require('../types');\nconst lazy = require('./lazy');\nconst OPS = bscript.OPS;\nfunction stacksEqual(a, b) {\n  if (a.length !== b.length) return false;\n  return a.every((x, i) => {\n    return x.equals(b[i]);\n  });\n}\n// output: OP_RETURN ...\nfunction p2data(a, opts) {\n  if (!a.data && !a.output) throw new TypeError('Not enough data');\n  opts = Object.assign({ validate: true }, opts || {});\n  (0, types_1.typeforce)(\n    {\n      network: types_1.typeforce.maybe(types_1.typeforce.Object),\n      output: types_1.typeforce.maybe(types_1.typeforce.Buffer),\n      data: types_1.typeforce.maybe(\n        types_1.typeforce.arrayOf(types_1.typeforce.Buffer),\n      ),\n    },\n    a,\n  );\n  const network = a.network || networks_1.bitcoin;\n  const o = { name: 'embed', network };\n  lazy.prop(o, 'output', () => {\n    if (!a.data) return;\n    return bscript.compile([OPS.OP_RETURN].concat(a.data));\n  });\n  lazy.prop(o, 'data', () => {\n    if (!a.output) return;\n    return bscript.decompile(a.output).slice(1);\n  });\n  // extended validation\n  if (opts.validate) {\n    if (a.output) {\n      const chunks = bscript.decompile(a.output);\n      if (chunks[0] !== OPS.OP_RETURN) throw new TypeError('Output is invalid');\n      if (!chunks.slice(1).every(types_1.typeforce.Buffer))\n        throw new TypeError('Output is invalid');\n      if (a.data && !stacksEqual(a.data, o.data))\n        throw new TypeError('Data mismatch');\n    }\n  }\n  return Object.assign(o, a);\n}\nexports.p2data = p2data;\n"],"mappings":"AAAA,YAAY;;AACZA,MAAM,CAACC,cAAc,CAACC,OAAO,EAAE,YAAY,EAAE;EAAEC,KAAK,EAAE;AAAK,CAAC,CAAC;AAC7DD,OAAO,CAACE,MAAM,GAAG,KAAK,CAAC;AACvB,MAAMC,UAAU,GAAGC,OAAO,CAAC,aAAa,CAAC;AACzC,MAAMC,OAAO,GAAGD,OAAO,CAAC,WAAW,CAAC;AACpC,MAAME,OAAO,GAAGF,OAAO,CAAC,UAAU,CAAC;AACnC,MAAMG,IAAI,GAAGH,OAAO,CAAC,QAAQ,CAAC;AAC9B,MAAMI,GAAG,GAAGH,OAAO,CAACG,GAAG;AACvB,SAASC,WAAWA,CAACC,CAAC,EAAEC,CAAC,EAAE;EACzB,IAAID,CAAC,CAACE,MAAM,KAAKD,CAAC,CAACC,MAAM,EAAE,OAAO,KAAK;EACvC,OAAOF,CAAC,CAACG,KAAK,CAAC,CAACC,CAAC,EAAEC,CAAC,KAAK;IACvB,OAAOD,CAAC,CAACE,MAAM,CAACL,CAAC,CAACI,CAAC,CAAC,CAAC;EACvB,CAAC,CAAC;AACJ;AACA;AACA,SAASb,MAAMA,CAACQ,CAAC,EAAEO,IAAI,EAAE;EACvB,IAAI,CAACP,CAAC,CAACQ,IAAI,IAAI,CAACR,CAAC,CAACS,MAAM,EAAE,MAAM,IAAIC,SAAS,CAAC,iBAAiB,CAAC;EAChEH,IAAI,GAAGnB,MAAM,CAACuB,MAAM,CAAC;IAAEC,QAAQ,EAAE;EAAK,CAAC,EAAEL,IAAI,IAAI,CAAC,CAAC,CAAC;EACpD,CAAC,CAAC,EAAEX,OAAO,CAACiB,SAAS,EACnB;IACEC,OAAO,EAAElB,OAAO,CAACiB,SAAS,CAACE,KAAK,CAACnB,OAAO,CAACiB,SAAS,CAACzB,MAAM,CAAC;IAC1DqB,MAAM,EAAEb,OAAO,CAACiB,SAAS,CAACE,KAAK,CAACnB,OAAO,CAACiB,SAAS,CAACG,MAAM,CAAC;IACzDR,IAAI,EAAEZ,OAAO,CAACiB,SAAS,CAACE,KAAK,CAC3BnB,OAAO,CAACiB,SAAS,CAACI,OAAO,CAACrB,OAAO,CAACiB,SAAS,CAACG,MAAM,CACpD;EACF,CAAC,EACDhB,CACF,CAAC;EACD,MAAMc,OAAO,GAAGd,CAAC,CAACc,OAAO,IAAIrB,UAAU,CAACyB,OAAO;EAC/C,MAAMC,CAAC,GAAG;IAAEC,IAAI,EAAE,OAAO;IAAEN;EAAQ,CAAC;EACpCjB,IAAI,CAACwB,IAAI,CAACF,CAAC,EAAE,QAAQ,EAAE,MAAM;IAC3B,IAAI,CAACnB,CAAC,CAACQ,IAAI,EAAE;IACb,OAAOb,OAAO,CAAC2B,OAAO,CAAC,CAACxB,GAAG,CAACyB,SAAS,CAAC,CAACC,MAAM,CAACxB,CAAC,CAACQ,IAAI,CAAC,CAAC;EACxD,CAAC,CAAC;EACFX,IAAI,CAACwB,IAAI,CAACF,CAAC,EAAE,MAAM,EAAE,MAAM;IACzB,IAAI,CAACnB,CAAC,CAACS,MAAM,EAAE;IACf,OAAOd,OAAO,CAAC8B,SAAS,CAACzB,CAAC,CAACS,MAAM,CAAC,CAACiB,KAAK,CAAC,CAAC,CAAC;EAC7C,CAAC,CAAC;EACF;EACA,IAAInB,IAAI,CAACK,QAAQ,EAAE;IACjB,IAAIZ,CAAC,CAACS,MAAM,EAAE;MACZ,MAAMkB,MAAM,GAAGhC,OAAO,CAAC8B,SAAS,CAACzB,CAAC,CAACS,MAAM,CAAC;MAC1C,IAAIkB,MAAM,CAAC,CAAC,CAAC,KAAK7B,GAAG,CAACyB,SAAS,EAAE,MAAM,IAAIb,SAAS,CAAC,mBAAmB,CAAC;MACzE,IAAI,CAACiB,MAAM,CAACD,KAAK,CAAC,CAAC,CAAC,CAACvB,KAAK,CAACP,OAAO,CAACiB,SAAS,CAACG,MAAM,CAAC,EAClD,MAAM,IAAIN,SAAS,CAAC,mBAAmB,CAAC;MAC1C,IAAIV,CAAC,CAACQ,IAAI,IAAI,CAACT,WAAW,CAACC,CAAC,CAACQ,IAAI,EAAEW,CAAC,CAACX,IAAI,CAAC,EACxC,MAAM,IAAIE,SAAS,CAAC,eAAe,CAAC;IACxC;EACF;EACA,OAAOtB,MAAM,CAACuB,MAAM,CAACQ,CAAC,EAAEnB,CAAC,CAAC;AAC5B;AACAV,OAAO,CAACE,MAAM,GAAGA,MAAM"},"metadata":{},"sourceType":"script","externalDependencies":[]}