{"ast":null,"code":"import React,{useState,useEffect,createRef}from'react';import LazyloadService from'./LazyloadService';export function LazyImage(_ref){let{style,checkUrl,className,observe,children}=_ref;const child=children;const[loaded,setLoaded]=useState(checkUrl?LazyloadService.checkLoadedUrl(checkUrl):false);const[loadService,setLoadService]=useState();const placeholder='data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABAQMAAAAl21bKAAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAADUExURd3d3e7fjoIAAAAKSURBVAjXY2AAAAACAAHiIbwzAAAAAElFTkSuQmCC';const watchRef=createRef();useEffect(()=>{const service=observe||LazyloadService.getInstance();setLoadService(service);return()=>{if(service){service.disconnect();setLoadService(undefined);}};},[]);useEffect(()=>{// eslint-disable-next-line @typescript-eslint/ban-types\nlet unsubscribe;if(!loaded&&watchRef.current&&loadService){unsubscribe=loadService.subscribe(watchRef.current,e=>{if(e&&e.intersectionRatio){if(checkUrl){LazyloadService.addLoadedUrl(checkUrl);}unsubscribe&&unsubscribe();unsubscribe=null;setLoaded(true);}});}return()=>{if(unsubscribe){unsubscribe();}};},[loadService,loaded,watchRef]);return loaded?child:/*#__PURE__*/React.createElement(\"img\",{style:style,ref:watchRef,src:placeholder,className:className});}","map":{"version":3,"names":["React","useState","useEffect","createRef","LazyloadService","LazyImage","_ref","style","checkUrl","className","observe","children","child","loaded","setLoaded","checkLoadedUrl","loadService","setLoadService","placeholder","watchRef","service","getInstance","disconnect","undefined","unsubscribe","current","subscribe","e","intersectionRatio","addLoadedUrl","createElement","ref","src"],"sources":["/workspace/Planq-Dapps/vesting-portal/src/components/Lazyload/LazyImage.tsx"],"sourcesContent":["import React, { useState, useEffect, PropsWithChildren, createRef } from 'react';\nimport LazyloadService from './LazyloadService';\n\ntype Props = {\n  width?: number;\n  height?: number;\n  style?: any;\n  checkUrl?: string;\n  observe?: LazyloadService;\n  className?: string;\n}\n\nexport function LazyImage({ style, checkUrl, className, observe, children }: PropsWithChildren<Props>) {\n  const child: any = children;\n  const [loaded, setLoaded] = useState(\n    checkUrl ? LazyloadService.checkLoadedUrl(checkUrl) : false\n  );\n  const [loadService, setLoadService] = useState<LazyloadService>();\n  const placeholder = 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABAQMAAAAl21bKAAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAADUExURd3d3e7fjoIAAAAKSURBVAjXY2AAAAACAAHiIbwzAAAAAElFTkSuQmCC';\n  const watchRef = createRef<any>();\n\n  useEffect(() => {\n    const service: LazyloadService = observe || LazyloadService.getInstance();\n    setLoadService(service);\n    return () => {\n      if (service) {\n        service.disconnect();\n        setLoadService(undefined);\n      }\n    }\n  }, []);\n\n  useEffect(() => {\n    // eslint-disable-next-line @typescript-eslint/ban-types\n    let unsubscribe: Function | null;\n    if (!loaded && watchRef.current && loadService) {\n      unsubscribe = loadService.subscribe(watchRef.current, (e: any) => {\n        if (e && e.intersectionRatio) {\n          if (checkUrl) {\n            LazyloadService.addLoadedUrl(checkUrl);\n          }\n          unsubscribe && unsubscribe();\n          unsubscribe = null;\n          setLoaded(true);\n        }\n      })\n    }\n    return () => {\n      if (unsubscribe) {\n        unsubscribe();\n      }\n    }\n  }, [loadService, loaded, watchRef]);\n\n  return (loaded ? child : <img style={ style } ref={ watchRef } src={ placeholder } className={ className } />);\n}\n"],"mappings":"AAAA,MAAO,CAAAA,KAAK,EAAIC,QAAQ,CAAEC,SAAS,CAAqBC,SAAS,KAAQ,OAAO,CAChF,MAAO,CAAAC,eAAe,KAAM,mBAAmB,CAW/C,MAAO,SAAS,CAAAC,SAASA,CAAAC,IAAA,CAA8E,IAA7E,CAAEC,KAAK,CAAEC,QAAQ,CAAEC,SAAS,CAAEC,OAAO,CAAEC,QAAmC,CAAC,CAAAL,IAAA,CACnG,KAAM,CAAAM,KAAU,CAAGD,QAAQ,CAC3B,KAAM,CAACE,MAAM,CAAEC,SAAS,CAAC,CAAGb,QAAQ,CAClCO,QAAQ,CAAGJ,eAAe,CAACW,cAAc,CAACP,QAAQ,CAAC,CAAG,KACxD,CAAC,CACD,KAAM,CAACQ,WAAW,CAAEC,cAAc,CAAC,CAAGhB,QAAQ,CAAkB,CAAC,CACjE,KAAM,CAAAiB,WAAW,CAAG,4KAA4K,CAChM,KAAM,CAAAC,QAAQ,CAAGhB,SAAS,CAAM,CAAC,CAEjCD,SAAS,CAAC,IAAM,CACd,KAAM,CAAAkB,OAAwB,CAAGV,OAAO,EAAIN,eAAe,CAACiB,WAAW,CAAC,CAAC,CACzEJ,cAAc,CAACG,OAAO,CAAC,CACvB,MAAO,IAAM,CACX,GAAIA,OAAO,CAAE,CACXA,OAAO,CAACE,UAAU,CAAC,CAAC,CACpBL,cAAc,CAACM,SAAS,CAAC,CAC3B,CACF,CAAC,CACH,CAAC,CAAE,EAAE,CAAC,CAENrB,SAAS,CAAC,IAAM,CACd;AACA,GAAI,CAAAsB,WAA4B,CAChC,GAAI,CAACX,MAAM,EAAIM,QAAQ,CAACM,OAAO,EAAIT,WAAW,CAAE,CAC9CQ,WAAW,CAAGR,WAAW,CAACU,SAAS,CAACP,QAAQ,CAACM,OAAO,CAAGE,CAAM,EAAK,CAChE,GAAIA,CAAC,EAAIA,CAAC,CAACC,iBAAiB,CAAE,CAC5B,GAAIpB,QAAQ,CAAE,CACZJ,eAAe,CAACyB,YAAY,CAACrB,QAAQ,CAAC,CACxC,CACAgB,WAAW,EAAIA,WAAW,CAAC,CAAC,CAC5BA,WAAW,CAAG,IAAI,CAClBV,SAAS,CAAC,IAAI,CAAC,CACjB,CACF,CAAC,CAAC,CACJ,CACA,MAAO,IAAM,CACX,GAAIU,WAAW,CAAE,CACfA,WAAW,CAAC,CAAC,CACf,CACF,CAAC,CACH,CAAC,CAAE,CAACR,WAAW,CAAEH,MAAM,CAAEM,QAAQ,CAAC,CAAC,CAEnC,MAAQ,CAAAN,MAAM,CAAGD,KAAK,cAAGZ,KAAA,CAAA8B,aAAA,QAAKvB,KAAK,CAAGA,KAAO,CAACwB,GAAG,CAAGZ,QAAU,CAACa,GAAG,CAAGd,WAAa,CAACT,SAAS,CAAGA,SAAW,CAAE,CAAC,CAC/G"},"metadata":{},"sourceType":"module","externalDependencies":[]}