{"ast":null,"code":"\"use strict\";\n\nvar BigNumber = require(\"bignumber.js\");\nvar Utils = require(\"./Utils\");\nvar QRCode = require(\"./qrcode\");\nvar openExtension = require(\"./extensionHandler\");\nvar openApp = require(\"./appHandler\");\nvar config = require(\"./config\");\nvar Pay = function (appKey, appSecret) {\n  // TODO: currently not use\n  this.appKey = appKey;\n  this.appSecret = appSecret;\n};\nvar TransactionMaxGasPrice = \"1000000000000\";\nvar TransactionMaxGas = \"50000000000\";\nPay.prototype = {\n  /*jshint maxcomplexity:6 */\n  submit: function (currency, to, value, payload, options) {\n    options.serialNumber = Utils.randomCode(32);\n    value = value || \"0\";\n    var amount = new BigNumber(value).times(\"1000000000000000000\"); //10^18\n\n    var gasLimitBN, gasPriceBN;\n    if (!!options.gasLimit) {\n      gasLimitBN = new BigNumber(options.gasLimit); //check validity of gasPrice & gasLimit\n      if (gasLimitBN.lt(0)) throw new Error(\"gas limit should not be minus\");\n      if (gasLimitBN.gt(TransactionMaxGas)) throw new Error(\"gas limit should smaller than \" + TransactionMaxGas);\n      if (!gasLimitBN.isInteger()) throw new Error(\"gas limit should be integer\");\n    }\n    if (!!options.gasPrice) {\n      gasPriceBN = new BigNumber(options.gasPrice);\n      if (gasPriceBN.lt(0)) throw new Error(\"gas price should not be minus\");\n      if (gasPriceBN.gt(TransactionMaxGasPrice)) throw new Error(\"gas price should smaller than \" + TransactionMaxGasPrice);\n      if (!gasPriceBN.isInteger()) throw new Error(\"gas price should be integer\");\n    }\n    var params = {\n      serialNumber: options.serialNumber,\n      goods: options.goods,\n      pay: {\n        currency: currency,\n        to: to,\n        value: amount.toString(10),\n        payload: payload,\n        gasLimit: !!gasLimitBN ? gasLimitBN.toString(10) : undefined,\n        gasPrice: !!gasPriceBN ? gasPriceBN.toString(10) : undefined\n      },\n      callback: options.callback || config.payUrl(options.debug),\n      listener: options.listener,\n      nrc20: options.nrc20\n    };\n    if (Utils.isChrome() && !Utils.isMobile() && options.extension.openExtension) {\n      if (Utils.isExtInstalled()) openExtension(params);else {\n        //window.alert(\"NasExtWallet is not installed.\");\n        if (window.confirm('NasExtWallet is not installed. Click \"ok\" to install it.')) {\n          window.open('https://chrome.google.com/webstore/detail/nasextwallet/gehjkhmhclgnkkhpfamakecfgakkfkco');\n        }\n      }\n    }\n    var appParams = {\n      category: \"jump\",\n      des: \"confirmTransfer\",\n      pageParams: params\n    };\n    if (Utils.isMobile()) {\n      openApp(appParams, options);\n    }\n    if (options.qrcode.showQRCode && !Utils.isNano()) {\n      QRCode.showQRCode(JSON.stringify(appParams), options);\n    }\n    return options.serialNumber;\n  }\n};\nmodule.exports = Pay;","map":{"version":3,"names":["BigNumber","require","Utils","QRCode","openExtension","openApp","config","Pay","appKey","appSecret","TransactionMaxGasPrice","TransactionMaxGas","prototype","submit","currency","to","value","payload","options","serialNumber","randomCode","amount","times","gasLimitBN","gasPriceBN","gasLimit","lt","Error","gt","isInteger","gasPrice","params","goods","pay","toString","undefined","callback","payUrl","debug","listener","nrc20","isChrome","isMobile","extension","isExtInstalled","window","confirm","open","appParams","category","des","pageParams","qrcode","showQRCode","isNano","JSON","stringify","module","exports"],"sources":["/workspace/Planq-Dapps/vesting-portal/node_modules/nebpay.js/libs/pay.js"],"sourcesContent":["\"use strict\";\n\nvar BigNumber = require(\"bignumber.js\");\n\nvar Utils = require(\"./Utils\");\nvar QRCode = require(\"./qrcode\");\n\nvar openExtension = require(\"./extensionHandler\");\nvar openApp = require(\"./appHandler\");\nvar config = require(\"./config\");\n\nvar Pay = function (appKey, appSecret) {\n\t// TODO: currently not use\n\tthis.appKey = appKey;\n\tthis.appSecret = appSecret;\n};\nvar TransactionMaxGasPrice = \"1000000000000\";\nvar TransactionMaxGas = \"50000000000\";\n\nPay.prototype = {\n\t/*jshint maxcomplexity:6 */\n\tsubmit: function (currency, to, value, payload, options) {\n\t\toptions.serialNumber = Utils.randomCode(32);\n\t\tvalue = value || \"0\";\n\t\tvar amount = new BigNumber(value).times(\"1000000000000000000\");//10^18\n\n\t\tvar gasLimitBN, gasPriceBN;\n\t\tif(!!options.gasLimit) {\n            gasLimitBN = new BigNumber(options.gasLimit);  //check validity of gasPrice & gasLimit\n            if (gasLimitBN.lt(0)) throw new Error(\"gas limit should not be minus\");\n            if (gasLimitBN.gt(TransactionMaxGas)) throw new Error(\"gas limit should smaller than \" + TransactionMaxGas);\n            if (!gasLimitBN.isInteger()) throw new Error(\"gas limit should be integer\");\n        }\n\n        if(!!options.gasPrice) {\n            gasPriceBN = new BigNumber(options.gasPrice);\n            if (gasPriceBN.lt(0)) throw new Error(\"gas price should not be minus\");\n            if (gasPriceBN.gt(TransactionMaxGasPrice)) throw new Error(\"gas price should smaller than \" + TransactionMaxGasPrice);\n            if (!gasPriceBN.isInteger()) throw new Error(\"gas price should be integer\");\n        }\n\n\t\tvar params = {\n\t\t\tserialNumber: options.serialNumber,\n\t\t\tgoods:options.goods,\n\t\t\tpay: {\n\t\t\t\tcurrency: currency,\n\t\t\t\tto: to,\n\t\t\t\tvalue: amount.toString(10),\n\t\t\t\tpayload: payload,\n\t\t\t\tgasLimit: !!gasLimitBN ? gasLimitBN.toString(10) : undefined,\n\t\t\t\tgasPrice: !!gasPriceBN ? gasPriceBN.toString(10) : undefined\n    \t\t},\n            callback: options.callback || config.payUrl(options.debug),\n            listener: options.listener,\n\t\t\tnrc20: options.nrc20\n\t\t};\n\n\t\tif (Utils.isChrome() && !Utils.isMobile() && options.extension.openExtension) {\n\t\t\tif(Utils.isExtInstalled())\n\t\t\t\topenExtension(params);\n\t\t\telse {\n                //window.alert(\"NasExtWallet is not installed.\");\n                if (window.confirm('NasExtWallet is not installed. Click \"ok\" to install it.'))\n                {\n                    window.open('https://chrome.google.com/webstore/detail/nasextwallet/gehjkhmhclgnkkhpfamakecfgakkfkco');\n                }\n            }\n\t\t}\n\n\t\tvar appParams = {\n\t\t\tcategory: \"jump\",\n\t\t\tdes: \"confirmTransfer\",\n\t\t\tpageParams: params\n\t\t};\n\n\t\tif (Utils.isMobile()) {\n\t\t\topenApp(appParams, options);\n\t\t}\n\n\t\tif (options.qrcode.showQRCode && !Utils.isNano()) {\n\t\t\tQRCode.showQRCode(JSON.stringify(appParams), options);\n\t\t}\n\t\t\n\t\treturn options.serialNumber;\n\t}\n};\n\nmodule.exports = Pay;"],"mappings":"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"},"metadata":{},"sourceType":"script","externalDependencies":[]}